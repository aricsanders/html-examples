<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CALREP 7.1</title>
    <link href="prism.css" rel="stylesheet">
</head>
<body>
<h1> A highlighted Plain Text version of CALREP HP Basic Program</h1>
<pre class=" language-basic"><code class=" language-basic">
<span class="token number">100</span><span class="token comment" spellcheck="true">!    RE-STORE </span><span class="token string">"s:/PROGPC/CALREP7.1_COMMA"</span>
<span class="token number">110</span>   <span class="token comment" spellcheck="true">! Rev Date 07/18/2011</span>
<span class="token number">120</span>   <span class="token comment" spellcheck="true">! CALREP6 VERSION WITH UPDATED (BIPM) UNCERTAINTIES</span>
<span class="token number">130</span>   <span class="token comment" spellcheck="true">! MODIFIED 9/21/97 TO ACCOMODATE DIODE AND THERMOELECTRIC MEAS</span>
<span class="token number">140</span>   <span class="token comment" spellcheck="true">! Updated WR22 Type B uncertainties 3-20-98</span>
<span class="token number">150</span>   <span class="token comment" spellcheck="true">! Updated WR15 Type B uncertainties 4-16-98</span>
<span class="token number">160</span>   <span class="token comment" spellcheck="true">! Updated WR15 Type A uncertainties 4-16-98</span>
<span class="token number">161</span>   <span class="token comment" spellcheck="true">! Modified 14 mm Type B unceretainty 8-21-98 (1-port and 2-port)</span>
<span class="token number">170</span>   <span class="token comment" spellcheck="true">! Modified Type A uncertainty for 2.4 mm S12 measurements of Beatty Lines.</span>
<span class="token number">180</span>   <span class="token comment" spellcheck="true">! Prior to modification, Type A uncertainty was multiplied by 2 if Beatty Line</span>
<span class="token number">190</span>   <span class="token comment" spellcheck="true">! Removed the generation of ASCII files meant for database use from CREATEANDSTORE and CREATEFILES.   5/6/99  RAG</span>
<span class="token number">191</span>   <span class="token comment" spellcheck="true">! Updated 7 mm Type B uncertainties (doubled both mag and phase Type B, S11, S22, S12)  07/25/00     !RAG</span>
<span class="token number">192</span>   <span class="token comment" spellcheck="true">! Will now output ascii tables from the six-port systems in the format of the new DIRECT COMPARISON System.   8/28/00   !RAG</span>
<span class="token number">193</span>   <span class="token comment" spellcheck="true">! Power uncertainties have been updated to be in numerical form instead of percentage.    8/28/00    !RAG</span>
<span class="token number">194</span>   <span class="token comment" spellcheck="true">! Changed name from CALREP6 to CALREP7 to reflect latest changes.  8/28/00       !RAG</span>
<span class="token number">195</span>   <span class="token comment" spellcheck="true">! Changed S12 Snist calculation to handle attenuation values over 65 Db (moved upper limit to 100 Db).    02/21/01    !RAG</span>
<span class="token number">196</span>   <span class="token comment" spellcheck="true">! Updated Type-N power uncertainties.  New uncertainty formula from Tom Crowley for Type-N transfer standard (CN type)   08/16/16    !RAG</span>
<span class="token number">197</span>   <span class="token comment" spellcheck="true">! 01-14-02 Increased snist for WR15 &amp; WR10 on 01/14/02 after reviewing current calibration data</span>
<span class="token number">198</span>   <span class="token comment" spellcheck="true">!          Short term deviations on six-port as high as 0.06 at times.  Also starting</span>
<span class="token number">199</span>   <span class="token comment" spellcheck="true">!          to measure devices on HP8510 (noise lab WR-15 armadillos)</span>
<span class="token number">200</span>   <span class="token comment" spellcheck="true">! 04-22-02 Increased Type B uncertainty for s11, s22, gamma for WR-10.  See descrepancy of up</span>
<span class="token number">202</span>   <span class="token comment" spellcheck="true">!          to 0.015 when measuring different standard lines.  Type B uncert increased from 0.003 to 0.006 (approx).</span>
<span class="token number">203</span>   <span class="token comment" spellcheck="true">! 05-20-02 Increased print statements to print frequencys above 99ghz     ! DXL</span>
<span class="token number">204</span>   <span class="token comment" spellcheck="true">! 03/18/04 Corrected phase ambiguity problem encountered when averaging phases (rare problem case covered - averging problems</span>
<span class="token number">205</span>   <span class="token comment" spellcheck="true">!          when dealing with widely varying angles in a second set of connects)     !RAG</span>
<span class="token number">206</span>   <span class="token comment" spellcheck="true">! 07/18/11 added code to output report </span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span> <span class="token operator">and</span> <span class="token string">"c"</span> <span class="token keyword">files</span> <span class="token function">in</span> comma delimited format.
<span class="token number">208</span>   !
<span class="token number">209</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">212</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Printer<span class="token operator">/</span>@Prt<span class="token punctuation">,</span>Prt
<span class="token number">214</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Version<span class="token operator">/</span>Vers$[<span class="token number">30</span>]
<span class="token number">218</span>   Vers$<span class="token operator">=</span><span class="token string">"CALREP7.1_comma"</span>
<span class="token number">220</span>   PRINTER <span class="token function">IS</span> CRT
<span class="token number">230</span>   CONFIGURE LONGFILENAMES <span class="token keyword">ON</span>
<span class="token number">240</span>   <span class="token keyword">CLEAR</span> SCREEN
<span class="token number">260</span>   Prt<span class="token operator">=</span><span class="token number">10</span>
<span class="token number">270</span>   ASSIGN @Prt <span class="token keyword">TO</span> <span class="token number">10</span>
<span class="token number">280</span>   <span class="token keyword">CALL</span> Calrep6   <span class="token comment" spellcheck="true">! Put all as SUBs so could be LOADSUBbed</span>
<span class="token number">290</span>   <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to process more data with CALREP7.1_comma ?"</span><span class="token punctuation">,</span>Again<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">300</span>   <span class="token keyword">IF</span> Again <span class="token keyword">THEN</span> <span class="token keyword">GOTO</span> <span class="token number">280</span>
<span class="token number">310</span>   CONTROL <span class="token number">10</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">;</span><span class="token number">1</span>
<span class="token number">320</span>   CONFIGURE LONGFILENAMES <span class="token keyword">OFF</span>
<span class="token number">330</span>   <span class="token keyword">END</span>   <span class="token comment" spellcheck="true">!......................</span>


<span class="token number">340</span> Calrep6<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Calrep6
<span class="token number">350</span>   <span class="token comment" spellcheck="true">!                                RFK</span>
<span class="token number">360</span>   <span class="token comment" spellcheck="true">! Version of data analysis that reads files produced by MEAS6 software.</span>
<span class="token number">370</span>   <span class="token comment" spellcheck="true">! Hard copy of </span><span class="token string">"raw"</span> <span class="token keyword">data</span><span class="token punctuation">,</span> <span class="token function">of</span> final averages <span class="token operator">&amp;</span> uncertainties are printed.
<span class="token number">380</span>   <span class="token comment" spellcheck="true">!  Plots of data are made by LOADSUBbing and running QCPLOT.</span>
<span class="token number">390</span>   !
<span class="token number">400</span>   <span class="token comment" spellcheck="true">! NOTE:  If files have been transferred by RTREE to the s: volume,</span>
<span class="token number">410</span>   <span class="token comment" spellcheck="true">!        operator can use attendant file info instead of entering</span>
<span class="token number">420</span>   <span class="token comment" spellcheck="true">!        file names by hand.  Program assumes that all files will be</span>
<span class="token number">430</span>   <span class="token comment" spellcheck="true">!        available on the correct directory of s:.</span>
<span class="token number">440</span>   !
<span class="token number">450</span>   <span class="token comment" spellcheck="true">! OUTPUT:  besides hard copy of the data tables, program created 2 HP-UX</span>
<span class="token number">460</span>   <span class="token comment" spellcheck="true">!          files in the /ASCII.DUT directory on the SRM s:.  One</span>
<span class="token number">470</span>   <span class="token comment" spellcheck="true">!          HP-UX file (file name= device's ID #) contains data table to</span>
<span class="token number">480</span>   <span class="token comment" spellcheck="true">!          be merged into customer report (same as the hard copy data</span>
<span class="token number">490</span>   <span class="token comment" spellcheck="true">!          average tables), the other (filename= Q&amp; device ID, where</span>
<span class="token number">500</span>   <span class="token comment" spellcheck="true">!          Q= first letter of the device's measurement type string)</span>
<span class="token number">510</span>   <span class="token comment" spellcheck="true">!          contains the averages also, plus info on connector types and</span>
<span class="token number">520</span>   <span class="token comment" spellcheck="true">!          dates, to be added to data bases.</span>
<span class="token number">530</span>   !
<span class="token number">540</span>     <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">550</span>     <span class="token function">DEG</span>
<span class="token number">560</span>   !
<span class="token number">570</span>   <span class="token comment" spellcheck="true">! NOTE:  The QCPLOT program should have the same COM blocks as this</span>
<span class="token number">580</span>   <span class="token comment" spellcheck="true">!        program, or the program will fail when it tries to run QCPLOT.</span>
<span class="token number">590</span>   !
<span class="token number">600</span>     <span class="token keyword">COM</span> <span class="token operator">/</span>Printer<span class="token operator">/</span>@Prt<span class="token punctuation">,</span>Prt <span class="token comment" spellcheck="true">! I/O path to printer, &amp; printer port # (9 or 701)</span>
<span class="token number">610</span>   <span class="token comment" spellcheck="true">! Info printed on plots: NIST test #, device description</span>
<span class="token number">620</span>     <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$[<span class="token number">10</span>]<span class="token punctuation">,</span>Devicedescript$[<span class="token number">80</span>]<span class="token punctuation">,</span>Oneportonly
<span class="token number">630</span>     <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token number">1600</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token number">1600</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>[<span class="token number">10</span>]<span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">)</span>
<span class="token number">640</span>     <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$[<span class="token number">10</span>]<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token number">650</span>     <span class="token keyword">COM</span> <span class="token operator">/</span>Dumpcontrol<span class="token operator">/</span>Dumpprint
<span class="token number">651</span>     <span class="token keyword">COM</span> <span class="token operator">/</span>Version<span class="token operator">/</span>Vers$
<span class="token number">660</span>   !
<span class="token number">670</span>   <span class="token comment" spellcheck="true">! LOCAL VARS:  Abbreviated form of connector type, directory path &amp;</span>
<span class="token number">680</span>   <span class="token comment" spellcheck="true">!   disc for input files, array of file names to read, abbreviated form</span>
<span class="token number">690</span>   <span class="token comment" spellcheck="true">!   of device type, device type.</span>
<span class="token number">700</span>   <span class="token comment" spellcheck="true">! NOTE: MAX # OF FILE READ IN, &amp; FREQS READ IN, IS GIVEN BY THE SIZE OF</span>
<span class="token number">710</span>   <span class="token comment" spellcheck="true">!       Filename$(*), Freq(*), Filesperfreq(*), etc.</span>
<span class="token number">720</span>     ALLOCATE Ctype$[<span class="token number">6</span>]<span class="token punctuation">,</span>Pathin$[<span class="token number">30</span>]<span class="token punctuation">,</span>Drivein$[<span class="token number">30</span>]<span class="token punctuation">,</span>Filename$<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>[<span class="token number">20</span>]<span class="token punctuation">,</span>Mparm$[<span class="token number">1</span>]
<span class="token number">730</span>     <span class="token keyword">REDIM</span> Freq<span class="token punctuation">(</span><span class="token number">1600</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token number">1600</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Reset to Max # freqs (=600) ,files (=50), &amp; settings (=50)</span>
<span class="token number">740</span>     <span class="token function">MAT</span> Freq<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token number">750</span>     <span class="token function">MAT</span> Filesperfreq<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token number">760</span>     <span class="token function">MAT</span> Setting$<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>
<span class="token number">770</span>     <span class="token function">MAT</span> Filesperset<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token number">780</span>   !
<span class="token number">790</span>     PRINTER <span class="token function">IS</span> CRT
<span class="token number">800</span>     <span class="token keyword">CLEAR</span> SCREEN
<span class="token number">810</span>     <span class="token function">PRINT</span> <span class="token string">"This "</span><span class="token operator">&amp;</span>Vers$<span class="token operator">&amp;</span><span class="token string">" program contains uncertainties for the new NIST uncertainty format."</span>
<span class="token number">820</span>     <span class="token function">PRINT</span> TABXY<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"Enter a 0 to calculate Type A (Snist) and Type B uncertainties only."</span>
<span class="token number">830</span> Devicenumber<span class="token punctuation">:</span> LINPUT <span class="token string">"Enter the NIST customer number, or check standard ID, of the device"</span><span class="token punctuation">,</span>Nisttestno$
<span class="token number">840</span>     Nisttestno$<span class="token operator">=</span>UPC$<span class="token punctuation">(</span>Nisttestno$<span class="token punctuation">)</span>
<span class="token number">850</span>     <span class="token function">PRINT</span> TABXY<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"                                                                         "</span>
<span class="token number">860</span>     !
<span class="token number">870</span>     <span class="token comment" spellcheck="true">! If operator only wants to calc Snist &amp; Type B's, call that routine,</span>
<span class="token number">880</span>     <span class="token comment" spellcheck="true">!  and, when done, quit program.</span>
<span class="token number">890</span>     <span class="token keyword">IF</span> Nisttestno$<span class="token operator">=</span><span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token keyword">CALL</span> Uncertcalconly
<span class="token number">900</span>     <span class="token keyword">IF</span> Nisttestno$<span class="token operator">=</span><span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token keyword">GOTO</span> Endmain  <span class="token comment" spellcheck="true">! Exit CALREP66 SUBs.</span>
<span class="token number">910</span>     <span class="token comment" spellcheck="true">! .......................................</span>
<span class="token number">920</span>     !
<span class="token number">930</span>   <span class="token comment" spellcheck="true">! If files have been transferred to the SRM, can use the attendant file,</span>
<span class="token number">940</span>   <span class="token comment" spellcheck="true">!  otherwise operator must enter file names.</span>
<span class="token number">950</span>     <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Are all files on the s: drive?"</span><span class="token punctuation">,</span>Usingattenfile<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">960</span>   !
<span class="token number">970</span>   <span class="token comment" spellcheck="true">! See if operator wants to see hard copy only, not get final ASCII files</span>
<span class="token number">980</span>     <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to CHECK DATA ONLY (no ASCII files will be created)?"</span><span class="token punctuation">,</span>Checkdataonly<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">990</span>   !
<span class="token number">1000</span>  <span class="token comment" spellcheck="true">! GET INFO ON THE FILES:  total # to read in, &amp; file names.</span>
<span class="token number">1010</span>    <span class="token keyword">CALL</span> Findfile<span class="token punctuation">(</span>Nisttestno$<span class="token punctuation">,</span>Usingattenfile<span class="token punctuation">,</span>Mparm$<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">1020</span>    !
<span class="token number">1030</span>    <span class="token comment" spellcheck="true">! CREATE ARRAYS for the hard copy output: time &amp; date of measurement,</span>
<span class="token number">1040</span>    <span class="token comment" spellcheck="true">!    6-port/direction used&lt; connectors used, calibration file names &amp;</span>
<span class="token number">1050</span>    <span class="token comment" spellcheck="true">!    dates.</span>
<span class="token number">1060</span>    ALLOCATE Timea$<span class="token punctuation">(</span>Numfiles<span class="token punctuation">)</span>[<span class="token number">8</span>]<span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span>Numfiles<span class="token punctuation">)</span>[<span class="token number">11</span>]<span class="token punctuation">,</span>Sport<span class="token punctuation">(</span>Numfiles<span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span>Numfiles<span class="token punctuation">)</span>[<span class="token number">26</span>]
<span class="token number">1070</span>    ALLOCATE Cfile$<span class="token punctuation">(</span>Numfiles<span class="token punctuation">)</span>[<span class="token number">11</span>]<span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span>Numfiles<span class="token punctuation">)</span>[<span class="token number">11</span>]
<span class="token number">1080</span>    !
<span class="token number">1090</span>    <span class="token comment" spellcheck="true">! Read in all files headers.</span>
<span class="token number">1100</span>    <span class="token keyword">CALL</span> Readheader<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Ctype$<span class="token punctuation">,</span>Mparm$<span class="token punctuation">)</span>
<span class="token number">1110</span>    !
<span class="token number">1120</span>    <span class="token comment" spellcheck="true">! Create arrays for the results:  data for port 1 (forward), for port 2</span>
<span class="token number">1130</span>    <span class="token comment" spellcheck="true">!  (reverse), data for power standards, final averages, residuals of</span>
<span class="token number">1140</span>    <span class="token comment" spellcheck="true">!  calculations (for a 1- or 2-port or power on 6-port) or uncerts of</span>
<span class="token number">1150</span>    <span class="token comment" spellcheck="true">!  gamma mag &amp; phase (for power on direct comparison system),</span>
<span class="token number">1160</span>    <span class="token comment" spellcheck="true">!  short term (connector) std dev, long term (calibration) std dev,</span>
<span class="token number">1170</span>    <span class="token comment" spellcheck="true">!  systematic uncert, total uncertainty.</span>
<span class="token number">1180</span>    ALLOCATE Datasp1<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">1190</span>    ALLOCATE Datasp2<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">1200</span>    ALLOCATE Pwrstd<span class="token punctuation">(</span>Numfiles<span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Residuals<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">1210</span>    ALLOCATE Sc<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">1220</span>    !
<span class="token number">1230</span>    <span class="token comment" spellcheck="true">!  Read in </span><span class="token string">"raw"</span> <span class="token keyword">data</span><span class="token punctuation">:</span> each frequency<span class="token punctuation">,</span> file<span class="token punctuation">,</span> connect<span class="token punctuation">,</span> <span class="token function">repeat</span><span class="token punctuation">,</span> <span class="token function">variable</span>.
<span class="token number">1240</span>    <span class="token keyword">CALL</span> Readrawdata<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Meastype$<span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Residuals<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">1250</span>    !
<span class="token number">1260</span>    <span class="token comment" spellcheck="true">! Print tables of the </span><span class="token string">"raw"</span> <span class="token keyword">data</span>
<span class="token number">1270</span>    DISP <span class="token string">"...  PRINTING RAW DATA ...."</span>
<span class="token number">1280</span>    <span class="token keyword">CALL</span> Printrawdata<span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">1290</span>    !
<span class="token number">1300</span>    <span class="token comment" spellcheck="true">! ************************************</span>
<span class="token number">1310</span>    <span class="token comment" spellcheck="true">!  COMPUTE STATISTICS FOR REPORTS</span>
<span class="token number">1320</span>    <span class="token comment" spellcheck="true">! ************************************</span>
<span class="token number">1330</span>    !
<span class="token number">1340</span>    DISP <span class="token string">"...   COMPUTING ....."</span>
<span class="token number">1350</span>    <span class="token keyword">CALL</span> Computations<span class="token punctuation">(</span>Connectors$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Residuals<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">1360</span>    !
<span class="token number">1370</span>    <span class="token comment" spellcheck="true">!  Get rid of ALLOCATEd arrays not used again</span>
<span class="token number">1380</span>    DEALLOCATE Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">1390</span>    !
<span class="token number">1400</span>    <span class="token comment" spellcheck="true">!   ******************************</span>
<span class="token number">1410</span>    <span class="token comment" spellcheck="true">!   PRINT TABLES OF FINAL VALUES  (tables to be merged into cal reports)</span>
<span class="token number">1420</span>    <span class="token comment" spellcheck="true">!   ******************************</span>
<span class="token number">1430</span>    <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to print the tables of final results?"</span><span class="token punctuation">,</span>Prfin<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">1440</span>    <span class="token keyword">IF</span> Prfin <span class="token keyword">THEN</span> <span class="token keyword">CALL</span> Printtables<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">1450</span>    <span class="token keyword">CLEAR</span> SCREEN
<span class="token number">1460</span>    !
<span class="token number">1470</span>    <span class="token comment" spellcheck="true">! *****************************************************</span>
<span class="token number">1480</span>    <span class="token comment" spellcheck="true">! STORE DATA IN ARRAYS, CREATE ASCII FILES &amp; STORE DATA</span>
<span class="token number">1490</span>    <span class="token comment" spellcheck="true">! *****************************************************</span>
<span class="token number">1500</span>    !
<span class="token number">1510</span>    <span class="token keyword">IF</span> <span class="token operator">NOT</span> Checkdataonly <span class="token keyword">THEN</span> <span class="token keyword">CALL</span> Storedata<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Nisttestno$<span class="token punctuation">,</span>Ctype$<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">1520</span>    !
<span class="token number">1530</span>    <span class="token comment" spellcheck="true">!  **************************</span>
<span class="token number">1540</span>    <span class="token comment" spellcheck="true">!  IF OPERATOR WANTS PLOTS, STORE DATA FOR PLOTTING</span>
<span class="token number">1550</span>    <span class="token comment" spellcheck="true">!   *************************</span>
<span class="token number">1560</span>    !
<span class="token number">1570</span>    <span class="token comment" spellcheck="true">!  Plots available for all device types except variable &amp; non-reciprocal</span>
<span class="token number">1580</span> Doplots<span class="token punctuation">:</span> !
<span class="token number">1590</span>    ALLOCATE Button$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>[<span class="token number">40</span>]
<span class="token number">1600</span>    Dumpprint<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">1610</span>    Button$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"Plot and Print Graphs"</span>
<span class="token number">1620</span>    Button$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"Plot Graphs"</span>
<span class="token number">1630</span>    Button$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"No Graphs"</span>
<span class="token number">1640</span>    DIALOG <span class="token string">"QUESTION"</span><span class="token punctuation">,</span><span class="token string">"Do you want plots of the data?"</span><span class="token punctuation">,</span>Btn<span class="token punctuation">;</span><span class="token function">SET</span> <span class="token punctuation">(</span><span class="token string">"DIALOG BUTTONS"</span><span class="token punctuation">:</span>Button$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"PEN"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token number">1650</span>    <span class="token keyword">IF</span> Btn<span class="token operator">=</span><span class="token number">0</span> <span class="token operator">OR</span> Btn<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Wantplots<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">1660</span>    <span class="token keyword">IF</span> Btn<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> Dumpprint<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">1670</span>   <span class="token comment" spellcheck="true">!  Doplots: IF NOT POS(Meastype$,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want plots of the data?"</span><span class="token punctuation">,</span>Wantplots<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">1680</span>    <span class="token keyword">IF</span> Wantplots <span class="token keyword">THEN</span>
<span class="token number">1690</span>      ALLOCATE Sijplot<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Uncertlim<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span>
<span class="token number">1700</span>      <span class="token keyword">CALL</span> Storeplotdata<span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sijplot<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Uncertlim<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">1710</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">1720</span>    DEALLOCATE Button$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">1730</span>    !
<span class="token number">1740</span>    DEALLOCATE Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">1750</span>    !
<span class="token number">1760</span>    <span class="token comment" spellcheck="true">!  **********  DO PLOTS ********</span>
<span class="token number">1770</span>    <span class="token keyword">IF</span> Wantplots <span class="token keyword">THEN</span>
<span class="token number">1780</span>      DISP <span class="token string">".............  LOADING PLOTTING ROUTINES ............"</span>
<span class="token number">1790</span>      LOADSUB ALL FROM <span class="token string">"V:/PROGRAMS/SIXPORT/QCPLOT7"</span>
<span class="token number">1800</span>      <span class="token keyword">CALL</span> Plot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Sijplot<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Uncertlim<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">1810</span>      DELSUB Plot <span class="token keyword">TO</span> <span class="token keyword">END</span>
<span class="token number">1820</span>      DISP
<span class="token number">1830</span>      DEALLOCATE Sijplot<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Uncertlim<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">1840</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">1850</span>    CONTROL <span class="token number">1</span><span class="token punctuation">;</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">10</span>
<span class="token number">1860</span>    <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"THIS RUN IS DONE"</span>
<span class="token number">1870</span> Endmain<span class="token punctuation">:</span> SUBEND <span class="token comment" spellcheck="true">!.........Calrep6..................</span>


<span class="token number">1880</span> Findfile<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Findfile<span class="token punctuation">(</span>Nisttestno$<span class="token punctuation">,</span>Usingattenfile<span class="token punctuation">,</span>Mparm$<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">1890</span>  <span class="token comment" spellcheck="true">!Subroutine searches for and matches up attendent files fitting the</span>
<span class="token number">1900</span>  <span class="token comment" spellcheck="true">!description entered or operator enters file names to be read.</span>
<span class="token number">1910</span>  <span class="token comment" spellcheck="true">!Lynn S. Konecne 891228</span>
<span class="token number">1920</span>  <span class="token comment" spellcheck="true">!Input: The NIST number=Nisttestno$.</span>
<span class="token number">1930</span>  <span class="token comment" spellcheck="true">!       Usingattenfile=1 if files are all on the S: drive, =0 if operator</span>
<span class="token number">1940</span>  <span class="token comment" spellcheck="true">!        will enter file names.</span>
<span class="token number">1950</span>  <span class="token comment" spellcheck="true">!       From this data, the file and subfile directories are determined.</span>
<span class="token number">1960</span>  !
<span class="token number">1970</span>  <span class="token comment" spellcheck="true">! OUTPUT: Mparm$=</span><span class="token string">"P"</span> <span class="token keyword">for</span> power<span class="token punctuation">,</span> <span class="token string">"S"</span> <span class="token keyword">for</span> Sij.
<span class="token number">1980</span>  <span class="token comment" spellcheck="true">!        Using the two directories, the computer finds all attendant files</span>
<span class="token number">1990</span>  <span class="token comment" spellcheck="true">!        for Nisttestno$, which are printed on the screen.</span>
<span class="token number">2000</span>  <span class="token comment" spellcheck="true">!        Attendant file to be read is chosen, or operator enters files</span>
<span class="token number">2010</span>  <span class="token comment" spellcheck="true">!        to be read.  The final # of files to read= Numfiles, the</span>
<span class="token number">2020</span>  <span class="token comment" spellcheck="true">!        directory path for the files= Pathin$, the drive= Drivein$,</span>
<span class="token number">2030</span>  <span class="token comment" spellcheck="true">!        and an array of the file names= Filename$(*).</span>
<span class="token number">2040</span>  <span class="token comment" spellcheck="true">!        Filename$(*) is REDIMmed to the number of files Numfiles.</span>
<span class="token number">2050</span>  !
<span class="token number">2060</span>  <span class="token comment" spellcheck="true">!Local: Nistdevice$(*)= array of file names in the SRM directory</span>
<span class="token number">2070</span>  <span class="token comment" spellcheck="true">!       Filedir$, Sfiledir$- directory path determined by the input</span>
<span class="token number">2080</span>  <span class="token comment" spellcheck="true">!       Nfiles-the upper limit on files checked (in CAT of the directory)</span>
<span class="token number">2090</span>  !
<span class="token number">2100</span>    <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">2110</span>    <span class="token comment" spellcheck="true">! Create arrays for CAT of the directory, to hold matching attendant</span>
<span class="token number">2120</span>    <span class="token comment" spellcheck="true">!   files, and for the device type.</span>
<span class="token number">2130</span>    ALLOCATE Nistdevice$<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>[<span class="token number">80</span>]<span class="token punctuation">,</span>Tildename$<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>[<span class="token number">80</span>]
<span class="token number">2140</span>   <span class="token comment" spellcheck="true">! See if device type can be determined by the ID, or ask operator what</span>
<span class="token number">2150</span>   <span class="token comment" spellcheck="true">!  type of data will be read in.</span>
<span class="token number">2160</span>    Mparm$<span class="token operator">=</span><span class="token string">""</span>
<span class="token number">2170</span>    <span class="token keyword">IF</span> Nisttestno$[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span>]<span class="token operator">=</span><span class="token string">"C"</span> <span class="token keyword">THEN</span>
<span class="token number">2180</span>      <span class="token keyword">IF</span> Nisttestno$[<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span>]<span class="token operator">=</span><span class="token string">"1"</span> <span class="token operator">OR</span> Nisttestno$[<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span>]<span class="token operator">=</span><span class="token string">"2"</span> <span class="token keyword">THEN</span> Mparm$<span class="token operator">=</span><span class="token string">"S"</span>
<span class="token number">2190</span>      <span class="token keyword">IF</span> Nisttestno$[<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span>]<span class="token operator">=</span><span class="token string">"P"</span> <span class="token operator">OR</span> Nisttestno$[<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span>]<span class="token operator">=</span><span class="token string">"p"</span> <span class="token keyword">THEN</span> Mparm$<span class="token operator">=</span><span class="token string">"P"</span>
<span class="token number">2200</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">2210</span>    <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">""</span> <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! Operator indicates type of data</span>
<span class="token number">2220</span> Getdattype<span class="token punctuation">:</span> LINPUT <span class="token string">"Enter S for scattering parameters (1- or 2-port device), or P for power"</span><span class="token punctuation">,</span>Mparm$
<span class="token number">2230</span>      Mparm$<span class="token operator">=</span>UPC$<span class="token punctuation">(</span>Mparm$<span class="token punctuation">)</span>
<span class="token number">2240</span>      <span class="token keyword">IF</span> Mparm$<span class="token operator">&lt;&gt;</span><span class="token string">"S"</span> <span class="token operator">AND</span> Mparm$<span class="token operator">&lt;&gt;</span><span class="token string">"P"</span> <span class="token keyword">THEN</span> <span class="token keyword">GOTO</span> Getdattype
<span class="token number">2250</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">2260</span>    !
<span class="token number">2270</span>    <span class="token keyword">IF</span> Usingattenfile <span class="token keyword">THEN</span>
<span class="token number">2280</span>    <span class="token comment" spellcheck="true">!  Proper values of the NIST number only must be used.</span>
<span class="token number">2290</span>      <span class="token keyword">IF</span> Nisttestno$[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span>]<span class="token operator">=</span><span class="token string">"C"</span> <span class="token operator">OR</span> Nisttestno$[<span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span>]<span class="token operator">=</span><span class="token string">"_"</span> <span class="token keyword">THEN</span>
<span class="token number">2300</span>     <span class="token comment" spellcheck="true">!Check standard numbers start with C or end with _</span>
<span class="token number">2310</span>        Filedir$<span class="token operator">=</span><span class="token string">"/CKSTD"</span>
<span class="token number">2320</span>      <span class="token keyword">ELSE</span>
<span class="token number">2330</span>     <span class="token comment" spellcheck="true">!All other NIST numbers are for DUT</span>
<span class="token number">2340</span>        Filedir$<span class="token operator">=</span><span class="token string">"/DUT"</span>
<span class="token number">2350</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">2360</span>      <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">"P"</span> <span class="token keyword">THEN</span>
<span class="token number">2370</span>        Sfiledir$<span class="token operator">=</span><span class="token string">"/Powerstd"</span>
<span class="token number">2380</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">2390</span>      <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">"S"</span> <span class="token keyword">THEN</span>
<span class="token number">2400</span>        <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Is this device a 1-port?"</span><span class="token punctuation">,</span>Ans1p<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">2410</span>        <span class="token keyword">IF</span> Ans1p <span class="token keyword">THEN</span>
<span class="token number">2420</span>          Sfiledir$<span class="token operator">=</span><span class="token string">"/1_port"</span>
<span class="token number">2430</span>        <span class="token keyword">ELSE</span>
<span class="token number">2440</span>          Sfiledir$<span class="token operator">=</span><span class="token string">"/2_port"</span>
<span class="token number">2450</span>        <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">2460</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">2470</span>      Pathin$<span class="token operator">=</span>Filedir$<span class="token operator">&amp;</span>Sfiledir$
<span class="token number">2480</span>      Drivein$<span class="token operator">=</span><span class="token string">"s:"</span>
<span class="token number">2490</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">2500</span>    !
<span class="token number">2510</span>    <span class="token keyword">IF</span> Usingattenfile <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! Get file names from an attendant file</span>
<span class="token number">2520</span>  <span class="token comment" spellcheck="true">!CAT the directories into the string array Nistdevice$ and count the files</span>
<span class="token number">2530</span>      DISP <span class="token string">"... SEARCHING FOR FILES FOR "</span><span class="token punctuation">;</span>Nisttestno$<span class="token punctuation">;</span><span class="token string">" ...."</span>
<span class="token number">2540</span>      CAT <span class="token string">"s:"</span><span class="token operator">&amp;</span>Filedir$<span class="token operator">&amp;</span>Sfiledir$ <span class="token keyword">TO</span> Nistdevice$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>NO HEADER<span class="token punctuation">,</span><span class="token function">SELECT</span> Nisttestno$<span class="token punctuation">,</span>COUNT Nfiles<span class="token punctuation">,</span>NAMES
<span class="token number">2550</span>      <span class="token keyword">IF</span> Nfiles<span class="token operator">&lt;</span><span class="token number">3</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! See if there are more files from another system</span>
<span class="token number">2560</span>        CAT <span class="token string">"s:"</span><span class="token operator">&amp;</span>Filedir$<span class="token operator">&amp;</span>Sfiledir$ <span class="token keyword">TO</span> Tildename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>NO HEADER<span class="token punctuation">,</span><span class="token function">SELECT</span> Nisttestno$[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span>]<span class="token punctuation">,</span>COUNT Nfiles2
<span class="token number">2570</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">2580</span>      <span class="token keyword">IF</span> Nfiles<span class="token operator">=</span><span class="token number">0</span> <span class="token operator">AND</span> Nfiles2<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">2590</span>        <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"THERE ARE NO FILES ON THE SRM IN DIRECTORY "</span><span class="token punctuation">;</span>Filedir$<span class="token punctuation">;</span>Sfiledir$
<span class="token number">2600</span>        <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"FOR DEVICE "</span><span class="token punctuation">;</span>Nisttestno$
<span class="token number">2610</span>        <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">".....PROGRAM IS PAUSED in SUB Findfile  ..."</span>
<span class="token number">2620</span>        PAUSE
<span class="token number">2630</span>      <span class="token keyword">ELSE</span>   <span class="token comment" spellcheck="true">! Search the catalog for files of data for Nisttestno$.</span>
<span class="token number">2640</span>        <span class="token keyword">CALL</span> Searchfile<span class="token punctuation">(</span>Nistdevice$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tildename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Nisttestno$<span class="token punctuation">,</span>Nfiles<span class="token punctuation">,</span>Nfiles2<span class="token punctuation">,</span>Filedir$<span class="token punctuation">,</span>Sfiledir$<span class="token punctuation">,</span>Sel<span class="token punctuation">,</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">2650</span>        Numfiles<span class="token operator">=</span>Sel   <span class="token comment" spellcheck="true">! # of files in attendant file for Nisttestno$.</span>
<span class="token number">2660</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">2670</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">2680</span>    !
<span class="token number">2690</span>    <span class="token keyword">IF</span> <span class="token operator">NOT</span> Usingattenfile <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Operator inputs file names</span>
<span class="token number">2700</span>      <span class="token keyword">IF</span> Nisttestno$[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span>]<span class="token operator">=</span><span class="token string">"C"</span> <span class="token operator">OR</span> Nisttestno$[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span>]<span class="token operator">=</span><span class="token string">"c"</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> KBD<span class="token punctuation">;</span><span class="token string">"/CHECKSTD"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"H"</span><span class="token punctuation">;</span>
<span class="token number">2710</span>      <span class="token keyword">IF</span> Nisttestno$[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span>]<span class="token operator">&lt;&gt;</span><span class="token string">"C"</span> <span class="token operator">AND</span> Nisttestno$[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span>]<span class="token operator">&lt;&gt;</span><span class="token string">"c"</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> KBD<span class="token punctuation">;</span><span class="token string">"/CUSTOMER"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"H"</span><span class="token punctuation">;</span>
<span class="token number">2720</span>      LINPUT <span class="token string">"Enter DIRECTORY path name for the measurement files"</span><span class="token punctuation">,</span>Pathin$
<span class="token number">2730</span>      <span class="token function">OUTPUT</span> KBD<span class="token punctuation">;</span><span class="token string">"c:"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"H"</span><span class="token punctuation">;</span>
<span class="token number">2740</span>      LINPUT <span class="token string">"Enter DISC DRIVE for the measurement files"</span><span class="token punctuation">,</span>Drivein$
<span class="token number">2750</span>      <span class="token keyword">INPUT</span> <span class="token string">"How many measurement files do you want to process?"</span><span class="token punctuation">,</span>Numfiles
<span class="token number">2760</span>      <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfiles
<span class="token number">2770</span>        DISP <span class="token string">"Enter file name for file # "</span><span class="token punctuation">;</span>Eafile<span class="token punctuation">;</span>
<span class="token number">2780</span>        <span class="token keyword">IF</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> KBD<span class="token punctuation">;</span>Nisttestno$<span class="token punctuation">;</span><span class="token string">"."</span><span class="token punctuation">;</span>
<span class="token number">2790</span>        <span class="token keyword">IF</span> Eafile<span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> KBD<span class="token punctuation">;</span>Filename$<span class="token punctuation">(</span>Eafile<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"&lt;"</span><span class="token punctuation">;</span>
<span class="token number">2800</span>        LINPUT Filename$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span>
<span class="token number">2810</span>      <span class="token keyword">NEXT</span> Eafile
<span class="token number">2820</span>      DISP
<span class="token number">2830</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">2840</span>    <span class="token keyword">REDIM</span> Filename$<span class="token punctuation">(</span>Numfiles<span class="token punctuation">)</span>
<span class="token number">2850</span>    DEALLOCATE Nistdevice$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">2860</span>  SUBEND    <span class="token comment" spellcheck="true">!......Findfile.........</span>


<span class="token number">2870</span> Searchfile<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Searchfile<span class="token punctuation">(</span>Nistdevice$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tildename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Nisttestno$<span class="token punctuation">,</span>Nfiles<span class="token punctuation">,</span>Nfiles2<span class="token punctuation">,</span>Filedir$<span class="token punctuation">,</span>Sfiledir$<span class="token punctuation">,</span>Sel<span class="token punctuation">,</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">2880</span>   <span class="token comment" spellcheck="true">!Searches to find matching files, operator chooses which one</span>
<span class="token number">2890</span>   <span class="token comment" spellcheck="true">!  to use if there are more than one.</span>
<span class="token number">2900</span>   <span class="token comment" spellcheck="true">! INPUT: Nistdevice$(*)= list of file names on the SRM for the device</span>
<span class="token number">2910</span>   <span class="token comment" spellcheck="true">!            with ID Nisttestno$.  Nfiles= # of files in the list.</span>
<span class="token number">2920</span>   <span class="token comment" spellcheck="true">!            Filedir$&amp;Sfiledir$= SRM directory path.</span>
<span class="token number">2930</span>   <span class="token comment" spellcheck="true">!        Tildename$(*)= list of files whose first 5 chars matches Nisttestno$.  There</span>
<span class="token number">2940</span>   <span class="token comment" spellcheck="true">!             are Nfiles2 of them.  hpbasic truncates file names sometimes.</span>
<span class="token number">2950</span>   <span class="token comment" spellcheck="true">! OUTPUT: Sel= # of files chosen. Filename$(*)=</span>
<span class="token number">2960</span>   <span class="token comment" spellcheck="true">!         a list of those names</span>
<span class="token number">2970</span>   !
<span class="token number">2980</span>    <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">2990</span>    <span class="token keyword">DIM</span> Temp$<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span>[<span class="token number">16</span>]  <span class="token comment" spellcheck="true">! To hold files found for Nisttestno$</span>
<span class="token number">3000</span>    <span class="token keyword">DIM</span> Dum$[<span class="token number">80</span>]<span class="token punctuation">,</span>Nid$[<span class="token number">6</span>]
<span class="token number">3010</span>    <span class="token keyword">IF</span> Nfiles2<span class="token operator">&gt;</span><span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">!Found some truncated names</span>
<span class="token number">3020</span>      Realfile<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">3030</span>      <span class="token keyword">FOR</span> File<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Nfiles2  <span class="token comment" spellcheck="true">! check that all files are really for Nisttestno$</span>
<span class="token number">3040</span>        <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Tildename$<span class="token punctuation">(</span>File<span class="token punctuation">)</span><span class="token punctuation">,</span>"~"<span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">3050</span>          ASSIGN @Idcheck <span class="token keyword">TO</span> <span class="token string">"s:"</span><span class="token operator">&amp;</span>Filedir$<span class="token operator">&amp;</span>Sfiledir$<span class="token operator">&amp;</span><span class="token string">"/"</span><span class="token operator">&amp;</span>Tildename$<span class="token punctuation">(</span>File<span class="token punctuation">)</span>[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span>]
<span class="token number">3060</span>          ENTER @Idcheck<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">;</span>Dum$<span class="token punctuation">,</span>Nid$
<span class="token number">3070</span>          <span class="token keyword">IF</span> Nid$<span class="token operator">=</span>Nisttestno$ <span class="token keyword">THEN</span>
<span class="token number">3080</span>            Realfile<span class="token operator">=</span>Realfile<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">3090</span>            Nistdevice$<span class="token punctuation">(</span>Nfiles<span class="token operator">+</span>Realfile<span class="token punctuation">)</span><span class="token operator">=</span>Tildename$<span class="token punctuation">(</span>File<span class="token punctuation">)</span>
<span class="token number">3100</span>          <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">3110</span>        <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">3120</span>      <span class="token keyword">NEXT</span> File
<span class="token number">3130</span>      <span class="token keyword">REDIM</span> Nistdevice$<span class="token punctuation">(</span>Realfile<span class="token operator">+</span>Nfiles<span class="token punctuation">)</span>
<span class="token number">3140</span>      Nfiles<span class="token operator">=</span>Realfile<span class="token operator">+</span>Nfiles
<span class="token number">3150</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">3160</span>    !
<span class="token number">3170</span>    <span class="token keyword">REDIM</span> Nistdevice$<span class="token punctuation">(</span>Nfiles<span class="token punctuation">)</span>
<span class="token number">3180</span>    <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Nistdevice$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span>]<span class="token punctuation">,</span><span class="token string">"N"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Nistdevice$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span>]<span class="token punctuation">,</span><span class="token string">"n"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token function">MAT</span> SORT Nistdevice$  <span class="token comment" spellcheck="true">! If .N files from direct comparison, they'll be there FIRST</span>
<span class="token number">3190</span>    !
<span class="token number">3200</span>    I<span class="token operator">=</span><span class="token number">0</span>   <span class="token comment" spellcheck="true">! # of attendant files found for Nisttestno$</span>
<span class="token number">3210</span>    <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">3220</span>    <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"The following files were found for DUT # "</span><span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">" :"</span>
<span class="token number">3230</span>    <span class="token keyword">FOR</span> File<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Nfiles   <span class="token comment" spellcheck="true">! print files for the device</span>
<span class="token number">3240</span>      I<span class="token operator">=</span>I<span class="token operator">+</span><span class="token number">1</span>         <span class="token comment" spellcheck="true">! Keep track of the # of matching files found</span>
<span class="token number">3250</span>      Temp$<span class="token punctuation">(</span>I<span class="token punctuation">)</span>[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">16</span>]<span class="token operator">=</span>Nistdevice$<span class="token punctuation">(</span>File<span class="token punctuation">)</span>[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">16</span>]      <span class="token comment" spellcheck="true">! Store that file name</span>
<span class="token number">3260</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span>I<span class="token punctuation">,</span>Temp$<span class="token punctuation">(</span>I<span class="token punctuation">)</span>[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">16</span>]                    <span class="token comment" spellcheck="true">! Print the file name</span>
<span class="token number">3270</span>    <span class="token keyword">NEXT</span> File
<span class="token number">3280</span>    !
<span class="token number">3290</span>    <span class="token keyword">CALL</span> Choose<span class="token punctuation">(</span>Temp$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>I<span class="token punctuation">,</span>Filedir$<span class="token punctuation">,</span>Sfiledir$<span class="token punctuation">,</span>Sel<span class="token punctuation">,</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">!To choose attendant file to use.</span>
<span class="token number">3300</span>  SUBEND    <span class="token comment" spellcheck="true">!.......Searchfile...............</span>


<span class="token number">3310</span> Choose<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Choose<span class="token punctuation">(</span>Temp$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>I<span class="token punctuation">,</span>Filedir$<span class="token punctuation">,</span>Sfiledir$<span class="token punctuation">,</span>Sel<span class="token punctuation">,</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">!User picks attendent file to use</span>
<span class="token number">3320</span>         <span class="token comment" spellcheck="true">! Input: Temp$(*)= array of file names. I= # of files.</span>
<span class="token number">3330</span>         <span class="token comment" spellcheck="true">!       Filedir$&amp;Sfiledir$= directory path of the files.</span>
<span class="token number">3340</span>         !
<span class="token number">3350</span>         <span class="token comment" spellcheck="true">! Output: Sel= # of files to read</span>
<span class="token number">3360</span>         <span class="token comment" spellcheck="true">!         Filename$(*)= array of file names from the attendant file</span>
<span class="token number">3370</span>         !
<span class="token number">3380</span>  <span class="token comment" spellcheck="true">! A list offiles that can be used have been printed on the</span>
<span class="token number">3390</span>  <span class="token comment" spellcheck="true">!  screen for operator to choose from if there is more than one.</span>
<span class="token number">3400</span>    <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">3410</span>    DISP    <span class="token comment" spellcheck="true">! Clear </span><span class="token string">"SEARCHING FOR FILES"</span> message
<span class="token number">3420</span> <span class="token comment" spellcheck="true">!RAG   CALL Keyques(</span><span class="token string">"Do you want to process data from ALL of these files?"</span><span class="token punctuation">,</span>Allfiles<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">3430</span>    Allfiles<span class="token operator">=</span><span class="token number">0</span>    <span class="token comment" spellcheck="true">!RAG   Shuts off ability to select all files at once</span>
<span class="token number">3440</span>    <span class="token keyword">IF</span> Allfiles <span class="token keyword">THEN</span>
<span class="token number">3450</span>      <span class="token keyword">REDIM</span> Filename$<span class="token punctuation">(</span>I<span class="token punctuation">)</span>
<span class="token number">3460</span>      <span class="token function">MAT</span> Filename$<span class="token operator">=</span>Temp$
<span class="token number">3470</span>      Sel<span class="token operator">=</span>I
<span class="token number">3480</span>    <span class="token keyword">ELSE</span>
<span class="token number">3490</span>      <span class="token keyword">CALL</span> Readattnfile<span class="token punctuation">(</span>Filedir$<span class="token punctuation">,</span>Sfiledir$<span class="token punctuation">,</span>Temp$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>I<span class="token punctuation">,</span>Sel<span class="token punctuation">,</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">3500</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">3510</span>  SUBEND    <span class="token comment" spellcheck="true">!......Choose...........</span>


<span class="token number">3520</span> Readattnfile<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Readattnfile<span class="token punctuation">(</span>Filedir$<span class="token punctuation">,</span>Sfiledir$<span class="token punctuation">,</span>Temp$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>I<span class="token punctuation">,</span>Sel<span class="token punctuation">,</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">3530</span>  <span class="token comment" spellcheck="true">! INPUT: Filedir$&amp;Sfiledir$= directory path on SRM for the attendant file</span>
<span class="token number">3540</span>  <span class="token comment" spellcheck="true">!        Temp$(*)= array of all possible files for the device.</span>
<span class="token number">3550</span>  <span class="token comment" spellcheck="true">!        I= the number of file names in Temp$(*).</span>
<span class="token number">3560</span>  <span class="token comment" spellcheck="true">! OUTPUT: Sel= # of files to be read.</span>
<span class="token number">3570</span>  <span class="token comment" spellcheck="true">!         Filename$(*)= array of file names to read.</span>
<span class="token number">3580</span>    <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">3590</span>    !
<span class="token number">3600</span>    Sel<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">3610</span>    <span class="token keyword">FOR</span> X<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> I   <span class="token comment" spellcheck="true">! For every file name, ask operator if it's to be used</span>
<span class="token number">3620</span>      <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to use file "</span><span class="token operator">&amp;</span>Temp$<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">" ?"</span><span class="token punctuation">,</span>Useit<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">3630</span>      <span class="token keyword">IF</span> Useit <span class="token keyword">THEN</span>
<span class="token number">3640</span>        Sel<span class="token operator">=</span>Sel<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">3650</span>        Filename$<span class="token punctuation">(</span>Sel<span class="token punctuation">)</span><span class="token operator">=</span>Temp$<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token number">3660</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">3670</span>    <span class="token keyword">NEXT</span> X
<span class="token number">3680</span>    <span class="token keyword">REDIM</span> Filename$<span class="token punctuation">(</span>Sel<span class="token punctuation">)</span>
<span class="token number">3690</span>  SUBEND   <span class="token comment" spellcheck="true">!.......Readattnfile..............</span>


<span class="token number">3700</span> Readheader<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Readheader<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Ctype$<span class="token punctuation">,</span>Mparm$<span class="token punctuation">)</span>
<span class="token number">3710</span>  <span class="token comment" spellcheck="true">!  Read header info from the files.  Check that there are an = number for</span>
<span class="token number">3720</span>  <span class="token comment" spellcheck="true">!   each 6-port or direction.</span>
<span class="token number">3730</span>  <span class="token comment" spellcheck="true">!  Create a summary frequency array, &amp; file count in Filesperfreq(*).</span>
<span class="token number">3740</span>  <span class="token comment" spellcheck="true">! INPUT: Filename$(*) array of Numfiles files to read from directory</span>
<span class="token number">3750</span>  <span class="token comment" spellcheck="true">!         Pathin$ on drive Drivein$.</span>
<span class="token number">3760</span>  <span class="token comment" spellcheck="true">! OUTPUT: Timea$(*), Datea$(*)= time &amp; date from each file.</span>
<span class="token number">3770</span>  <span class="token comment" spellcheck="true">!         Sport(*)= 6-port or direction used for each file.</span>
<span class="token number">3780</span>  <span class="token comment" spellcheck="true">!         Cfile$(*), Cdate$(*)= calib files &amp; dates used.</span>
<span class="token number">3790</span>  <span class="token comment" spellcheck="true">!         Connectors$(*)= Connectors from each file</span>
<span class="token number">3800</span>  <span class="token comment" spellcheck="true">!         Ctype$= Shortened version of connector type measured.</span>
<span class="token number">3810</span>  <span class="token comment" spellcheck="true">!         FILESTORAM=1 if files copied to internal RAM for faster I/O</span>
<span class="token number">3820</span>  <span class="token comment" spellcheck="true">!       IN COM: Freq(*)= summary freq array of Numfreqs frequencies.</span>
<span class="token number">3830</span>  <span class="token comment" spellcheck="true">!               Setting$(*)= all settings measured, if device variable.</span>
<span class="token number">3840</span>  !
<span class="token number">3850</span>  <span class="token comment" spellcheck="true">! Other variables in the header are set = to those in the last file</span>
<span class="token number">3860</span>  <span class="token comment" spellcheck="true">!   read, and are assumed = to those that are in the rest of the files.</span>
<span class="token number">3870</span>  !
<span class="token number">3880</span>    <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">3890</span>    <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$<span class="token punctuation">,</span>Devicedescript$<span class="token punctuation">,</span>Oneportonly
<span class="token number">3900</span>    <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">3910</span>    <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">3920</span>  !
<span class="token number">3930</span>    ALLOCATE File$[<span class="token number">20</span>] <span class="token comment" spellcheck="true">! File being read in</span>
<span class="token number">3940</span>    ALLOCATE Spid$[<span class="token number">20</span>]<span class="token punctuation">,</span>Systemletter$[<span class="token number">1</span>]<span class="token punctuation">,</span>Conncal$[<span class="token number">26</span>] <span class="token comment" spellcheck="true">! System ID, System lettter, connectors calibrated</span>
<span class="token number">3950</span>    ALLOCATE Programm$[<span class="token number">10</span>]<span class="token punctuation">,</span>Rev$[<span class="token number">11</span>]<span class="token punctuation">,</span>Opr$[<span class="token number">28</span>]<span class="token comment" spellcheck="true">! Prog name, revision, operator</span>
<span class="token number">3960</span>    ALLOCATE Mess$[<span class="token number">500</span>]      <span class="token comment" spellcheck="true">! Used as message string for file name problem warning    !RAG</span>
<span class="token number">3961</span>    ALLOCATE Buttons$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>[<span class="token number">20</span>]
<span class="token number">3970</span>    !
<span class="token number">3980</span>    <span class="token comment" spellcheck="true">!  Add a slash for proper directory path syntax if path name input</span>
<span class="token number">3990</span>    <span class="token keyword">IF</span> Pathin$<span class="token operator">&lt;&gt;</span><span class="token string">""</span> <span class="token keyword">THEN</span>
<span class="token number">4000</span>      <span class="token keyword">IF</span> Pathin$[<span class="token function">LEN</span><span class="token punctuation">(</span>Pathin$<span class="token punctuation">)</span>]<span class="token operator">&lt;&gt;</span><span class="token string">"/"</span> <span class="token keyword">THEN</span> Pathin$<span class="token operator">=</span>Pathin$<span class="token operator">&amp;</span><span class="token string">"/"</span>
<span class="token number">4010</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">4020</span>    !
<span class="token number">4030</span>    Oneportonly<span class="token operator">=</span><span class="token number">1</span>     <span class="token comment" spellcheck="true">! All but meas on direct comparison system or 8510</span>
<span class="token number">4040</span>                      <span class="token comment" spellcheck="true">!  measured on both ports (2 files per device)</span>
<span class="token number">4050</span>    <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfiles  <span class="token comment" spellcheck="true">! Each file</span>
<span class="token number">4060</span>      File$<span class="token operator">=</span>Filename$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span>
<span class="token number">4070</span>      ASSIGN @Infile <span class="token keyword">TO</span> Drivein$<span class="token operator">&amp;</span>Pathin$<span class="token operator">&amp;</span>File$
<span class="token number">4080</span>      !
<span class="token number">4090</span>      ENTER @Infile<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span>Spid$<span class="token punctuation">,</span>Systemletter$<span class="token punctuation">,</span>Conncal$<span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">,</span>Meastype$<span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span>
<span class="token number">4100</span>  <span class="token comment" spellcheck="true">! The following changes meastype$ from HP437 to Thermistor.  This is done in order to</span>
<span class="token number">4110</span>      <span class="token keyword">IF</span> Meastype$<span class="token operator">=</span><span class="token string">"HP437"</span> <span class="token keyword">THEN</span> Meastype$<span class="token operator">=</span><span class="token string">"Thermistor"</span>
<span class="token number">4120</span>      <span class="token keyword">IF</span> Spid$<span class="token operator">=</span><span class="token string">"Direct Comparison"</span> <span class="token operator">OR</span> Systemletter$<span class="token operator">=</span><span class="token string">"L"</span> <span class="token operator">OR</span> Systemletter$<span class="token operator">=</span><span class="token string">"N"</span> <span class="token keyword">THEN</span> Oneportonly<span class="token operator">=</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! 1 file per device for DC System or 8510</span>
<span class="token number">4130</span>      <span class="token keyword">IF</span> <span class="token punctuation">(</span>Spid$<span class="token operator">=</span><span class="token string">"8510"</span> <span class="token operator">OR</span> Systemletter$<span class="token operator">=</span><span class="token string">"L"</span><span class="token punctuation">)</span> <span class="token operator">AND</span> Meastype$<span class="token operator">=</span><span class="token string">"1-port"</span> <span class="token operator">AND</span> Mparm$<span class="token operator">=</span><span class="token string">"P"</span> <span class="token keyword">THEN</span> Mparm$<span class="token operator">=</span><span class="token string">"S"</span>   <span class="token comment" spellcheck="true">! 8510 measures Gamma for power devices</span>
<span class="token number">4140</span>      ENTER @Infile<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">;</span>Programm$<span class="token punctuation">,</span>Rev$<span class="token punctuation">,</span>Opr$<span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span>
<span class="token number">4150</span>      <span class="token keyword">IF</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! Set connectors type for result files,</span>
<span class="token number">4160</span>                        <span class="token comment" spellcheck="true">!  read in other info that should be same all files</span>
<span class="token number">4170</span>        <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connectors$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"N"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Ctype$<span class="token operator">=</span><span class="token string">"Type_N"</span>     <span class="token comment" spellcheck="true">! Type N</span>
<span class="token number">4180</span>        <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connectors$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"7"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Ctype$<span class="token operator">=</span><span class="token string">"7_mm"</span>       <span class="token comment" spellcheck="true">! 7 mm</span>
<span class="token number">4190</span>        <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connectors$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"14"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Ctype$<span class="token operator">=</span><span class="token string">"14_mm"</span>     <span class="token comment" spellcheck="true">! 14 mm</span>
<span class="token number">4200</span>        <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connectors$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"3"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Ctype$<span class="token operator">=</span><span class="token string">"3.5_mm"</span>     <span class="token comment" spellcheck="true">! 3.5 mm</span>
<span class="token number">4210</span>        <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connectors$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"2.9"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Ctype$<span class="token operator">=</span><span class="token string">"2.9_mm"</span>   <span class="token comment" spellcheck="true">! 2.92 mm</span>
<span class="token number">4220</span>        <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connectors$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"2.4"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Ctype$<span class="token operator">=</span><span class="token string">"2.4_mm"</span>   <span class="token comment" spellcheck="true">! 2.4 mm</span>
<span class="token number">4230</span>        <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connectors$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"W"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Ctype$<span class="token operator">=</span><span class="token string">"Wguide"</span>     <span class="token comment" spellcheck="true">! Waveguide</span>
<span class="token number">4240</span>        <span class="token keyword">IF</span> Ctype$<span class="token operator">=</span><span class="token string">""</span> <span class="token keyword">THEN</span>
<span class="token number">4250</span>          <span class="token keyword">CLEAR</span> SCREEN
<span class="token number">4260</span>          CONTROL <span class="token number">1</span><span class="token punctuation">;</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">10</span>
<span class="token number">4270</span>          <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"WARNING"</span>
<span class="token number">4280</span>          <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">4290</span>          CONTROL <span class="token number">1</span><span class="token punctuation">;</span><span class="token number">10</span>
<span class="token number">4300</span>          <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"UNCERTAINTIES FOR "</span><span class="token punctuation">;</span>Connectors$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">" DEVICES ARE NOT AVAILABLE."</span>
<span class="token number">4310</span>          <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">4320</span>          CONTROL <span class="token number">1</span><span class="token punctuation">;</span><span class="token number">10</span>
<span class="token number">4330</span>          <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"... PROGRAM PAUSED in SUB Readheader  ..."</span>
<span class="token number">4340</span>          <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"For a printout of data without valid uncertainties, press CONTINUE"</span>
<span class="token number">4350</span>          PAUSE
<span class="token number">4360</span>        <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">4370</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">4380</span>       !
<span class="token number">4390</span>      ENTER @Infile<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">;</span>Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats
<span class="token number">4400</span>      ENTER @Infile<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">;</span>Devicedescript$<span class="token punctuation">,</span>Devicenum$  <span class="token comment" spellcheck="true">! Device description</span>
<span class="token number">4410</span>      <span class="token keyword">IF</span> UPC$<span class="token punctuation">(</span>Devicenum$<span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span>UPC$<span class="token punctuation">(</span>File$[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span>]<span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token punctuation">(</span>File$[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span>]<span class="token operator">=</span><span class="token string">"c"</span> <span class="token operator">OR</span> File$[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span>]<span class="token operator">=</span><span class="token string">"C"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">4420</span>        Mess$<span class="token operator">=</span><span class="token string">"The FILE NAME and the DEVICE NUMBER written in the file DO NOT MATCH"</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"This needs to be resolved before CALREP can use these files"</span>
<span class="token number">4430</span>        Mess$<span class="token operator">=</span>Mess$<span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"The offending file is "</span><span class="token operator">&amp;</span>File$<span class="token operator">&amp;</span><span class="token string">" the device number in the file is "</span><span class="token operator">&amp;</span>Devicenum$
<span class="token number">4440</span>        DIALOG <span class="token string">"WARNING"</span><span class="token punctuation">,</span>Mess$<span class="token punctuation">;</span><span class="token function">SET</span> <span class="token punctuation">(</span><span class="token string">"X"</span><span class="token punctuation">:</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token string">"Y"</span><span class="token punctuation">:</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"BACKGROUND"</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">"PEN"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token number">4441</span>        Buttons$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"STOP"</span>
<span class="token number">4442</span>        Buttons$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"Proceed"</span>
<span class="token number">4443</span>        Mess$<span class="token operator">=</span><span class="token string">"Do you want to 'STOP' CALREP and fix the problem, or do you want to "</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"'Proceed' with the processing of the device data ?"</span>
<span class="token number">4444</span>        DIALOG <span class="token string">"QUESTION"</span><span class="token punctuation">,</span>Mess$<span class="token punctuation">,</span>Btn<span class="token punctuation">;</span><span class="token function">SET</span> <span class="token punctuation">(</span><span class="token string">"DIALOG BUTTONS"</span><span class="token punctuation">:</span>Buttons$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"X"</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token string">"Y"</span><span class="token punctuation">:</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token string">"PEN"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token number">4445</span>        <span class="token keyword">IF</span> Btn<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token keyword">STOP</span>
<span class="token number">4460</span>      <span class="token keyword">ELSE</span>
<span class="token number">4470</span>        <span class="token keyword">IF</span> UPC$<span class="token punctuation">(</span>Devicenum$<span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span>UPC$<span class="token punctuation">(</span>File$[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span>]<span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">4475</span>          Mess$<span class="token operator">=</span><span class="token string">"The FILE NAME and the DEVICE NUMBER written in the file DO NOT MATCH"</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"This device is not a check standard - CALREP will resume when 'OK' is pressed"</span>
<span class="token number">4476</span>          Mess$<span class="token operator">=</span>Mess$<span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"The offending file is "</span><span class="token operator">&amp;</span>File$<span class="token operator">&amp;</span><span class="token string">" the device number in the file is "</span><span class="token operator">&amp;</span>Devicenum$
<span class="token number">4477</span>          DIALOG <span class="token string">"WARNING"</span><span class="token punctuation">,</span>Mess$<span class="token punctuation">;</span><span class="token function">SET</span> <span class="token punctuation">(</span><span class="token string">"X"</span><span class="token punctuation">:</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token string">"Y"</span><span class="token punctuation">:</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"PEN"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token number">4478</span>        <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">4480</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">4490</span>      ASSIGN @Infile <span class="token keyword">TO</span> <span class="token operator">*</span>
<span class="token number">4500</span>    <span class="token keyword">NEXT</span> Eafile
<span class="token number">4510</span>    !
<span class="token number">4520</span>    <span class="token comment" spellcheck="true">!  Check that there are an equal # of files on port 1 &amp; 2 or forward &amp;</span>
<span class="token number">4530</span>    <span class="token comment" spellcheck="true">!  reverse.</span>
<span class="token number">4540</span>    !
<span class="token number">4550</span>    <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfiles
<span class="token number">4560</span>      <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Nocc1<span class="token operator">=</span>Nocc1<span class="token operator">+</span><span class="token number">1</span>    <span class="token comment" spellcheck="true">! # with Sp=1</span>
<span class="token number">4570</span>      <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Nocc2<span class="token operator">=</span>Nocc2<span class="token operator">+</span><span class="token number">1</span>    <span class="token comment" spellcheck="true">! # with Sp=2</span>
<span class="token number">4580</span>    <span class="token keyword">NEXT</span> Eafile
<span class="token number">4590</span>    <span class="token keyword">IF</span> Nocc1<span class="token operator">&lt;&gt;</span>Nocc2 <span class="token operator">AND</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token operator">NOT</span> Oneportonly <span class="token keyword">THEN</span>
<span class="token number">4600</span>      <span class="token keyword">CLEAR</span> SCREEN
<span class="token number">4610</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"HEY!!!  YOU HAVE "</span><span class="token punctuation">;</span>Nocc1<span class="token punctuation">;</span><span class="token string">" FILES FOR PORT 1 (FORWARD) AND "</span>
<span class="token number">4620</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"                 "</span><span class="token punctuation">;</span>Nocc2<span class="token punctuation">;</span><span class="token string">" FILES FOR PORT 2 (REVERSE) !!!"</span>
<span class="token number">4630</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">4640</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"YOU MUST HAVE AN EQUAL NUMBER OF FILES FOR PORT 1 AND 2"</span>
<span class="token number">4650</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"(or forward &amp; reverse)  FOR THIS PROGRAM TO WORK."</span>
<span class="token number">4660</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">4670</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"PROGRAM PAUSED IN SUB Readheader..."</span>
<span class="token number">4680</span>      PAUSE
<span class="token number">4690</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">4700</span>    !
<span class="token number">4710</span>    <span class="token comment" spellcheck="true">!   CALL SUB TO GET SUMMARY FREQ INFO.  RETURNED: Freq(*)= the</span>
<span class="token number">4720</span>    <span class="token comment" spellcheck="true">!      frequencies, Numfreqs= total number of frequencies.</span>
<span class="token number">4730</span>    <span class="token comment" spellcheck="true">!  *************************</span>
<span class="token number">4740</span>    <span class="token keyword">CALL</span> Freqarr<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">)</span>
<span class="token number">4750</span>    <span class="token keyword">REDIM</span> Filesperfreq<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">4760</span>    !
<span class="token number">4770</span>    <span class="token comment" spellcheck="true">! IF DEVICE IS VARIABLE, call SUB to get summary variable settings info</span>
<span class="token number">4780</span>    <span class="token comment" spellcheck="true">!   RETURNED:  Setting$(*) has setting description summaries.</span>
<span class="token number">4790</span>    <span class="token comment" spellcheck="true">!              Numrepeats has TOTAL number of var settings measured.</span>
<span class="token number">4800</span>    <span class="token comment" spellcheck="true">!              Mags(*) has VALUES of settings descriptions measured</span>
<span class="token number">4810</span>    <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token keyword">CALL</span> Setarr<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">)</span>
<span class="token number">4820</span>    <span class="token keyword">REDIM</span> Filesperset<span class="token punctuation">(</span>Numrepeats<span class="token punctuation">,</span>Numfiles<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">4830</span>    <span class="token keyword">IF</span> Meastype$<span class="token operator">=</span><span class="token string">"2-portVNR"</span> <span class="token keyword">THEN</span> Meastype$<span class="token operator">=</span><span class="token string">"2-portV"</span>
<span class="token number">4840</span>  SUBEND    <span class="token comment" spellcheck="true">!........Readheader.......</span>


<span class="token number">4850</span> Freqarr<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Freqarr<span class="token punctuation">(</span>Mrn$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Ncal<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Nfreq<span class="token punctuation">)</span>
<span class="token number">4860</span>  <span class="token comment" spellcheck="true">! This SUB reads in freqs from each data file &amp; makes a summary array of</span>
<span class="token number">4870</span>  <span class="token comment" spellcheck="true">!    all the frequencies.</span>
<span class="token number">4880</span>  !
<span class="token number">4890</span>  <span class="token comment" spellcheck="true">! INPUT:  Mrn$(Ncal)= array of file names to be read.</span>
<span class="token number">4900</span>  <span class="token comment" spellcheck="true">!         Ncal= # of files.</span>
<span class="token number">4910</span>  <span class="token comment" spellcheck="true">!         Pathin$= directory path name for the files.</span>
<span class="token number">4920</span>  <span class="token comment" spellcheck="true">!         Drivein$= disc drive for the files.</span>
<span class="token number">4930</span>  !
<span class="token number">4940</span>  <span class="token comment" spellcheck="true">! OUTPUT: Freq(Nfreq)= summary array of freqs in all the files.</span>
<span class="token number">4950</span>  <span class="token comment" spellcheck="true">!         Nfreq= total number of freqs measured for the device.</span>
<span class="token number">4960</span>  !
<span class="token number">4970</span>    <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">4980</span>    ALLOCATE D$[<span class="token number">11</span>] <span class="token comment" spellcheck="true">! Dummy var to read in the file date.</span>
<span class="token number">4990</span>    <span class="token keyword">IF</span> Pathin$<span class="token operator">&lt;&gt;</span><span class="token string">""</span> <span class="token keyword">THEN</span>
<span class="token number">5000</span>      <span class="token keyword">IF</span> Pathin$[<span class="token function">LEN</span><span class="token punctuation">(</span>Pathin$<span class="token punctuation">)</span>]<span class="token operator">&lt;&gt;</span><span class="token string">"/"</span> <span class="token keyword">THEN</span> Pathin$<span class="token operator">=</span>Pathin$<span class="token operator">&amp;</span><span class="token string">"/"</span>
<span class="token number">5010</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">5020</span>    !
<span class="token number">5030</span>    <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"...Please wait... MAKING SUMMARY FREQUENCY ARRAY...."</span>
<span class="token number">5040</span>    !
<span class="token number">5050</span>    <span class="token keyword">IF</span> Ncal<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! Assume both files have same freq list to save time</span>
<span class="token number">5060</span>      ASSIGN @Gofile <span class="token keyword">TO</span> Drivein$<span class="token operator">&amp;</span>Pathin$<span class="token operator">&amp;</span>Mrn$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">5070</span>      <span class="token comment" spellcheck="true">! Enter the important info:  Nfreqthisfile= # freqs in file # Files.</span>
<span class="token number">5080</span>      ENTER @Gofile<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">;</span>Sp<span class="token punctuation">,</span>M<span class="token punctuation">,</span>Nq<span class="token punctuation">,</span>Nbs<span class="token punctuation">,</span>Nfreq<span class="token punctuation">,</span>Startfreq
<span class="token number">5090</span>       <span class="token comment" spellcheck="true">!Redimension the array for freqs in this file.</span>
<span class="token number">5100</span>      <span class="token keyword">REDIM</span> Freq<span class="token punctuation">(</span>Nfreq<span class="token punctuation">)</span>
<span class="token number">5110</span>       <span class="token comment" spellcheck="true">!Get an array of frequencies from the file</span>
<span class="token number">5120</span>      ENTER @Gofile<span class="token punctuation">,</span>Startfreq <span class="token comment" spellcheck="true">! Set file pointer to start of freq array</span>
<span class="token number">5130</span>      ENTER @Gofile<span class="token punctuation">;</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">! Read in the array</span>
<span class="token number">5140</span>    <span class="token keyword">ELSE</span>
<span class="token number">5150</span>      <span class="token keyword">FOR</span> <span class="token keyword">Files</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Ncal   <span class="token comment" spellcheck="true">! Each file</span>
<span class="token number">5160</span>       <span class="token comment" spellcheck="true">!Give a path name to the directory and each file name and get data</span>
<span class="token number">5170</span>        ASSIGN @Gofile <span class="token keyword">TO</span> Drivein$<span class="token operator">&amp;</span>Pathin$<span class="token operator">&amp;</span>Mrn$<span class="token punctuation">(</span><span class="token keyword">Files</span><span class="token punctuation">)</span>
<span class="token number">5180</span>      <span class="token comment" spellcheck="true">! Enter the important info:  Nfreqthisfile= # freqs in file # Files.</span>
<span class="token number">5190</span>        ENTER @Gofile<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">;</span>Sp<span class="token punctuation">,</span>M<span class="token punctuation">,</span>Nq<span class="token punctuation">,</span>Nbs<span class="token punctuation">,</span>Nfreqthisfile<span class="token punctuation">,</span>Startfreq
<span class="token number">5200</span>       <span class="token comment" spellcheck="true">!Redimension the array for freqs in this file.</span>
<span class="token number">5210</span>        ALLOCATE Freqfile<span class="token punctuation">(</span>Nfreqthisfile<span class="token punctuation">)</span>
<span class="token number">5220</span>       <span class="token comment" spellcheck="true">!Get an array of frequencies from the file</span>
<span class="token number">5230</span>        ENTER @Gofile<span class="token punctuation">,</span>Startfreq<span class="token comment" spellcheck="true">! Set file pointer to start of freq array</span>
<span class="token number">5240</span>        ENTER @Gofile<span class="token punctuation">;</span>Freqfile<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! Read in the array</span>
<span class="token number">5250</span>      !
<span class="token number">5260</span>        <span class="token keyword">IF</span> <span class="token keyword">Files</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">!With the first file, create a matrix</span>
<span class="token number">5270</span>         <span class="token comment" spellcheck="true">!  Store the freqs read in for the first file.</span>
<span class="token number">5280</span>          <span class="token function">MAT</span> Freq<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span>Nfreqthisfile<span class="token punctuation">)</span><span class="token operator">=</span>Freqfile<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span>Nfreqthisfile<span class="token punctuation">)</span>
<span class="token number">5290</span>          Totalnumfreqs<span class="token operator">=</span>Nfreqthisfile <span class="token comment" spellcheck="true">! Counter for total # freqs</span>
<span class="token number">5300</span>          Numnewfreqs<span class="token operator">=</span><span class="token number">0</span> <span class="token comment" spellcheck="true">!No new frequencies noted yet</span>
<span class="token number">5310</span>        <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">5320</span>      !
<span class="token number">5330</span>        <span class="token keyword">IF</span> <span class="token keyword">Files</span><span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Need to compare freqs read in with those stored</span>
<span class="token number">5340</span>          <span class="token keyword">FOR</span> Counter<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Nfreqthisfile <span class="token comment" spellcheck="true">! Each freq read in</span>
<span class="token number">5350</span>            Numcompared<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">5360</span>            Mismatch<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">5370</span>            Samefreq<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">5380</span>            <span class="token function">REPEAT</span> <span class="token comment" spellcheck="true">! Search for matching freqs</span>
<span class="token number">5390</span>              Numcompared<span class="token operator">=</span>Numcompared<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">5400</span>              <span class="token keyword">IF</span> Numcompared<span class="token operator">&gt;</span>Totalnumfreqs <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">!A new frequency exists</span>
<span class="token number">5410</span>                Mismatch<span class="token operator">=</span><span class="token number">1</span>     <span class="token comment" spellcheck="true">!The new freq. has been noted</span>
<span class="token number">5420</span>                Totalnumfreqs<span class="token operator">=</span>Totalnumfreqs<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">5430</span>                Freq<span class="token punctuation">(</span>Totalnumfreqs<span class="token punctuation">)</span><span class="token operator">=</span>Freqfile<span class="token punctuation">(</span>Counter<span class="token punctuation">)</span>
<span class="token number">5440</span>              <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">5450</span>              <span class="token keyword">IF</span> Freqfile<span class="token punctuation">(</span>Counter<span class="token punctuation">)</span><span class="token operator">=</span>Freq<span class="token punctuation">(</span>Numcompared<span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">5460</span>                Samefreq<span class="token operator">=</span><span class="token number">1</span>     <span class="token comment" spellcheck="true">!A duplicate has been noted</span>
<span class="token number">5470</span>              <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">5480</span>            <span class="token keyword">UNTIL</span> Mismatch<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">OR</span> Samefreq<span class="token operator">=</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">!The frequencies have all been checked for new ones or for duplicates</span>
<span class="token number">5490</span>          <span class="token keyword">NEXT</span> Counter
<span class="token number">5500</span>        <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">5510</span>        DEALLOCATE Freqfile<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! To start over w/new file</span>
<span class="token number">5520</span>      <span class="token keyword">NEXT</span> <span class="token keyword">Files</span>
<span class="token number">5530</span>    !
<span class="token number">5540</span>    <span class="token comment" spellcheck="true">!  Redimension the Freq array with the new Totalnumfreqs</span>
<span class="token number">5550</span>      <span class="token keyword">REDIM</span> Freq<span class="token punctuation">(</span>Totalnumfreqs<span class="token punctuation">)</span>
<span class="token number">5560</span>      Nfreq<span class="token operator">=</span>Totalnumfreqs      <span class="token comment" spellcheck="true">! Total # of freqs in the files</span>
<span class="token number">5570</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">5580</span>    <span class="token comment" spellcheck="true">!Sort the Freq array to put the frequencies in ascending order</span>
<span class="token number">5590</span>      <span class="token function">MAT</span> SORT Freq
<span class="token number">5600</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">5610</span>    <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">5620</span>    <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"Frequencies for this device, in GHz, ="</span>
<span class="token number">5630</span>    <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">5640</span>    <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">5650</span>    <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">5660</span>  SUBEND   <span class="token comment" spellcheck="true">!......Freqarr......</span>


<span class="token number">5670</span> Setarr<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Setarr<span class="token punctuation">(</span>Mrn$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Ncal<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">)</span>
<span class="token number">5680</span>  <span class="token comment" spellcheck="true">! This SUB reads in settings from each data file &amp; makes a summary array</span>
<span class="token number">5690</span>  <span class="token comment" spellcheck="true">!    all the settings measured for a variable device (e.g. phase shifter</span>
<span class="token number">5700</span>  <span class="token comment" spellcheck="true">!    or variable attenuator).  Operator is asked to verify the resulting</span>
<span class="token number">5710</span>  <span class="token comment" spellcheck="true">!    list, and can correct it if necessary.  If program does not produce</span>
<span class="token number">5720</span>  <span class="token comment" spellcheck="true">!    the correct list, then operator will have to verify which files have</span>
<span class="token number">5730</span>  <span class="token comment" spellcheck="true">!    which settings when the files are read in.</span>
<span class="token number">5740</span>  !
<span class="token number">5750</span>  <span class="token comment" spellcheck="true">! INPUT:  Mrn$(Ncal)= array of file names to be read.</span>
<span class="token number">5760</span>  <span class="token comment" spellcheck="true">!         Ncal= # of files.</span>
<span class="token number">5770</span>  <span class="token comment" spellcheck="true">!         Pathin$= directory path name for the files.</span>
<span class="token number">5780</span>  <span class="token comment" spellcheck="true">!         Drivein$= disc drive for the files.</span>
<span class="token number">5790</span>  !
<span class="token number">5800</span>  <span class="token comment" spellcheck="true">! OUTPUT: Setting$(*)= summary array of settings descriptions, ALL files.</span>
<span class="token number">5810</span>  <span class="token comment" spellcheck="true">!         Numrepeats= TOTAL number of settings measured for the device.</span>
<span class="token number">5820</span>  !
<span class="token number">5830</span>    <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">5840</span>    <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">5850</span>    <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">5860</span>    !
<span class="token number">5870</span>    <span class="token keyword">IF</span> Pathin$<span class="token operator">&lt;&gt;</span><span class="token string">""</span> <span class="token keyword">THEN</span>
<span class="token number">5880</span>      <span class="token keyword">IF</span> Pathin$[<span class="token function">LEN</span><span class="token punctuation">(</span>Pathin$<span class="token punctuation">)</span>]<span class="token operator">&lt;&gt;</span><span class="token string">"/"</span> <span class="token keyword">THEN</span> Pathin$<span class="token operator">=</span>Pathin$<span class="token operator">&amp;</span><span class="token string">"/"</span>
<span class="token number">5890</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">5900</span>    !
<span class="token number">5910</span>    <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"...Please wait... MAKING SUMMARY VARIABLE SETTINGS ARRAY...."</span>
<span class="token number">5920</span>    !
<span class="token number">5930</span>    <span class="token keyword">FOR</span> <span class="token keyword">Files</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Ncal     <span class="token comment" spellcheck="true">! Each file</span>
<span class="token number">5940</span>       <span class="token comment" spellcheck="true">!Give a path name to the directory and each file name and get data</span>
<span class="token number">5950</span>      ASSIGN @Gofile <span class="token keyword">TO</span> Drivein$<span class="token operator">&amp;</span>Pathin$<span class="token operator">&amp;</span>Mrn$<span class="token punctuation">(</span><span class="token keyword">Files</span><span class="token punctuation">)</span>
<span class="token number">5960</span>      <span class="token comment" spellcheck="true">! Enter the important info:  Nfreqthisfile= # freqs in file # Files.</span>
<span class="token number">5970</span>      ENTER @Gofile<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">;</span>Sp<span class="token punctuation">,</span>M<span class="token punctuation">,</span>Nq<span class="token punctuation">,</span>Nbs<span class="token punctuation">,</span>Nfreqthisfile<span class="token punctuation">,</span>Startfreq<span class="token punctuation">,</span>Startindex
<span class="token number">5980</span>       <span class="token comment" spellcheck="true">!Redimension the array for data index, &amp; # of settings, in this file</span>
<span class="token number">5990</span>      ALLOCATE Dataindex<span class="token punctuation">(</span>M<span class="token punctuation">,</span>Nfreqthisfile<span class="token punctuation">)</span><span class="token punctuation">,</span>Setthisfile$<span class="token punctuation">(</span>Nq<span class="token punctuation">)</span>[<span class="token number">10</span>]
<span class="token number">6000</span>       <span class="token comment" spellcheck="true">!Get an array of start recs of connects from the file</span>
<span class="token number">6010</span>      ENTER @Gofile<span class="token punctuation">,</span>Startindex <span class="token comment" spellcheck="true">! Set file pointer to start of index array</span>
<span class="token number">6020</span>      ENTER @Gofile<span class="token punctuation">;</span>Dataindex<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">! Read in the array</span>
<span class="token number">6030</span>      !
<span class="token number">6040</span>      <span class="token comment" spellcheck="true">! Enter all the setting string descriptions from this file</span>
<span class="token number">6050</span>      !
<span class="token number">6060</span>      <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Nq    <span class="token comment" spellcheck="true">! Every repeat (setting)</span>
<span class="token number">6070</span>        <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> ENTER @Gofile<span class="token punctuation">,</span>Dataindex<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>Easet<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>Dum<span class="token punctuation">,</span>Dum<span class="token punctuation">,</span>Dum<span class="token punctuation">,</span>Setthisfile$<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! 1-port</span>
<span class="token number">6080</span>        <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> ENTER @Gofile<span class="token punctuation">,</span>Dataindex<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>Easet<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>Dum<span class="token punctuation">,</span>Dum<span class="token punctuation">,</span>Dum<span class="token punctuation">,</span>Dum<span class="token punctuation">,</span>Dum<span class="token punctuation">,</span>Dum<span class="token punctuation">,</span>Dum<span class="token punctuation">,</span>Dum<span class="token punctuation">,</span>Dum<span class="token punctuation">,</span>Setthisfile$<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! 2-port</span>
<span class="token number">6090</span>        <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"T"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> ENTER @Gofile<span class="token punctuation">,</span>Dataindex<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>Easet<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>Du<span class="token punctuation">,</span>Du<span class="token punctuation">,</span>Du<span class="token punctuation">,</span>Du<span class="token punctuation">,</span>Du<span class="token punctuation">,</span>Du<span class="token punctuation">,</span>Setthisfile$<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Thermistor,DryCal</span>
<span class="token number">6100</span>      <span class="token keyword">NEXT</span> Easet
<span class="token number">6110</span>      !
<span class="token number">6120</span>      <span class="token keyword">IF</span> <span class="token keyword">Files</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">6130</span>        <span class="token function">MAT</span> Setting$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span>Nq<span class="token punctuation">)</span><span class="token operator">=</span>Setthisfile$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span>Nq<span class="token punctuation">)</span>
<span class="token number">6140</span>        Totalsettings<span class="token operator">=</span>Nq     <span class="token comment" spellcheck="true">! Total # of unique settings found so far</span>
<span class="token number">6150</span>        Numnewsets<span class="token operator">=</span><span class="token number">0</span>         <span class="token comment" spellcheck="true">! No new ones to add to the list yet</span>
<span class="token number">6160</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">6170</span>        !
<span class="token number">6180</span>      <span class="token keyword">IF</span> <span class="token keyword">Files</span><span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Need to compare freqs read in with those stored</span>
<span class="token number">6190</span>        <span class="token keyword">FOR</span> Counter<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Nq   <span class="token comment" spellcheck="true">! Each setting read in</span>
<span class="token number">6200</span>          Numcompared<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">6210</span>          Mismatch<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">6220</span>          Sameset<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">6230</span>          <span class="token function">REPEAT</span>   <span class="token comment" spellcheck="true">! Search for matching setting strings</span>
<span class="token number">6240</span>            Numcompared<span class="token operator">=</span>Numcompared<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">6250</span>            <span class="token keyword">IF</span> Numcompared<span class="token operator">&gt;</span>Totalsettings <span class="token keyword">THEN</span>      <span class="token comment" spellcheck="true">!A new frequency exists</span>
<span class="token number">6260</span>              Mismatch<span class="token operator">=</span><span class="token number">1</span>       <span class="token comment" spellcheck="true">!The new setting has been noted</span>
<span class="token number">6270</span>              Totalsettings<span class="token operator">=</span>Totalsettings<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">6280</span>              Setting$<span class="token punctuation">(</span>Totalsettings<span class="token punctuation">)</span><span class="token operator">=</span>Setthisfile$<span class="token punctuation">(</span>Counter<span class="token punctuation">)</span>
<span class="token number">6290</span>            <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">6300</span>            <span class="token keyword">IF</span> Setthisfile$<span class="token punctuation">(</span>Counter<span class="token punctuation">)</span><span class="token operator">=</span>Setting$<span class="token punctuation">(</span>Numcompared<span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">6310</span>              Sameset<span class="token operator">=</span><span class="token number">1</span>       <span class="token comment" spellcheck="true">!A duplicate has been noted</span>
<span class="token number">6320</span>            <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">6330</span>          <span class="token keyword">UNTIL</span> Mismatch<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">OR</span> Sameset<span class="token operator">=</span><span class="token number">1</span>     <span class="token comment" spellcheck="true">!The settings have all been checked for new ones or for duplicates</span>
<span class="token number">6340</span>        <span class="token keyword">NEXT</span> Counter
<span class="token number">6350</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">6360</span>      DEALLOCATE Dataindex<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setthisfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! To start over w/new file</span>
<span class="token number">6370</span>    <span class="token keyword">NEXT</span> <span class="token keyword">Files</span>
<span class="token number">6380</span>    !
<span class="token number">6390</span>    <span class="token comment" spellcheck="true">!  Redimension the Setting$ array with the new Totalsettings</span>
<span class="token number">6400</span>    <span class="token keyword">REDIM</span> Setting$<span class="token punctuation">(</span>Totalsettings<span class="token punctuation">)</span>
<span class="token number">6410</span>    <span class="token keyword">REDIM</span> Mags<span class="token punctuation">(</span>Totalsettings<span class="token punctuation">)</span>
<span class="token number">6420</span>    Numrepeats<span class="token operator">=</span>Totalsettings        <span class="token comment" spellcheck="true">! Total # of settings in the files</span>
<span class="token number">6430</span>    <span class="token keyword">IF</span> Meastype$<span class="token operator">=</span><span class="token string">"1-portV"</span> <span class="token keyword">THEN</span> Numrepeats<span class="token operator">=</span>Nq  <span class="token comment" spellcheck="true">! Assume same # of settings</span>
<span class="token number">6440</span>    <span class="token comment" spellcheck="true">!                                          ! measured for a 1-port</span>
<span class="token number">6450</span>    <span class="token keyword">IF</span> Meastype$<span class="token operator">&lt;&gt;</span><span class="token string">"1-portV"</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Settings not matched up for a sliding</span>
<span class="token number">6460</span>                                   <span class="token comment" spellcheck="true">! load: prog assumes all are = &amp; in order</span>
<span class="token number">6470</span>      <span class="token keyword">CALL</span> Magofsettings<span class="token punctuation">(</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Convert strings to #s</span>
<span class="token number">6480</span>      ALLOCATE Vectsort<span class="token punctuation">(</span>Numrepeats<span class="token punctuation">)</span>
<span class="token number">6490</span>      <span class="token function">MAT</span> SORT Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">TO</span> Vectsort<span class="token comment" spellcheck="true">! Sort in order by magnitude</span>
<span class="token number">6500</span>      <span class="token function">MAT</span> REORDER Mags BY Vectsort<span class="token comment" spellcheck="true">! Order mags by the new order</span>
<span class="token number">6510</span>      <span class="token function">MAT</span> REORDER Setting$ BY Vectsort<span class="token comment" spellcheck="true">! Order strings by the new order</span>
<span class="token number">6520</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">6530</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">6540</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"Settings measured for this device, ="</span>
<span class="token number">6550</span>      <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numrepeats
<span class="token number">6560</span>        <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span>Setting$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">",  "</span><span class="token punctuation">;</span>
<span class="token number">6570</span>      <span class="token keyword">NEXT</span> I
<span class="token number">6580</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">6590</span>      <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">6600</span>    !
<span class="token number">6610</span>      <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Is this the CORRECT list of all settings measured?"</span><span class="token punctuation">,</span>Allsetsok<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">6620</span>      <span class="token keyword">IF</span> <span class="token operator">NOT</span> Allsetsok <span class="token keyword">THEN</span>
<span class="token number">6630</span>        <span class="token keyword">INPUT</span> <span class="token string">"Enter the TOTAL number of variable settings measured for this device"</span><span class="token punctuation">,</span>Numrepeats
<span class="token number">6640</span>        <span class="token keyword">REDIM</span> Setting$<span class="token punctuation">(</span>Numrepeats<span class="token punctuation">)</span>
<span class="token number">6650</span>        <span class="token keyword">REDIM</span> Mags<span class="token punctuation">(</span>Numrepeats<span class="token punctuation">)</span>
<span class="token number">6660</span>        <span class="token keyword">INPUT</span> <span class="token string">"Enter, separated by commas, the variable settings measured."</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">6670</span>        <span class="token keyword">INPUT</span> <span class="token string">"Enter, separated by commas, the VALUE of the variable settings measured."</span><span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">6680</span>        <span class="token keyword">CLEAR</span> SCREEN
<span class="token number">6690</span>        <span class="token function">PRINT</span> <span class="token string">" *************    WARNING   ****************"</span>
<span class="token number">6700</span>        <span class="token function">PRINT</span>
<span class="token number">6710</span>        <span class="token function">PRINT</span> <span class="token string">"Since the settings read in from the files DID NOT match the required settings"</span>
<span class="token number">6720</span>        <span class="token function">PRINT</span> <span class="token string">"list, you may have to tell the program which files have which setting"</span>
<span class="token number">6730</span>        <span class="token function">PRINT</span> <span class="token string">"measurements stored as the data is read in."</span>
<span class="token number">6740</span>        DISP <span class="token string">"... PRESS CONTINUE to continue (PAUSEd in SUB Setarr) ..."</span>
<span class="token number">6750</span>        PAUSE
<span class="token number">6760</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">6770</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">6780</span>  SUBEND   <span class="token comment" spellcheck="true">!.......Setarr......</span>


<span class="token number">6790</span> Read1files<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Read1files<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">6800</span>    <span class="token function">DEG</span>
<span class="token number">6810</span>    <span class="token comment" spellcheck="true">!  INPUT:</span>
<span class="token number">6820</span>    <span class="token comment" spellcheck="true">!  Read raw data from the Numfiles files in Filename$(*) from directory</span>
<span class="token number">6830</span>    <span class="token comment" spellcheck="true">!    Pathin$ on drive Drivein$.  FOR 1-PORT DEVICES.</span>
<span class="token number">6840</span>    <span class="token comment" spellcheck="true">!   Meastype$= device type (</span><span class="token string">"1-port"</span> <span class="token function">fixed</span> <span class="token function">device</span><span class="token punctuation">,</span> <span class="token string">"1-portV"</span> <span class="token function">variable</span><span class="token punctuation">)</span>
<span class="token number">6850</span>    !
<span class="token number">6860</span>    <span class="token comment" spellcheck="true">!  OUTPUT:</span>
<span class="token number">6870</span>    <span class="token comment" spellcheck="true">!  Data for each frequency, file, connect, repeat, and variable are</span>
<span class="token number">6880</span>    <span class="token comment" spellcheck="true">!    returned in Datasp1(*) for port =1 and Datasp2(*) for port 2.</span>
<span class="token number">6890</span>    <span class="token comment" spellcheck="true">!    Variables for a 1-port = |Gamma| and Arg(Gamma).</span>
<span class="token number">6900</span>    <span class="token comment" spellcheck="true">!    IN COM:  Filesperfreq(*) # rows= # freqs (total).  1st col=</span>
<span class="token number">6910</span>    <span class="token comment" spellcheck="true">!       # of files that had that freq, 2nd..Nth column= # of the</span>
<span class="token number">6920</span>    <span class="token comment" spellcheck="true">!       file(s) (order it was read in) that had that freq.</span>
<span class="token number">6930</span>    <span class="token comment" spellcheck="true">!       Filesperset(*) # rows= # settings measured. 1st col= # of</span>
<span class="token number">6940</span>    <span class="token comment" spellcheck="true">!          files that had that setting, 2nd..Nth cols= file # of the</span>
<span class="token number">6950</span>    <span class="token comment" spellcheck="true">!          file (in order that it was read in) that had that setting</span>
<span class="token number">6960</span>    <span class="token comment" spellcheck="true">!          FOR VARIABLE DEVICES ONLY.  Setting$(*) array that describes</span>
<span class="token number">6970</span>    <span class="token comment" spellcheck="true">!          all settings measured for the device was defined in SUB</span>
<span class="token number">6980</span>    <span class="token comment" spellcheck="true">!          Setarr.  If this SUB can't match settings from the files</span>
<span class="token number">6990</span>    <span class="token comment" spellcheck="true">!          to the settings in Setting$(*), it asks operator.</span>
<span class="token number">7000</span>    !
<span class="token number">7010</span>    <span class="token comment" spellcheck="true">!   Freqs in each file must be matched to freqs in COM variable</span>
<span class="token number">7020</span>    <span class="token comment" spellcheck="true">!    Freq(*) (contains all freqs that will be read in) so data can</span>
<span class="token number">7030</span>    <span class="token comment" spellcheck="true">!    be stored in correct array locations.</span>
<span class="token number">7040</span>    !
<span class="token number">7050</span>    <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">7060</span>    <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">7070</span>    <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">7080</span>    !
<span class="token number">7090</span>    <span class="token keyword">DIM</span> Connscalib$[<span class="token number">26</span>]<span class="token punctuation">,</span>Sysletter$[<span class="token number">1</span>]   <span class="token comment" spellcheck="true">! Calib connectors, system letter</span>
<span class="token number">7100</span>    <span class="token keyword">DIM</span> Results<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! To read in data  (Gamma mag &amp; phase)</span>
<span class="token number">7110</span>    <span class="token keyword">DIM</span> Thisset$[<span class="token number">10</span>]  <span class="token comment" spellcheck="true">! To read in (variable device) settings</span>
<span class="token number">7120</span>    !
<span class="token number">7130</span>    <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfiles   <span class="token comment" spellcheck="true">! Each file</span>
<span class="token number">7140</span>      DISP <span class="token string">"READING FILE # "</span><span class="token punctuation">;</span>Eafile<span class="token punctuation">;</span><span class="token string">" OF "</span><span class="token punctuation">;</span>Numfiles
<span class="token number">7150</span>      ASSIGN @Infile <span class="token keyword">TO</span> Drivein$<span class="token operator">&amp;</span>Pathin$<span class="token operator">&amp;</span>Filename$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span>
<span class="token number">7160</span>      <span class="token comment" spellcheck="true">!   Sp= port #, A= # connects this file, B= # repeats (settings)</span>
<span class="token number">7170</span>      <span class="token comment" spellcheck="true">!    in this file, C= # phases, Filesnfreq=# of freqs in this file.</span>
<span class="token number">7180</span>      <span class="token comment" spellcheck="true">!    Startfreq= start rec of freq array storage. Startindexx= start</span>
<span class="token number">7190</span>      <span class="token comment" spellcheck="true">!    rec of data index array storage.</span>
<span class="token number">7200</span>      ENTER @Infile<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">;</span>Sp<span class="token punctuation">,</span>A<span class="token punctuation">,</span>B<span class="token punctuation">,</span>C<span class="token punctuation">,</span>Filesnfreq<span class="token punctuation">,</span>Startfreq<span class="token punctuation">,</span>Startindex
<span class="token number">7210</span>      ALLOCATE Dataindex<span class="token punctuation">(</span>A<span class="token punctuation">,</span>Filesnfreq<span class="token punctuation">)</span>
<span class="token number">7220</span>      ENTER @Infile<span class="token punctuation">,</span>Startindex   <span class="token comment" spellcheck="true">! Read in array that has start recs of</span>
<span class="token number">7230</span>      ENTER @Infile<span class="token punctuation">;</span>Dataindex<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! the data for each connect &amp; freq</span>
<span class="token number">7240</span>    !
<span class="token number">7250</span>      <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numconnects <span class="token comment" spellcheck="true">! Each connect:  Each file should have = # of !</span>
<span class="token number">7260</span>        Arrayplace<span class="token operator">=</span><span class="token number">0</span><span class="token comment" spellcheck="true">! Start search of freq list at beginning for ea connect</span>
<span class="token number">7270</span>        <span class="token keyword">FOR</span> K<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Filesnfreq <span class="token comment" spellcheck="true">! Each frequency in this file</span>
<span class="token number">7280</span>          <span class="token keyword">FOR</span> R<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> B        <span class="token comment" spellcheck="true">! Each repeat (setting) in this file</span>
<span class="token number">7290</span>            Index<span class="token operator">=</span>Dataindex<span class="token punctuation">(</span>J<span class="token punctuation">,</span>K<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>R<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span>  <span class="token comment" spellcheck="true">! 2 recs for each repeat</span>
<span class="token number">7300</span>            ENTER @Infile<span class="token punctuation">,</span>Index   <span class="token comment" spellcheck="true">! Set pointer to data</span>
<span class="token number">7310</span>            <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> ENTER @Infile<span class="token punctuation">;</span>Freqk<span class="token punctuation">,</span>Results<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Data for freq # K, connect J, FIXED DEVICE</span>
<span class="token number">7320</span>            <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> ENTER @Infile<span class="token punctuation">;</span>Freqk<span class="token punctuation">,</span>Results<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Thisset$  <span class="token comment" spellcheck="true">! Data for freq # K, connect J, VARIABLE DEVICE</span>
<span class="token number">7330</span>          !
<span class="token number">7340</span>          <span class="token comment" spellcheck="true">!  Determine correct freq location for result freqs by searching</span>
<span class="token number">7350</span>          <span class="token comment" spellcheck="true">!   for location of Freqk in the array of all freqs Freq(*).</span>
<span class="token number">7360</span>            <span class="token keyword">CALL</span> Matchfreq<span class="token punctuation">(</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freqk<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">7370</span>            <span class="token comment" spellcheck="true">! Store Eafile, (file #), in Filesperfreq(*), first connect only</span>
<span class="token number">7380</span>            <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">AND</span> R<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Filesperfreq<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Eafile
<span class="token number">7390</span>          !
<span class="token number">7400</span>          <span class="token comment" spellcheck="true">!  Determine correct setting location for result setting by</span>
<span class="token number">7410</span>          <span class="token comment" spellcheck="true">!   searching for location of Thisset$ in the array of all</span>
<span class="token number">7420</span>          <span class="token comment" spellcheck="true">!   settings Setting$(*)</span>
<span class="token number">7430</span>          <span class="token comment" spellcheck="true">!  For variable 1-ports, all files are assumed to have same</span>
<span class="token number">7440</span>          <span class="token comment" spellcheck="true">!   settings</span>
<span class="token number">7450</span>            <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">7460</span>              Setplace<span class="token operator">=</span>R
<span class="token number">7470</span>            <span class="token comment" spellcheck="true">! Store Eafile, (file #), in Filesperset(*), first connect only</span>
<span class="token number">7480</span>            <span class="token comment" spellcheck="true">!   This keeps track of which files have which settings meas'd.</span>
<span class="token number">7490</span>              <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">AND</span> K<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Filesperset<span class="token punctuation">(</span>Setplace<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Filesperset<span class="token punctuation">(</span>Setplace<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token comment" spellcheck="true">! # files that have data for setting Thisset$ read in so far</span>
<span class="token number">7500</span>              <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">AND</span> K<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Filesperset<span class="token punctuation">(</span>Setplace<span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span>Setplace<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Eafile
<span class="token number">7510</span>              Whichrep<span class="token operator">=</span>Setplace<span class="token comment" spellcheck="true">! In case variable results files had different settings measured in different files.</span>
<span class="token number">7520</span>            <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">7530</span>            !
<span class="token number">7540</span>            <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Whichrep<span class="token operator">=</span>R
<span class="token number">7550</span>            <span class="token keyword">IF</span> Sp<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Store data in Datasp1(*)</span>
<span class="token number">7560</span>              Datasp1<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>Whichrep<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! |Gamma1|</span>
<span class="token number">7570</span>              Datasp1<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>Whichrep<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Arg(Gamma1)</span>
<span class="token number">7580</span>            <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">7590</span>            <span class="token keyword">IF</span> Sp<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Store data in Datasp2(*)</span>
<span class="token number">7600</span>              Datasp2<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>Whichrep<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! |Gamma2|</span>
<span class="token number">7610</span>              Datasp2<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>Whichrep<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Arg(Gamma2)</span>
<span class="token number">7620</span>            <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">7630</span>          <span class="token keyword">NEXT</span> R     <span class="token comment" spellcheck="true">! Next repeat (setting)</span>
<span class="token number">7640</span>        <span class="token keyword">NEXT</span> K             <span class="token comment" spellcheck="true">! Next freq</span>
<span class="token number">7650</span>      <span class="token keyword">NEXT</span> J  <span class="token comment" spellcheck="true">! Next connect</span>
<span class="token number">7660</span>      DEALLOCATE Dataindex<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">7670</span>    <span class="token keyword">NEXT</span> Eafile   <span class="token comment" spellcheck="true">! Next file</span>
<span class="token number">7680</span>  SUBEND   <span class="token comment" spellcheck="true">!............Read1files.................</span>


<span class="token number">7690</span> Matchfreq<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Matchfreq<span class="token punctuation">(</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freqk<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">7700</span>  !
<span class="token number">7710</span>  <span class="token comment" spellcheck="true">! Find array location Arrayplace of frequency Freqk in array Freq(*).</span>
<span class="token number">7720</span>  <span class="token comment" spellcheck="true">! J= connect #.      Freqs in GHz.   R= repeat #.</span>
<span class="token number">7730</span>  <span class="token comment" spellcheck="true">! Keep track of the # of frequency matches made per freq in</span>
<span class="token number">7740</span>  <span class="token comment" spellcheck="true">!   Filesperfreq(*), FOR FIRST CONNECT (J=1) ONLY.</span>
<span class="token number">7750</span>  <span class="token comment" spellcheck="true">!  Arrayplace=0 to search from the beginning of the list, else</span>
<span class="token number">7760</span>  <span class="token comment" spellcheck="true">!    Arrayplace= the last location found.</span>
<span class="token number">7770</span>  !
<span class="token number">7780</span>    <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">7790</span>    <span class="token keyword">IF</span> Arrayplace<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Arrayplace<span class="token operator">=</span>Arrayplace<span class="token operator">-</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! So don't increment</span>
<span class="token number">7800</span>               <span class="token comment" spellcheck="true">! by the freq if searching for a repeated meas at the</span>
<span class="token number">7810</span>               <span class="token comment" spellcheck="true">! same freq as the last search done.</span>
<span class="token number">7820</span>    <span class="token function">REPEAT</span>             <span class="token comment" spellcheck="true">! Til match Freqk to freq in Freq(*), or not in list</span>
<span class="token number">7830</span>      Arrayplace<span class="token operator">=</span>Arrayplace<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">7840</span>      <span class="token keyword">IF</span> Arrayplace<span class="token operator">&gt;</span><span class="token function">SIZE</span><span class="token punctuation">(</span>Freq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Nomatch<span class="token operator">=</span><span class="token number">1</span>  <span class="token comment" spellcheck="true">! No match found</span>
<span class="token number">7850</span>      <span class="token keyword">IF</span> <span class="token operator">NOT</span> Nomatch <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! If not searched all of Freq(*) yet</span>
<span class="token number">7860</span>        <span class="token keyword">IF</span> Freq<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">)</span><span class="token operator">=</span>Freqk <span class="token keyword">THEN</span> Foundit<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">7870</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">7880</span>    <span class="token keyword">UNTIL</span> Foundit<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">OR</span> Nomatch<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">7890</span>    <span class="token keyword">IF</span> Nomatch<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Arrayplace<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">7900</span>    <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">AND</span> R<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Filesperfreq<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span> <span class="token comment" spellcheck="true">! # files for Freqk read in so far</span>
<span class="token number">7910</span>  SUBEND  <span class="token comment" spellcheck="true">!........Matchfreq...............</span>


<span class="token number">7920</span> Matchset<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Matchset<span class="token punctuation">(</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span>K<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Thisset$<span class="token punctuation">,</span>Setplace<span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">7930</span>  !
<span class="token number">7940</span>  <span class="token comment" spellcheck="true">! Find array location Setplace of setting Thisset$ in array Setting$(*).</span>
<span class="token number">7950</span>  <span class="token comment" spellcheck="true">! J= connect #,   R= repeat (setting) #.  Numrepeats= TOTAL number of</span>
<span class="token number">7960</span>  <span class="token comment" spellcheck="true">!  variable settings measured for this device.  K= Freq #</span>
<span class="token number">7970</span>  !
<span class="token number">7980</span>  <span class="token comment" spellcheck="true">! Setting$(*) contains descriptions of ALL settings measured for a device.</span>
<span class="token number">7990</span>  <span class="token comment" spellcheck="true">!    Thisset$ is compared to the descriptions to find which setting it is.</span>
<span class="token number">8000</span>  !
<span class="token number">8010</span>  <span class="token comment" spellcheck="true">! Keep track of the # of setting matches made per setting in</span>
<span class="token number">8020</span>  <span class="token comment" spellcheck="true">!   Filesperset(*), FOR FIRST CONNECT (J=1) ONLY.</span>
<span class="token number">8030</span>  !
<span class="token number">8040</span>    <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">8050</span>    Setplace<span class="token operator">=</span><span class="token number">0</span>       <span class="token comment" spellcheck="true">! Search for array location</span>
<span class="token number">8060</span>    <span class="token function">REPEAT</span>  <span class="token comment" spellcheck="true">! Til match Thisset$ to a setting in Setting$(*), or not in list</span>
<span class="token number">8070</span>      Setplace<span class="token operator">=</span>Setplace<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">8080</span>      <span class="token keyword">IF</span> Setplace<span class="token operator">&gt;</span><span class="token function">SIZE</span><span class="token punctuation">(</span>Setting$<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Nomatch<span class="token operator">=</span><span class="token number">1</span>  <span class="token comment" spellcheck="true">! No match found</span>
<span class="token number">8090</span>      <span class="token keyword">IF</span> <span class="token operator">NOT</span> Nomatch <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! If not searched all of Setting$(*) yet</span>
<span class="token number">8100</span>        <span class="token keyword">IF</span> Setting$<span class="token punctuation">(</span>Setplace<span class="token punctuation">)</span><span class="token operator">=</span>Thisset$ <span class="token keyword">THEN</span> Foundit<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">8110</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">8120</span>    <span class="token keyword">UNTIL</span> Foundit<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">OR</span> Nomatch<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">8130</span>    <span class="token keyword">IF</span> Nomatch<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">8140</span>      <span class="token keyword">BEEP</span>
<span class="token number">8150</span>      <span class="token keyword">CLEAR</span> SCREEN
<span class="token number">8160</span>      <span class="token function">PRINT</span> <span class="token string">"  ... HELP !!! ...    I can't match the setting "</span><span class="token punctuation">;</span>Thisset$
<span class="token number">8170</span>      <span class="token function">PRINT</span> <span class="token string">" to any of the settings in the master list.   YOU MUST HELP ME !!! "</span>
<span class="token number">8180</span>      <span class="token function">PRINT</span>
<span class="token number">8190</span>      <span class="token function">PRINT</span> <span class="token string">"Please enter the number below which = the setting that "</span><span class="token punctuation">;</span>Thisset$<span class="token punctuation">;</span><span class="token string">" should be"</span>
<span class="token number">8200</span>      <span class="token function">PRINT</span>
<span class="token number">8210</span>      <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numrepeats
<span class="token number">8220</span>        <span class="token function">PRINT</span> Easet<span class="token punctuation">;</span><span class="token string">"  .... "</span><span class="token punctuation">;</span>Setting$<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span>
<span class="token number">8230</span>      <span class="token keyword">NEXT</span> Easet
<span class="token number">8240</span>      <span class="token keyword">INPUT</span> <span class="token string">"Which setting # should this be?"</span><span class="token punctuation">,</span>Setplace
<span class="token number">8250</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">8260</span>    <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">AND</span> K<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Filesperset<span class="token punctuation">(</span>Setplace<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Filesperset<span class="token punctuation">(</span>Setplace<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span> <span class="token comment" spellcheck="true">! # files that have data for setting Thisset$ read in so far</span>
<span class="token number">8270</span>  SUBEND  <span class="token comment" spellcheck="true">!........Matchset...............</span>


<span class="token number">8280</span> Read2files<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Read2files<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">8290</span>    <span class="token function">DEG</span>
<span class="token number">8300</span>    <span class="token comment" spellcheck="true">!  Read raw data from the Numfiles files in Filename$(*) from directory</span>
<span class="token number">8310</span>    <span class="token comment" spellcheck="true">!    Pathin$ on drive Drivein$.   FOR 2-PORTS (FIXED,RECIPROCAL &amp;/or</span>
<span class="token number">8320</span>    <span class="token comment" spellcheck="true">!     VARIABLE).  Meastype$= device type (</span><span class="token string">"2-port"</span> <span class="token function">fixed</span><span class="token punctuation">,</span> <span class="token string">"2-portV"</span>
<span class="token number">8330</span>    <span class="token comment" spellcheck="true">!     variable, </span><span class="token string">"2-portNR"</span> non<span class="token operator">-</span>reciprocal<span class="token punctuation">,</span> <span class="token string">"2-portVNR"</span> <span class="token function">variable</span> non<span class="token operator">-</span>
<span class="token number">8340</span>    <span class="token comment" spellcheck="true">!     reciprocal)</span>
<span class="token number">8350</span>    !
<span class="token number">8360</span>    <span class="token comment" spellcheck="true">!  OUTPUT:</span>
<span class="token number">8370</span>    <span class="token comment" spellcheck="true">!  Variables for a 2-port are magnitude &amp; phase of S11, S12, S21, S22.</span>
<span class="token number">8380</span>    <span class="token comment" spellcheck="true">!  Data for each frequency, file, connect, repeat, and variable are</span>
<span class="token number">8390</span>    <span class="token comment" spellcheck="true">!    returned in Datasp1(*) for Sp =1 (forward) and Datasp2(*) for</span>
<span class="token number">8400</span>    <span class="token comment" spellcheck="true">!    Sp= 2 (reverse).</span>
<span class="token number">8410</span>    <span class="token comment" spellcheck="true">!        Smoothed= # of points used to smooth 8510/360 S12,S21 data</span>
<span class="token number">8420</span>    <span class="token comment" spellcheck="true">!                =0 if no smoothing done</span>
<span class="token number">8430</span>    <span class="token comment" spellcheck="true">!    IN COM:  Filesperfreq(*) # rows= # freqs (total).  1st col=</span>
<span class="token number">8440</span>    <span class="token comment" spellcheck="true">!       # of files that had that freq, 2nd..Nth column= # of the</span>
<span class="token number">8450</span>    <span class="token comment" spellcheck="true">!       file(s) (order it was read in) that had that freq.</span>
<span class="token number">8460</span>    <span class="token comment" spellcheck="true">!      IF DEVICE IS VARIABLE:</span>
<span class="token number">8470</span>    <span class="token comment" spellcheck="true">!       Filesperset(*) # rows= # settings measured. 1st col= # of</span>
<span class="token number">8480</span>    <span class="token comment" spellcheck="true">!          files that had that setting, 2nd..Nth cols= file # of the</span>
<span class="token number">8490</span>    <span class="token comment" spellcheck="true">!          file (in order that it was read in) that had that setting</span>
<span class="token number">8500</span>    <span class="token comment" spellcheck="true">!          FOR VARIABLE DEVICES ONLY.  Setting$(*) array that describes</span>
<span class="token number">8510</span>    <span class="token comment" spellcheck="true">!          all settings measured for the device was defined in SUB</span>
<span class="token number">8520</span>    <span class="token comment" spellcheck="true">!          Setarr.  If this SUB can't match settings from the files</span>
<span class="token number">8530</span>    <span class="token comment" spellcheck="true">!          to the settings in Setting$(*), it asks operator.</span>
<span class="token number">8540</span>    !
<span class="token number">8550</span>    <span class="token comment" spellcheck="true">!   Freqs for each file must be matched to freqs in COM variable</span>
<span class="token number">8560</span>    <span class="token comment" spellcheck="true">!    Freq(*) (array of all freqs to be read in) so data can be stored</span>
<span class="token number">8570</span>    <span class="token comment" spellcheck="true">!    in correct array locations.</span>
<span class="token number">8580</span>    !
<span class="token number">8590</span>    <span class="token comment" spellcheck="true">! If Sp=2, a two-port has been measured in the </span><span class="token string">"reverse"</span> orient<span class="token punctuation">,</span>
<span class="token number">8600</span>    <span class="token comment" spellcheck="true">!   stored in the file with S11 and S22 switched  (S22 S21 S12 S11)</span>
<span class="token number">8610</span>    <span class="token comment" spellcheck="true">!   instead of S11 S12 S21 S22, assuming the Sp=1 orient as the</span>
<span class="token number">8620</span>    <span class="token comment" spellcheck="true">!   correct S11-S22 reference).  This is accounted for</span>
<span class="token number">8630</span>    <span class="token comment" spellcheck="true">!   when reading in data for 2-ports, so both Datasp1(*) and Datasp2(*)</span>
<span class="token number">8640</span>    <span class="token comment" spellcheck="true">!   contain S11, S12, S21, S22 in that order.</span>
<span class="token number">8650</span>    !
<span class="token number">8660</span>    <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">8670</span>    <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">8680</span>    <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">8690</span>    <span class="token keyword">DIM</span> Sij<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! For reading in S11, S12, S21, S22 mag &amp; arg</span>
<span class="token number">8700</span>    <span class="token keyword">DIM</span> Thisset$[<span class="token number">10</span>]   <span class="token comment" spellcheck="true">! For reading in setting description for var device</span>
<span class="token number">8710</span>    ALLOCATE File8510<span class="token punctuation">(</span>Numfiles<span class="token punctuation">)</span><span class="token punctuation">,</span>Sysid$[<span class="token number">20</span>]<span class="token punctuation">,</span>S1$[<span class="token number">1</span>]<span class="token punctuation">,</span>Whichport<span class="token punctuation">(</span>Numfiles<span class="token punctuation">)</span>
<span class="token number">8720</span>    <span class="token function">MAT</span> File8510<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token number">8730</span>    !
<span class="token number">8740</span>    <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfiles    <span class="token comment" spellcheck="true">! Each file</span>
<span class="token number">8750</span>      DISP <span class="token string">"READING FILE # "</span><span class="token punctuation">;</span>Eafile<span class="token punctuation">;</span><span class="token string">" OF "</span><span class="token punctuation">;</span>Numfiles
<span class="token number">8760</span>      ASSIGN @Infile <span class="token keyword">TO</span> Drivein$<span class="token operator">&amp;</span>Pathin$<span class="token operator">&amp;</span>Filename$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span>
<span class="token number">8770</span>      ENTER @Infile<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span>Sysid$<span class="token punctuation">,</span>S1$
<span class="token number">8780</span>      <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Sysid$<span class="token punctuation">,</span><span class="token string">"8510"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Sysid$<span class="token punctuation">,</span><span class="token string">"360"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> S1$<span class="token operator">=</span><span class="token string">"L"</span> <span class="token operator">OR</span> S1$<span class="token operator">=</span><span class="token string">"T"</span> <span class="token keyword">THEN</span> File8510<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! Measured on HP8510 or WILTRON ANA</span>
<span class="token number">8790</span>      <span class="token comment" spellcheck="true">!  Sp= port (direction) #, A= # connects in this file, B=# repeats</span>
<span class="token number">8800</span>      <span class="token comment" spellcheck="true">!   (settings for a variable device) in this file, C= # phases,</span>
<span class="token number">8810</span>      <span class="token comment" spellcheck="true">!   Filesnfreq= # freqs in this file, Startindex= start rec of</span>
<span class="token number">8820</span>      <span class="token comment" spellcheck="true">!   data storage index array</span>
<span class="token number">8830</span>      ENTER @Infile<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">;</span>Sp<span class="token punctuation">,</span>A<span class="token punctuation">,</span>B<span class="token punctuation">,</span>C<span class="token punctuation">,</span>Filesnfreq<span class="token punctuation">,</span>Startfreq<span class="token punctuation">,</span>Startindex
<span class="token number">8840</span>      Whichport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span>Sp
<span class="token number">8850</span>      ALLOCATE Dataindex<span class="token punctuation">(</span>A<span class="token punctuation">,</span>Filesnfreq<span class="token punctuation">)</span>
<span class="token number">8860</span>      ENTER @Infile<span class="token punctuation">,</span>Startindex
<span class="token number">8870</span>      ENTER @Infile<span class="token punctuation">;</span>Dataindex<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">8880</span>    !
<span class="token number">8890</span>      <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numconnects  <span class="token comment" spellcheck="true">! Each connect: Each file should have = #!</span>
<span class="token number">8900</span>        Arrayplace<span class="token operator">=</span><span class="token number">0</span><span class="token comment" spellcheck="true">! Start search of freq list at beginning for ea connect</span>
<span class="token number">8910</span>        <span class="token keyword">FOR</span> K<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Filesnfreq <span class="token comment" spellcheck="true">! Each frequency in this file</span>
<span class="token number">8920</span>          <span class="token keyword">FOR</span> R<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> B         <span class="token comment" spellcheck="true">! Each repeat (setting) in this file</span>
<span class="token number">8930</span>            Index<span class="token operator">=</span>Dataindex<span class="token punctuation">(</span>J<span class="token punctuation">,</span>K<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>R<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span>  <span class="token comment" spellcheck="true">! 2 recs for each repeat</span>
<span class="token number">8940</span>            ENTER @Infile<span class="token punctuation">,</span>Index        <span class="token comment" spellcheck="true">! Position pointer to data</span>
<span class="token number">8950</span>            !
<span class="token number">8960</span>            <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! Fixed device</span>
<span class="token number">8970</span>              <span class="token keyword">IF</span> Sp<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> ENTER @Infile<span class="token punctuation">;</span>Freqk<span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! FORWARD direction</span>
<span class="token number">8980</span>              <span class="token keyword">IF</span> Sp<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> ENTER @Infile<span class="token punctuation">;</span>Freqk<span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Reverse direction</span>
<span class="token number">8990</span>            <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">9000</span>            !
<span class="token number">9010</span>            <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! Variable device</span>
<span class="token number">9020</span>              <span class="token keyword">IF</span> Sp<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> ENTER @Infile<span class="token punctuation">;</span>Freqk<span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Thisset$ <span class="token comment" spellcheck="true">! FORWARD direction</span>
<span class="token number">9030</span>              <span class="token keyword">IF</span> Sp<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> ENTER @Infile<span class="token punctuation">;</span>Freqk<span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sij<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Thisset$<span class="token comment" spellcheck="true">! Reverse direction</span>
<span class="token number">9040</span>            <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">9050</span>            !
<span class="token number">9060</span>            <span class="token comment" spellcheck="true">!  Find array location if using atten file by searching for</span>
<span class="token number">9070</span>            <span class="token comment" spellcheck="true">!  location of Freqk in the summary freq array Freq(*).</span>
<span class="token number">9080</span>            <span class="token keyword">CALL</span> Matchfreq<span class="token punctuation">(</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freqk<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">9090</span>              <span class="token comment" spellcheck="true">!  Store Eafile, the file that has freq # Freqk</span>
<span class="token number">9100</span>            <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">AND</span> R<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Filesperfreq<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Eafile
<span class="token number">9110</span>          !
<span class="token number">9120</span>          <span class="token comment" spellcheck="true">!  IF DEVICE IS VARIABLE:</span>
<span class="token number">9130</span>          <span class="token comment" spellcheck="true">!  Determine correct setting location for result setting by</span>
<span class="token number">9140</span>          <span class="token comment" spellcheck="true">!   searching for location of Thisset$ in the array of all</span>
<span class="token number">9150</span>          <span class="token comment" spellcheck="true">!   settings Setting$(*)</span>
<span class="token number">9160</span>            <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">9170</span>              <span class="token keyword">CALL</span> Matchset<span class="token punctuation">(</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Thisset$<span class="token punctuation">,</span>Setplace<span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">9180</span>            <span class="token comment" spellcheck="true">! Store Eafile, (file #), in Filesperset(*), first connect only</span>
<span class="token number">9190</span>            <span class="token comment" spellcheck="true">!   This keeps track of which files have which settings meas'd.</span>
<span class="token number">9200</span>              <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">AND</span> K<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Filesperset<span class="token punctuation">(</span>Setplace<span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span>Setplace<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Eafile
<span class="token number">9210</span>            <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">9220</span>          !
<span class="token number">9230</span>            <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Whichrep<span class="token operator">=</span>Setplace<span class="token comment" spellcheck="true">! In case variable results files had different settings measured in different files.</span>
<span class="token number">9240</span>            <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Whichrep<span class="token operator">=</span>R
<span class="token number">9250</span>            <span class="token keyword">FOR</span> L<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">8</span>  <span class="token comment" spellcheck="true">! Store Sij's</span>
<span class="token number">9260</span>              <span class="token keyword">IF</span> Sp<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>     <span class="token comment" spellcheck="true">! Store data in Datasp1(*):  FORWARD</span>
<span class="token number">9270</span>                Datasp1<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>Whichrep<span class="token punctuation">,</span>L<span class="token punctuation">)</span><span class="token operator">=</span>Sij<span class="token punctuation">(</span>L<span class="token punctuation">)</span>
<span class="token number">9280</span>              <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">9290</span>              <span class="token keyword">IF</span> Sp<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span>     <span class="token comment" spellcheck="true">! Store data in Datasp2(*):  REVERSE</span>
<span class="token number">9300</span>                Datasp2<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>Whichrep<span class="token punctuation">,</span>L<span class="token punctuation">)</span><span class="token operator">=</span>Sij<span class="token punctuation">(</span>L<span class="token punctuation">)</span>
<span class="token number">9310</span>              <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">9320</span>            <span class="token keyword">NEXT</span> L  <span class="token comment" spellcheck="true">! Next variable</span>
<span class="token number">9330</span>            !
<span class="token number">9340</span>          <span class="token keyword">NEXT</span> R    <span class="token comment" spellcheck="true">! Next repeat (setting)</span>
<span class="token number">9350</span>        <span class="token keyword">NEXT</span> K      <span class="token comment" spellcheck="true">! Next freq</span>
<span class="token number">9360</span>      <span class="token keyword">NEXT</span> J        <span class="token comment" spellcheck="true">! Next connect</span>
<span class="token number">9370</span>      DEALLOCATE Dataindex<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">9380</span>    <span class="token keyword">NEXT</span> Eafile     <span class="token comment" spellcheck="true">! Next file</span>
<span class="token number">9390</span>    <span class="token keyword">IF</span> <span class="token function">MAX</span><span class="token punctuation">(</span>File8510<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">9400</span>      <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to smooth the 8510/360 data?"</span><span class="token punctuation">,</span>Smooit<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">9410</span>      <span class="token keyword">IF</span> Smooit <span class="token keyword">THEN</span> <span class="token keyword">CALL</span> Smooth<span class="token punctuation">(</span>Whichport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>File8510<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">9420</span>    <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">9430</span>  SUBEND   <span class="token comment" spellcheck="true">!.......Read2files......................</span>


<span class="token number">9440</span> Readpfiles<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Readpfiles<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Residuals<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">9450</span>    <span class="token function">DEG</span>
<span class="token number">9460</span>    <span class="token comment" spellcheck="true">!  Read raw data from the Numfiles files in Filename$(*) from directory</span>
<span class="token number">9470</span>    <span class="token comment" spellcheck="true">!    Pathin$ on drive Drivein$.    FOR POWER DEVICES.</span>
<span class="token number">9480</span>    <span class="token comment" spellcheck="true">!    Meastype$= </span><span class="token string">"Thermistor"</span> <span class="token operator">or</span> <span class="token string">"DryCal"</span>
<span class="token number">9490</span>    !
<span class="token number">9500</span>    <span class="token comment" spellcheck="true">!  OUTPUT:</span>
<span class="token number">9510</span>    <span class="token comment" spellcheck="true">!  Variables for power are |Gamma|, efficiency, Kb, Pdc, Pinc,</span>
<span class="token number">9520</span>    <span class="token comment" spellcheck="true">!     Arg(Gamma).</span>
<span class="token number">9530</span>    <span class="token comment" spellcheck="true">!  Data for each frequency, file, connect, repeat, and variable are</span>
<span class="token number">9540</span>    <span class="token comment" spellcheck="true">!    returned in Datasp1(*) for port =1 and Datasp2(*) for</span>
<span class="token number">9550</span>    <span class="token comment" spellcheck="true">!    port 2.  Data from the calibration (measurements of the power</span>
<span class="token number">9560</span>    <span class="token comment" spellcheck="true">!    standard used for calibration for each file, frequency, and</span>
<span class="token number">9570</span>    <span class="token comment" spellcheck="true">!    variable) is returned in Pwrstd(*):  Frequency,</span>
<span class="token number">9580</span>    <span class="token comment" spellcheck="true">!    GammaG, Total error, |Gamma|, Arg(Gamma), Pdc, Pinc,</span>
<span class="token number">9590</span>    <span class="token comment" spellcheck="true">!    Std dev of power meter on port 1 &amp; port 2.</span>
<span class="token number">9600</span>    <span class="token comment" spellcheck="true">!         Residuals(Numfreqs,8)= delta, Snist,Sc, total uncert for Gamma</span>
<span class="token number">9610</span>    <span class="token comment" spellcheck="true">!           mag &amp; phase, for a power device meas'd on Direct Comparison</span>
<span class="token number">9620</span>    <span class="token comment" spellcheck="true">!           system. Has 8 calculation residuals if not a DCS meas.</span>
<span class="token number">9630</span>    <span class="token comment" spellcheck="true">!    IN COM:  Filesperfreq(*) # rows= # freqs (total).  1st col=</span>
<span class="token number">9640</span>    <span class="token comment" spellcheck="true">!       # of files that had that freq, 2nd..Nth column= # of the</span>
<span class="token number">9650</span>    <span class="token comment" spellcheck="true">!       file(s) (order it was read in) that had that freq.</span>
<span class="token number">9660</span>    !
<span class="token number">9670</span>    <span class="token comment" spellcheck="true">!   Freqs for each file must be matched to freqs in COM variable</span>
<span class="token number">9680</span>    <span class="token comment" spellcheck="true">!    Freq(*) (contains all freqs to be read in) so data can be</span>
<span class="token number">9690</span>    <span class="token comment" spellcheck="true">!    stored in correct array locations.</span>
<span class="token number">9700</span>    !
<span class="token number">9710</span>    <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">9720</span>    <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">9730</span>    <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">9740</span>    <span class="token keyword">DIM</span> Results<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! For reading in data &amp; storing calc of Kb</span>
<span class="token number">9750</span>    <span class="token keyword">DIM</span> Resid<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>      <span class="token comment" spellcheck="true">! For reading in residuals for 1 freq, 1st connect</span>
<span class="token number">9760</span>    !
<span class="token number">9770</span>    <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfiles
<span class="token number">9780</span>      DISP <span class="token string">"READING FILE # "</span><span class="token punctuation">;</span>Eafile<span class="token punctuation">;</span><span class="token string">" OF "</span><span class="token punctuation">;</span>Numfiles
<span class="token number">9790</span>      ASSIGN @Infile <span class="token keyword">TO</span> Drivein$<span class="token operator">&amp;</span>Pathin$<span class="token operator">&amp;</span>Filename$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span>
<span class="token number">9800</span>      <span class="token comment" spellcheck="true">!  Sp= port #, A= # connects this file, B= # repeats this file,</span>
<span class="token number">9810</span>      <span class="token comment" spellcheck="true">!  C= # phases, Filesnfreq= # freqs this file, Startindex= start rec</span>
<span class="token number">9820</span>      <span class="token comment" spellcheck="true">!  of data indexing array, Startpowsummary= start rec of data for the</span>
<span class="token number">9830</span>      <span class="token comment" spellcheck="true">!  standard used to calibrate for power.</span>
<span class="token number">9840</span>      ENTER @Infile<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">;</span>Sp<span class="token punctuation">,</span>A<span class="token punctuation">,</span>B<span class="token punctuation">,</span>C<span class="token punctuation">,</span>Filesnfreq<span class="token punctuation">,</span>Startfreq<span class="token punctuation">,</span>Startindex<span class="token punctuation">,</span>Startsum<span class="token punctuation">,</span>Startpowsummary
<span class="token number">9850</span>      ALLOCATE Dataindex<span class="token punctuation">(</span>A<span class="token punctuation">,</span>Filesnfreq<span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! A= # of connects</span>
<span class="token number">9860</span>      ENTER @Infile<span class="token punctuation">,</span>Startindex
<span class="token number">9870</span>      ENTER @Infile<span class="token punctuation">;</span>Dataindex<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">9880</span>    !
<span class="token number">9890</span>      <span class="token keyword">IF</span> A<span class="token operator">&lt;</span>Numconnects <span class="token keyword">THEN</span> Allconnects<span class="token operator">=</span>A
<span class="token number">9900</span>      <span class="token keyword">IF</span> A<span class="token operator">=</span>Numconnects <span class="token keyword">THEN</span> Allconnects<span class="token operator">=</span>Numconnects
<span class="token number">9910</span>      <span class="token keyword">IF</span> A<span class="token operator">&gt;</span>Numconnects <span class="token operator">AND</span> <span class="token function">POS</span><span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"N"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">9920</span>        <span class="token keyword">BEEP</span>
<span class="token number">9930</span>        <span class="token keyword">CLEAR</span> SCREEN
<span class="token number">9940</span>        <span class="token function">PRINT</span> <span class="token string">"RE-RUN CALREP7.1 AGAIN, SO THAT THE DIRECT COMPARISON SYSTEM FILE IS READ"</span>
<span class="token number">9950</span>        <span class="token function">PRINT</span> <span class="token string">"LAST.   PROGRAM IS PAUSED IN SUB Readpfiles..."</span>
<span class="token number">9960</span>        PAUSE
<span class="token number">9970</span>      <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">9980</span>      <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Allconnects <span class="token comment" spellcheck="true">! Each connect:  EACH FILE SHOULD HAVE SAME #!</span>
<span class="token number">9990</span>        Arrayplace<span class="token operator">=</span><span class="token number">0</span><span class="token comment" spellcheck="true">! Start search of freq list at beginning for ea connect</span>
<span class="token number">10000</span>       <span class="token keyword">FOR</span> K<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Filesnfreq <span class="token comment" spellcheck="true">! Each frequency in this file</span>
<span class="token number">10010</span>         <span class="token keyword">FOR</span> R<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> B        <span class="token comment" spellcheck="true">! Each repeat</span>
<span class="token number">10020</span>           Index<span class="token operator">=</span>Dataindex<span class="token punctuation">(</span>J<span class="token punctuation">,</span>K<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>R<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span>   <span class="token comment" spellcheck="true">! 2 recs for each repeat</span>
<span class="token number">10030</span>           ENTER @Infile<span class="token punctuation">,</span>Index        <span class="token comment" spellcheck="true">! Position pointer</span>
<span class="token number">10040</span>           ENTER @Infile<span class="token punctuation">;</span>Freqk<span class="token punctuation">,</span>Results<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Results<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Results<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Results<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Results<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Efficiency, Gamma mag &amp; phase, Pdc, Pinc</span>
<span class="token number">10050</span>           <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> ENTER @Infile<span class="token punctuation">,</span>Index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>Resid<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Residuals for non DCS-system meas, uncerts of Gamma for a Direct Comp system meas.</span>
<span class="token number">10060</span>           !
<span class="token number">10070</span>           <span class="token comment" spellcheck="true">!  Find array location for this freq by searching for  Freqk</span>
<span class="token number">10080</span>           <span class="token comment" spellcheck="true">!   in summary array Freq(*).</span>
<span class="token number">10090</span>           <span class="token keyword">CALL</span> Matchfreq<span class="token punctuation">(</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freqk<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">10100</span>             <span class="token comment" spellcheck="true">!  Store Eafile, the file that has freq # Freqk</span>
<span class="token number">10110</span>           <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">AND</span> R<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Filesperfreq<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Eafile
<span class="token number">10120</span>           !
<span class="token number">10130</span>           <span class="token comment" spellcheck="true">! If power device was measured on Direct Comparson system,</span>
<span class="token number">10140</span>           <span class="token comment" spellcheck="true">!  Gamma info is the same for every connect.  Store uncerts for</span>
<span class="token number">10150</span>           <span class="token comment" spellcheck="true">!  Gamma.  If device wasn't measured on the DCS, Resid(*) has</span>
<span class="token number">10160</span>           <span class="token comment" spellcheck="true">!  calculation residuals.</span>
<span class="token number">10170</span>           <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">MAT</span> Residuals<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">=</span>Resid<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">10180</span>           !
<span class="token number">10190</span>           <span class="token keyword">IF</span> Sp<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! Store data in Datasp1(*)</span>
<span class="token number">10200</span>             Datasp1<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! |Gamma|</span>
<span class="token number">10210</span>             Datasp1<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! Efficiency</span>
<span class="token number">10220</span>             Datasp1<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>Datasp1<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>Datasp1<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Kb= (1-|Gamma|)^2 * effic.</span>
<span class="token number">10230</span>             Datasp1<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! dc power Pdc</span>
<span class="token number">10240</span>             Datasp1<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Pinc</span>
<span class="token number">10250</span>             Datasp1<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Arg(Gamma)</span>
<span class="token number">10260</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">10270</span>             !
<span class="token number">10280</span>           <span class="token keyword">IF</span> Sp<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! Store data in Datasp2(*)</span>
<span class="token number">10290</span>             Datasp2<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! |Gamma|</span>
<span class="token number">10300</span>             Datasp2<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! Efficiency</span>
<span class="token number">10310</span>             Datasp2<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>Datasp2<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>Datasp2<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Kb</span>
<span class="token number">10320</span>             Datasp2<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! dc power Pdc</span>
<span class="token number">10330</span>             Datasp2<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Pinc</span>
<span class="token number">10340</span>             Datasp2<span class="token punctuation">(</span>Arrayplace<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span>J<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span>Results<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Arg(Gamma)</span>
<span class="token number">10350</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">10360</span>         <span class="token keyword">NEXT</span> R    <span class="token comment" spellcheck="true">! Next repeat</span>
<span class="token number">10370</span> Skipbandedge<span class="token punctuation">:</span> <span class="token keyword">NEXT</span> K     <span class="token comment" spellcheck="true">! Next freq</span>
<span class="token number">10380</span>     <span class="token keyword">NEXT</span> J  <span class="token comment" spellcheck="true">! Next connect</span>
<span class="token number">10390</span>   !
<span class="token number">10400</span>   <span class="token comment" spellcheck="true">!  Read in power standard measurements from the measurement file.</span>
<span class="token number">10410</span>     Arrayplace<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">10420</span>     <span class="token keyword">FOR</span> K<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Filesnfreq
<span class="token number">10430</span>       Index<span class="token operator">=</span>Startpowsummary<span class="token operator">+</span><span class="token punctuation">(</span>K<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! 1 rec per freq</span>
<span class="token number">10440</span>       ENTER @Infile<span class="token punctuation">,</span>Index<span class="token punctuation">;</span>Freqk<span class="token punctuation">,</span>Gammag<span class="token punctuation">,</span>Kp<span class="token punctuation">,</span>Gammastd<span class="token punctuation">,</span>Arggammastd<span class="token punctuation">,</span>Pdcstd<span class="token punctuation">,</span>Pincstd<span class="token punctuation">,</span>Pwrmtrstddev
<span class="token number">10450</span>       !
<span class="token number">10460</span>       <span class="token comment" spellcheck="true">!  Find correct freq location to store data in Pwrstd(*)</span>
<span class="token number">10470</span>       <span class="token keyword">CALL</span> Matchfreq<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freqk<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">10480</span>       Pwrstd<span class="token punctuation">(</span>Eafile<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Freqk
<span class="token number">10490</span>       Pwrstd<span class="token punctuation">(</span>Eafile<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Gammag  <span class="token comment" spellcheck="true">! = |c|</span>
<span class="token number">10500</span>       Pwrstd<span class="token punctuation">(</span>Eafile<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span>Kp      <span class="token comment" spellcheck="true">! or Kc, for Direct Comp system</span>
<span class="token number">10510</span>       Pwrstd<span class="token punctuation">(</span>Eafile<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span>Gammastd
<span class="token number">10520</span>       Pwrstd<span class="token punctuation">(</span>Eafile<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span>Arggammastd
<span class="token number">10530</span>       Pwrstd<span class="token punctuation">(</span>Eafile<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span>Pdcstd  <span class="token comment" spellcheck="true">! or Avg Pratio, for DCS system</span>
<span class="token number">10540</span>       Pwrstd<span class="token punctuation">(</span>Eafile<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">=</span>Pincstd <span class="token comment" spellcheck="true">! or Uncert in mismatch term DCS</span>
<span class="token number">10550</span>       <span class="token keyword">IF</span> Sp<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Pwrstd<span class="token punctuation">(</span>Eafile<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">=</span>Pwrmtrstddev
<span class="token number">10560</span>       <span class="token keyword">IF</span> Sp<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Pwrstd<span class="token punctuation">(</span>Eafile<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token operator">=</span>Pwrmtrstddev
<span class="token number">10570</span>     <span class="token keyword">NEXT</span> K   <span class="token comment" spellcheck="true">! Next freq</span>
<span class="token number">10580</span>     DEALLOCATE Dataindex<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">10590</span>   <span class="token keyword">NEXT</span> Eafile      <span class="token comment" spellcheck="true">! Next file</span>
<span class="token number">10600</span> SUBEND   <span class="token comment" spellcheck="true">!............Readpfiles.................</span>


<span class="token number">10610</span> Removebandedge<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Removebandedge
<span class="token number">10620</span>   <span class="token comment" spellcheck="true">! Remove files count from total # files for the freq if at a</span>
<span class="token number">10630</span>   <span class="token comment" spellcheck="true">!  repeated band edge frequency.</span>
<span class="token number">10640</span>   !
<span class="token number">10650</span>   <span class="token comment" spellcheck="true">! IN COM:</span>
<span class="token number">10660</span>   <span class="token comment" spellcheck="true">! INPUT: Filesperfreq(*)= one row each frequency. 1st col has</span>
<span class="token number">10670</span>   <span class="token comment" spellcheck="true">!        # of files for the frequency, cols 2... have file # of file</span>
<span class="token number">10680</span>   <span class="token comment" spellcheck="true">!        as it was read in in the FOR I=...TO loop of SUB Readfiles.</span>
<span class="token number">10690</span>   <span class="token comment" spellcheck="true">! OUTPUT: 1st col # of files adjusted if have read in too many files</span>
<span class="token number">10700</span>   <span class="token comment" spellcheck="true">!        at a repeated band edge.</span>
<span class="token number">10710</span>   !
<span class="token number">10720</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">10730</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">10740</span>   !
<span class="token number">10750</span>  <span class="token comment" spellcheck="true">! For each freq, compare previous freq's # of files &amp; next freq's # of</span>
<span class="token number">10760</span>  <span class="token comment" spellcheck="true">!  files.  If previous freq &amp; next freq have same # of files, but current</span>
<span class="token number">10770</span>  <span class="token comment" spellcheck="true">!  freq has more, then current freq is a repeat band edge -- reset # of</span>
<span class="token number">10780</span>  <span class="token comment" spellcheck="true">!  files for current freq to = the # for the previous &amp; next freq's.</span>
<span class="token number">10790</span>  <span class="token comment" spellcheck="true">! Also test for repeated band edge at switch to different system, where</span>
<span class="token number">10800</span>  <span class="token comment" spellcheck="true">!  # of calibrations used per system is different (i.e. one has 1 calib,</span>
<span class="token number">10810</span>  <span class="token comment" spellcheck="true">!  other has 3).</span>
<span class="token number">10820</span>  <span class="token comment" spellcheck="true">! Files used for band edge are those read in first.</span>
<span class="token number">10830</span>  !
<span class="token number">10840</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">TO</span> Numfreqs<span class="token operator">-</span><span class="token number">1</span>
<span class="token number">10850</span>   <span class="token comment" spellcheck="true">!  Check for repeat band edge   ( # files same ea freq)</span>
<span class="token number">10860</span>     <span class="token keyword">IF</span> <span class="token punctuation">(</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token punctuation">(</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Current freq (Ith) is a repeat band edge</span>
<span class="token number">10870</span>       Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">10880</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">10890</span>     !
<span class="token number">10900</span>     <span class="token comment" spellcheck="true">! Check for repeat @ system change, where # files is different</span>
<span class="token number">10910</span>     <span class="token keyword">IF</span> Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&gt;</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">AND</span> Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&gt;</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">10920</span>       <span class="token comment" spellcheck="true">! If current freq has too many files, check file #'s.  If prev freq</span>
<span class="token number">10930</span>       <span class="token comment" spellcheck="true">!    first file # read in = current first file #, then current freq</span>
<span class="token number">10940</span>       <span class="token comment" spellcheck="true">!    # files= previous freq's # files.  If next freq first file</span>
<span class="token number">10950</span>       <span class="token comment" spellcheck="true">!    # read in = current first file #, then current freq's # of</span>
<span class="token number">10960</span>       <span class="token comment" spellcheck="true">!    files = next freq's # files.</span>
<span class="token number">10970</span>       <span class="token keyword">IF</span> Filesperfreq<span class="token punctuation">(</span>I<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">10980</span>       <span class="token keyword">IF</span> Filesperfreq<span class="token punctuation">(</span>I<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">10990</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">11000</span>   <span class="token keyword">NEXT</span> I
<span class="token number">11010</span> SUBEND   <span class="token comment" spellcheck="true">!.......Removebandedge...............</span>


<span class="token number">11020</span> Printrawdata<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Printrawdata<span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>S<span class="token punctuation">)</span>
<span class="token number">11030</span>  <span class="token comment" spellcheck="true">! Print tables of raw data.</span>
<span class="token number">11040</span>  !
<span class="token number">11050</span>  <span class="token comment" spellcheck="true">! Meastype$= type of device.  Filename$(*)= array of Numfiles file names.</span>
<span class="token number">11060</span>  <span class="token comment" spellcheck="true">!   Datasp1(*) has data for port=1 (forward), Datasp2(*) has data for</span>
<span class="token number">11070</span>  <span class="token comment" spellcheck="true">!   port =2 (reverse).  Sport(*) has array of port #'s for each file.</span>
<span class="token number">11080</span>  <span class="token comment" spellcheck="true">!   Timea$(*)= time of measurement for each file.  Datea$= date of meas</span>
<span class="token number">11090</span>  <span class="token comment" spellcheck="true">!   for each file.  Connectors$(*)= connectors measured for each file.</span>
<span class="token number">11100</span>  <span class="token comment" spellcheck="true">!   Cfile$(*)= calibration file used to measure each file.  Cdate$(*)=</span>
<span class="token number">11110</span>  <span class="token comment" spellcheck="true">!   date of each cal file.</span>
<span class="token number">11120</span>  <span class="token comment" spellcheck="true">!   S=# ofpoints averaged, if smoothing of 8510/360 data wasdone</span>
<span class="token number">11130</span>  <span class="token comment" spellcheck="true">!   @Prt= I/O path to print on the assigned printer for the system.</span>
<span class="token number">11140</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">11150</span>   <span class="token function">SELECT</span> Meastype$
<span class="token number">11160</span>   <span class="token keyword">CASE</span> <span class="token string">"1-port"</span><span class="token punctuation">,</span><span class="token string">"1-portV"</span>
<span class="token number">11170</span>     Vardev<span class="token operator">=</span><span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span>
<span class="token number">11180</span>     <span class="token keyword">CALL</span> Print1rawdata<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>Vardev<span class="token punctuation">)</span>
<span class="token number">11190</span>   <span class="token keyword">CASE</span> <span class="token string">"2-port"</span><span class="token punctuation">,</span><span class="token string">"2-portV"</span>
<span class="token number">11200</span>     Vardev<span class="token operator">=</span><span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! &gt;0 if variable device</span>
<span class="token number">11210</span>     <span class="token keyword">CALL</span> Print2rawdata<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>Vardev<span class="token punctuation">,</span>S<span class="token punctuation">)</span>
<span class="token number">11220</span>   <span class="token keyword">CASE</span> <span class="token string">"2-portNR"</span>  <span class="token comment" spellcheck="true">! 2-port nonreciprocal</span>
<span class="token number">11230</span>     <span class="token keyword">CALL</span> Print2nrrawdata<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>S<span class="token punctuation">)</span>
<span class="token number">11240</span>   <span class="token keyword">CASE</span> <span class="token string">"Thermistor"</span><span class="token punctuation">,</span><span class="token string">"DryCal"</span>
<span class="token number">11250</span>     <span class="token keyword">CALL</span> Printprawdata<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">)</span>
<span class="token number">11260</span>   <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">11270</span> SUBEND  <span class="token comment" spellcheck="true">!.............Printrawdata ..........</span>


<span class="token number">11280</span> Print1rawdata<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Print1rawdata<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>Vardev<span class="token punctuation">)</span>
<span class="token number">11290</span>   <span class="token function">DEG</span>
<span class="token number">11300</span>   <span class="token comment" spellcheck="true">!  PRINTS FIXED 1-PORT DEVICE'S DATA (Variables = |Gamma| &amp; Arg(Gamma))</span>
<span class="token number">11310</span>   !
<span class="token number">11320</span>   <span class="token comment" spellcheck="true">! Print data from the Numfiles files in Filename$(*).  Datasp1(*) has</span>
<span class="token number">11330</span>   <span class="token comment" spellcheck="true">!   data for port 1 (forward); Datasp2(*) for port 2, for each freq,</span>
<span class="token number">11340</span>   <span class="token comment" spellcheck="true">!   file, connect, repeat, variable.  Sport(*) contains the port # for</span>
<span class="token number">11350</span>   <span class="token comment" spellcheck="true">!   each file.  Timea$(*), Datea$(*) have time &amp; date of each file,</span>
<span class="token number">11360</span>   <span class="token comment" spellcheck="true">!   Cfile$(*) &amp; Cdate$(*) have cal file names &amp; dates.</span>
<span class="token number">11370</span>   <span class="token comment" spellcheck="true">!   Connectors$(*) has connectors used for each file.</span>
<span class="token number">11380</span>   <span class="token comment" spellcheck="true">!   @Prt= I/O path to printer.</span>
<span class="token number">11390</span>   <span class="token comment" spellcheck="true">!   Vardev=1 if a Variable device</span>
<span class="token number">11400</span>   <span class="token comment" spellcheck="true">!  IN COM:  Freq(*)= all Numfreqs freqs measured.  Filesperfreq(*)</span>
<span class="token number">11410</span>   <span class="token comment" spellcheck="true">!     has info on each freq (rows) for how many files had the freq</span>
<span class="token number">11420</span>   <span class="token comment" spellcheck="true">!     (col 1) and which files they were in the order the files</span>
<span class="token number">11430</span>   <span class="token comment" spellcheck="true">!     were read in (col 2.. Numfiles+1)</span>
<span class="token number">11440</span>   !
<span class="token number">11450</span>   <span class="token comment" spellcheck="true">! OUTPUT: Contents (raw data) of all 1-port files are listed.</span>
<span class="token number">11460</span>   !
<span class="token number">11470</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">11480</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">11490</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">11500</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$<span class="token punctuation">,</span>Devicedescript$<span class="token punctuation">,</span>Oneportonly
<span class="token number">11501</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Version<span class="token operator">/</span>Vers$
<span class="token number">11510</span>   !
<span class="token number">11520</span>   <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to print device and file names?"</span><span class="token punctuation">,</span>Prdfns<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">11530</span>   <span class="token keyword">IF</span> Prdfns <span class="token keyword">THEN</span>
<span class="token number">11540</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"Program Version:  "</span><span class="token operator">&amp;</span>Vers$
<span class="token number">11541</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" "</span>
<span class="token number">11542</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"DEVICE DESCRIPTION: "</span><span class="token punctuation">;</span>Devicedescript$
<span class="token number">11550</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                    "</span><span class="token punctuation">;</span>Nisttestno$   <span class="token comment" spellcheck="true">! Device ID #</span>
<span class="token number">11560</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">11570</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"DATA LISTING FOR"</span><span class="token punctuation">;</span>Numfiles<span class="token punctuation">;</span><span class="token string">" FILES"</span><span class="token operator">&amp;</span><span class="token string">" AND"</span><span class="token punctuation">;</span>Numconnects<span class="token punctuation">;</span><span class="token string">" CONNECTIONS  ....   "</span><span class="token punctuation">;</span><span class="token function">DATE$</span><span class="token punctuation">(</span>TIMEDATE<span class="token punctuation">)</span>
<span class="token number">11580</span>     <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span>Numrepeats<span class="token punctuation">;</span><span class="token string">" settings measured."</span>
<span class="token number">11590</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">11600</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"FILES :"</span>
<span class="token number">11610</span>     <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfiles  <span class="token comment" spellcheck="true">! All files- print names, time, date, etc</span>
<span class="token number">11620</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span>Filename$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"  "</span><span class="token punctuation">;</span>Timea$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"   "</span><span class="token punctuation">;</span>Datea$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"   "</span><span class="token punctuation">;</span>Connectors$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">,</span>Meastype$
<span class="token number">11630</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"     "</span><span class="token punctuation">;</span><span class="token string">"("</span><span class="token punctuation">;</span>Cfile$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">", "</span><span class="token punctuation">;</span>Cdate$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">")        Measured on PORT "</span><span class="token punctuation">;</span>Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span>
<span class="token number">11640</span>     <span class="token keyword">NEXT</span> Eafile
<span class="token number">11650</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">11660</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">11670</span>   !
<span class="token number">11680</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> Vardev <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! For fixed devices</span>
<span class="token number">11690</span>     <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to print the raw data?"</span><span class="token punctuation">,</span>Prrawd<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">11700</span>     <span class="token keyword">IF</span> Prrawd <span class="token keyword">THEN</span>
<span class="token number">11710</span>       <span class="token keyword">IF</span> Numfreqs<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token keyword">THEN</span>
<span class="token number">11720</span>         <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to SKIP PRINTING some of the "</span><span class="token operator">&amp;</span><span class="token function">VAL$</span><span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"freqs?"</span><span class="token punctuation">,</span>Skpprt<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">11730</span>         <span class="token keyword">IF</span> Skpprt <span class="token keyword">THEN</span>
<span class="token number">11740</span>           <span class="token keyword">INPUT</span> <span class="token string">"Enter how many freqs you want to skip (e.g. 5= print freqs 1,7,13 ...)"</span><span class="token punctuation">,</span>Skipnum
<span class="token number">11750</span>           <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" SKIPPING "</span><span class="token punctuation">;</span>Skipnum<span class="token punctuation">;</span><span class="token string">" FREQUENCIES..."</span>
<span class="token number">11760</span>           Skipnum<span class="token operator">=</span>Skipnum<span class="token operator">+</span><span class="token number">1</span><span class="token comment" spellcheck="true">! First freq printed: skip Skipnum after it</span>
<span class="token number">11770</span>           Howmany<span class="token operator">=</span>Numfreqs
<span class="token number">11780</span>         <span class="token keyword">ELSE</span>
<span class="token number">11790</span>           DISP <span class="token string">"You measured "</span><span class="token punctuation">;</span>Numfreqs<span class="token punctuation">;</span><span class="token string">" freqs -- for how many freqs do you want raw data?"</span><span class="token punctuation">;</span>
<span class="token number">11800</span>           <span class="token keyword">INPUT</span> Howmany
<span class="token number">11810</span>           <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" PRINTING RESULTS FOR FIRST "</span><span class="token punctuation">;</span>Howmany<span class="token punctuation">;</span><span class="token string">" FREQS..."</span>
<span class="token number">11820</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">11830</span>       <span class="token keyword">ELSE</span>
<span class="token number">11840</span>         Howmany<span class="token operator">=</span>Numfreqs
<span class="token number">11850</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">11860</span>       Skipit<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">11870</span>     !
<span class="token number">11880</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">11890</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"FREQ  FILE CON     GAMMA SP #1                       GAMMA SP #2 "</span>
<span class="token number">11900</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                   MAG   PHASE                       MAG   PHASE"</span>
<span class="token number">11910</span>   !
<span class="token number">11920</span>       <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Howmany<span class="token comment" spellcheck="true">! Each frequency</span>
<span class="token number">11930</span>         <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">11940</span>           Allfiles<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! # Files with this frequency</span>
<span class="token number">11950</span>           <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Allfiles<span class="token comment" spellcheck="true">! Each file with frequency #I</span>
<span class="token number">11960</span>             J<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Eafile<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Which file(s) has freq #I</span>
<span class="token number">11970</span>             <span class="token keyword">FOR</span> K<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numconnects<span class="token comment" spellcheck="true">! Each connect</span>
<span class="token number">11980</span>               <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Print port 1 data  (0's for port 1 cols)</span>
<span class="token number">11990</span>                 <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> <span class="token number">12040</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span>
<span class="token number">12000</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">12010</span>               <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Print port 2 data  (0's for port 2 cols)</span>
<span class="token number">12020</span>                 <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> <span class="token number">12040</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">12030</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">12040</span>               <span class="token function">IMAGE</span> <span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span><span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">3</span>X<span class="token punctuation">,</span><span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">3</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span>M4D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">18</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span>M4D.<span class="token number">2</span>D
<span class="token number">12050</span>             <span class="token keyword">NEXT</span> K
<span class="token number">12060</span>           <span class="token keyword">NEXT</span> Eafile
<span class="token number">12070</span>           <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">12080</span>           <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">12090</span>         <span class="token keyword">ELSE</span>
<span class="token number">12100</span>           <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">12110</span>             Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">12120</span>             <span class="token keyword">IF</span> Skipnum<span class="token operator">=</span>Skipit <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span><span class="token comment" spellcheck="true">! Reset flag to print next #</span>
<span class="token number">12130</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">12140</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">12150</span>       <span class="token keyword">NEXT</span> I
<span class="token number">12160</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Page feed</span>
<span class="token number">12170</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">12180</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">12190</span> SUBEND   <span class="token comment" spellcheck="true">!.......Print1rawdata.........................</span>


<span class="token number">12200</span> Print2rawdata<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Print2rawdata<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>D1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>Vardev<span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">12210</span>   <span class="token function">DEG</span>
<span class="token number">12220</span>   <span class="token comment" spellcheck="true">! PRINTS FIXED, RECIPROCAL 2-PORT DEVICE'S RAW DATA</span>
<span class="token number">12230</span>   !
<span class="token number">12240</span>   <span class="token comment" spellcheck="true">! NOTE: THIS VERSION ASSUMES 1 REPEAT PER CONNECT</span>
<span class="token number">12250</span>   !
<span class="token number">12260</span>   <span class="token comment" spellcheck="true">! Print data from the Numfiles in Filename$(*).  D1(*) contains</span>
<span class="token number">12270</span>   <span class="token comment" spellcheck="true">!   data for forward direction; D2(*) for reverse, for each freq,</span>
<span class="token number">12280</span>   <span class="token comment" spellcheck="true">!   file, connect, repeat, variable.  Sport(*) contains the port # for</span>
<span class="token number">12290</span>   <span class="token comment" spellcheck="true">!   each file.  Timea$(*), Datea$(*) have time &amp; date of each file,</span>
<span class="token number">12300</span>   <span class="token comment" spellcheck="true">!   Cfile$(*),Cdate$(*)= cal file names &amp; dates,</span>
<span class="token number">12310</span>   <span class="token comment" spellcheck="true">!   Connectors$(*) has connectors used for each file.</span>
<span class="token number">12320</span>   <span class="token comment" spellcheck="true">!   Vardev&gt;0 if device is a variable 2-port</span>
<span class="token number">12330</span>   <span class="token comment" spellcheck="true">!  IN COM:  Freq(*)= all Numfreqs freqs measured.  Filesperfreq(*)</span>
<span class="token number">12340</span>   <span class="token comment" spellcheck="true">!     has info on each freq (rows) for how many files had the freq</span>
<span class="token number">12350</span>   <span class="token comment" spellcheck="true">!     (col 1) and which files they were in the order the files</span>
<span class="token number">12360</span>   <span class="token comment" spellcheck="true">!     were read in (col 2.. Numfiles+1)</span>
<span class="token number">12370</span>   !
<span class="token number">12380</span>   <span class="token comment" spellcheck="true">! OUTPUT: A list of all raw data from each file is listed.</span>
<span class="token number">12390</span>   !
<span class="token number">12400</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">12410</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">12420</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">12430</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$<span class="token punctuation">,</span>Devicedescript$<span class="token punctuation">,</span>Oneportonly
<span class="token number">12431</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Version<span class="token operator">/</span>Vers$
<span class="token number">12440</span>   !
<span class="token number">12450</span>   <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to print device and file names?"</span><span class="token punctuation">,</span>Prdfns<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">12460</span>   <span class="token keyword">IF</span> Prdfns <span class="token keyword">THEN</span>
<span class="token number">12470</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"Program Version:  "</span><span class="token operator">&amp;</span>Vers$
<span class="token number">12471</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" "</span>
<span class="token number">12472</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"DEVICE DESCRIPTION: "</span><span class="token punctuation">;</span>Devicedescript$
<span class="token number">12480</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                    "</span><span class="token punctuation">;</span>Nisttestno$
<span class="token number">12490</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">12500</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"DATA LISTING FOR"</span><span class="token punctuation">;</span>Numfiles<span class="token punctuation">;</span><span class="token string">" FILES"</span><span class="token operator">&amp;</span><span class="token string">" AND"</span><span class="token punctuation">;</span>Numconnects<span class="token punctuation">;</span><span class="token string">" CONNECTIONS  ....  "</span><span class="token punctuation">;</span><span class="token function">DATE$</span><span class="token punctuation">(</span>TIMEDATE<span class="token punctuation">)</span>
<span class="token number">12510</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"Device was reversed between files: listing shows correct S11-S22"</span>
<span class="token number">12520</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">12530</span>     <span class="token keyword">IF</span> Smoothed <span class="token keyword">THEN</span>
<span class="token number">12540</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"8510/360 DATA WAS SMOOTHED.  S12 data = average of "</span><span class="token punctuation">;</span>Smoothed<span class="token punctuation">;</span><span class="token string">" points."</span>
<span class="token number">12550</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">12560</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">12570</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"FILES :"</span>
<span class="token number">12580</span>     <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfiles  <span class="token comment" spellcheck="true">! All files</span>
<span class="token number">12590</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span>Filename$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"  "</span><span class="token punctuation">;</span>Timea$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"   "</span><span class="token punctuation">;</span>Datea$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"    "</span><span class="token punctuation">;</span>Connectors$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">,</span>Meastype$
<span class="token number">12600</span>       <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"          ("</span><span class="token punctuation">;</span>Cfile$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">", "</span><span class="token punctuation">;</span>Cdate$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">")   : reversed connection"</span>
<span class="token number">12610</span>       <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"         ("</span><span class="token punctuation">;</span>Cfile$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">", "</span><span class="token punctuation">;</span>Cdate$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">")   : normal connection"</span>
<span class="token number">12620</span>     <span class="token keyword">NEXT</span> Eafile
<span class="token number">12630</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">12640</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">12650</span>   !
<span class="token number">12660</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> Vardev <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Print the raw data IF NOT A VARIABLE DEVICE</span>
<span class="token number">12670</span>     <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to print the raw data?"</span><span class="token punctuation">,</span>Prrawd<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">12680</span>     <span class="token keyword">IF</span> Prrawd <span class="token keyword">THEN</span>
<span class="token number">12690</span>       <span class="token keyword">IF</span> Numfreqs<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token keyword">THEN</span>
<span class="token number">12700</span>         <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to SKIP PRINTING some of the "</span><span class="token operator">&amp;</span><span class="token function">VAL$</span><span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"freqs?"</span><span class="token punctuation">,</span>Skpprt<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">12710</span>         <span class="token keyword">IF</span> Skpprt <span class="token keyword">THEN</span>
<span class="token number">12720</span>           <span class="token keyword">INPUT</span> <span class="token string">"Enter how many freqs you want to skip (e.g. 5= print freqs 1,7,13 ...)"</span><span class="token punctuation">,</span>Skipnum
<span class="token number">12730</span>           <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" SKIPPING "</span><span class="token punctuation">;</span>Skipnum<span class="token punctuation">;</span><span class="token string">" FREQUENCIES..."</span>
<span class="token number">12740</span>           Skipnum<span class="token operator">=</span>Skipnum<span class="token operator">+</span><span class="token number">1</span><span class="token comment" spellcheck="true">! First freq printed: skip Skipnum after it</span>
<span class="token number">12750</span>           Howmany<span class="token operator">=</span>Numfreqs
<span class="token number">12760</span>         <span class="token keyword">ELSE</span>
<span class="token number">12770</span>           DISP <span class="token string">"You measured "</span><span class="token punctuation">;</span>Numfreqs<span class="token punctuation">;</span><span class="token string">" freqs -- for how many freqs do you want raw data?"</span><span class="token punctuation">;</span>
<span class="token number">12780</span>           <span class="token keyword">INPUT</span> Howmany
<span class="token number">12790</span>           <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" PRINTING RESULTS FOR FIRST "</span><span class="token punctuation">;</span>Howmany<span class="token punctuation">;</span><span class="token string">" FREQS..."</span>
<span class="token number">12800</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">12810</span>       <span class="token keyword">ELSE</span>
<span class="token number">12820</span>         Howmany<span class="token operator">=</span>Numfreqs
<span class="token number">12830</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">12840</span>       Skipit<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">12850</span>       !
<span class="token number">12860</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">12870</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"FREQ  FILE CON        S11               S12             S22      "</span>
<span class="token number">12880</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                   MAG   PHASE       MAG   PHASE     MAG   PHASE"</span>
<span class="token number">12890</span>   !
<span class="token number">12900</span>       <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs<span class="token comment" spellcheck="true">! Each frequency</span>
<span class="token number">12910</span>         <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">12920</span>           Allfiles<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Files with this frequency on the SRM</span>
<span class="token number">12930</span>           <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Allfiles<span class="token comment" spellcheck="true">! Each file with frequency #I</span>
<span class="token number">12940</span>             J<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Eafile<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Which file has freq #I</span>
<span class="token number">12950</span>             <span class="token keyword">FOR</span> K<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numconnects<span class="token comment" spellcheck="true">! Each connect</span>
<span class="token number">12960</span>               <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Data in D1(*) (=Datasp1(*))</span>
<span class="token number">12970</span>                 <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> B<span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! S11,S12,S22</span>
<span class="token number">12980</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">12990</span>               <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Data in D2(*) (=Datasp2(*))</span>
<span class="token number">13000</span>                 <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> B<span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! S11,S12,S22</span>
<span class="token number">13010</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">13020</span> B<span class="token punctuation">:</span>            <span class="token function">IMAGE</span> <span class="token number">3</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span><span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span>D<span class="token punctuation">,</span><span class="token number">3</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span>M4D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">5</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span>M4D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span>M4D.<span class="token number">2</span>D
<span class="token number">13030</span>             <span class="token keyword">NEXT</span> K
<span class="token number">13040</span>           <span class="token keyword">NEXT</span> Eafile
<span class="token number">13050</span>           <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">13060</span>           <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">13070</span>         <span class="token keyword">ELSE</span>
<span class="token number">13080</span>           <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">13090</span>             Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">13100</span>             <span class="token keyword">IF</span> Skipit<span class="token operator">=</span>Skipnum <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span><span class="token comment" spellcheck="true">! Reset flag to print next #</span>
<span class="token number">13110</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">13120</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">13130</span>       <span class="token keyword">NEXT</span> I
<span class="token number">13140</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Page feed</span>
<span class="token number">13150</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">13160</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">13170</span> SUBEND   <span class="token comment" spellcheck="true">!.......Print2rawdata.........................</span>


<span class="token number">13180</span> Readrawdata<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Readrawdata<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Meastype$<span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Residuals<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">13190</span>  <span class="token comment" spellcheck="true">! Reads all data from all files into the </span><span class="token string">"raw"</span> <span class="token keyword">data</span> arrays
<span class="token number">13200</span>  !
<span class="token number">13210</span>  <span class="token comment" spellcheck="true">! INPUT: Filename$(*)= file names   Numfiles= # of files</span>
<span class="token number">13220</span>  <span class="token comment" spellcheck="true">!        Pathin$= directory where files are   Drivein$= disc drive</span>
<span class="token number">13230</span>  <span class="token comment" spellcheck="true">!        Meastype$= type of device</span>
<span class="token number">13240</span>  <span class="token comment" spellcheck="true">!        Smoothed= # of points used to smooth 8510/360 S12,S21 data</span>
<span class="token number">13250</span>  <span class="token comment" spellcheck="true">!                =0 if no smoothing done</span>
<span class="token number">13260</span>  !
<span class="token number">13270</span>  <span class="token comment" spellcheck="true">! OUTPUT: Dataspi(Numfreqs,Numfiles,Numconnects,Numrepeats,12)=</span>
<span class="token number">13280</span>  <span class="token comment" spellcheck="true">!           data for each freq,file,connect,repeat (setting), &amp;</span>
<span class="token number">13290</span>  <span class="token comment" spellcheck="true">!           variable for the device type (e.g. Sij for a 2-port).</span>
<span class="token number">13300</span>  <span class="token comment" spellcheck="true">!           Datasp1(*) for port 1 (forward), Datasp2(*) for port 2 (rev)</span>
<span class="token number">13310</span>  <span class="token comment" spellcheck="true">!         Pwrstd(Numfiles,Numfreqs,9)= data for the device used to</span>
<span class="token number">13320</span>  <span class="token comment" spellcheck="true">!           calibrate for power, if the devices are thermistors/DryCal</span>
<span class="token number">13330</span>  <span class="token comment" spellcheck="true">!         Residuals(Numfreqs,8)= delta, Snist,Sc, total uncert for Gamma</span>
<span class="token number">13340</span>  <span class="token comment" spellcheck="true">!           mag &amp; phase, for a power device measured on Direct Comparison</span>
<span class="token number">13350</span>  <span class="token comment" spellcheck="true">!           system. Has 8 calculation residuals if not a DCS measurement.</span>
<span class="token number">13360</span>  !
<span class="token number">13370</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">13380</span>   <span class="token function">SELECT</span> Meastype$
<span class="token number">13390</span>   <span class="token keyword">CASE</span> <span class="token string">"1-port"</span><span class="token punctuation">,</span><span class="token string">"1-portV"</span>
<span class="token number">13400</span>     <span class="token keyword">CALL</span> Read1files<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">13410</span>   <span class="token keyword">CASE</span> <span class="token string">"2-port"</span><span class="token punctuation">,</span><span class="token string">"2-portV"</span><span class="token punctuation">,</span><span class="token string">"2-portNR"</span><span class="token punctuation">,</span><span class="token string">"2-portVNR"</span>
<span class="token number">13420</span>     <span class="token keyword">CALL</span> Read2files<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">13430</span>   <span class="token keyword">CASE</span> <span class="token string">"Thermistor"</span><span class="token punctuation">,</span><span class="token string">"DryCal"</span>
<span class="token number">13440</span>     <span class="token keyword">CALL</span> Readpfiles<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Pathin$<span class="token punctuation">,</span>Drivein$<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Residuals<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">13450</span>   <span class="token keyword">CASE</span> <span class="token keyword">ELSE</span>
<span class="token number">13460</span>     <span class="token function">PRINT</span> <span class="token string">"CALREP7.1 doesn't know how to handle devices of type "</span><span class="token punctuation">;</span>Meastype$
<span class="token number">13470</span>     <span class="token function">PRINT</span> <span class="token string">"... PAUSED in SUB Readrawdata ..."</span>
<span class="token number">13480</span>     PAUSE
<span class="token number">13490</span>   <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">13500</span>   <span class="token keyword">CALL</span> Removebandedge <span class="token comment" spellcheck="true">! Remove files if repeated freq count at band edges</span>
<span class="token number">13510</span> SUBEND <span class="token comment" spellcheck="true">!...............Readrawdata.............</span>


<span class="token number">13520</span> Printprawdata<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Printprawdata<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">)</span>
<span class="token number">13530</span>   <span class="token function">DEG</span>
<span class="token number">13540</span>   <span class="token comment" spellcheck="true">! PRINT POWER RAW DATA.</span>
<span class="token number">13550</span>   <span class="token comment" spellcheck="true">! Print data from the Numfiles in Filename$(*).  Datasp1(*) contains</span>
<span class="token number">13560</span>   <span class="token comment" spellcheck="true">!   data for port 1 (forward); Datasp2(*) for port 2, for each freq,</span>
<span class="token number">13570</span>   <span class="token comment" spellcheck="true">!   file, connect, repeat, variable.  Sport(*) contains the port # for</span>
<span class="token number">13580</span>   <span class="token comment" spellcheck="true">!   each file.  Timea$(*), Datea$(*) have time &amp; date of each file,</span>
<span class="token number">13590</span>   <span class="token comment" spellcheck="true">!   Cfile$(*),Cdate$(*)= calibration file names &amp; dates.</span>
<span class="token number">13600</span>   <span class="token comment" spellcheck="true">!   Connectors$(*) has connectors used for each file.</span>
<span class="token number">13610</span>   <span class="token comment" spellcheck="true">!  IN COM:  Freq(*)= all Numfreqs freqs measured.  Filesperfreq(*)</span>
<span class="token number">13620</span>   <span class="token comment" spellcheck="true">!     has info on each freq (rows) for how many files had the freq</span>
<span class="token number">13630</span>   <span class="token comment" spellcheck="true">!     (col 1) and which files they were in the order the files</span>
<span class="token number">13640</span>   <span class="token comment" spellcheck="true">!     were read in (col 2.. Numfiles+1)</span>
<span class="token number">13650</span>   !
<span class="token number">13660</span>   <span class="token comment" spellcheck="true">! OUTPUT: A list of all raw data from each file is listed (|Gamma|,</span>
<span class="token number">13670</span>   <span class="token comment" spellcheck="true">!      efficiency, Kb).</span>
<span class="token number">13680</span>   !
<span class="token number">13690</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">13700</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">13710</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">13720</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$<span class="token punctuation">,</span>Devicedescript$<span class="token punctuation">,</span>Oneportonly
<span class="token number">13721</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Version<span class="token operator">/</span>Vers$
<span class="token number">13730</span>   !
<span class="token number">13740</span>   <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to print device and file names?"</span><span class="token punctuation">,</span>Prdfns<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">13750</span>   <span class="token keyword">IF</span> Prdfns <span class="token keyword">THEN</span>
<span class="token number">13760</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"Program Version:  "</span><span class="token operator">&amp;</span>Vers$
<span class="token number">13761</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" "</span>
<span class="token number">13762</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"DEVICE DESCRIPTION: "</span><span class="token punctuation">;</span>Devicedescript$
<span class="token number">13770</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                    "</span><span class="token punctuation">;</span>Nisttestno$
<span class="token number">13780</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">13790</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"DATA LISTING FOR"</span><span class="token punctuation">;</span>Numfiles<span class="token punctuation">;</span><span class="token string">" FILES"</span><span class="token operator">&amp;</span><span class="token string">" AND "</span><span class="token punctuation">;</span>Numconnects<span class="token punctuation">;</span><span class="token string">" CONNECTIONS    ....   "</span><span class="token punctuation">;</span><span class="token function">DATE$</span><span class="token punctuation">(</span>TIMEDATE<span class="token punctuation">)</span>
<span class="token number">13800</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">13810</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"FILES :"</span>
<span class="token number">13820</span>     <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfiles  <span class="token comment" spellcheck="true">! All files</span>
<span class="token number">13830</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span>Filename$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"  "</span><span class="token punctuation">;</span>Timea$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"   "</span><span class="token punctuation">;</span>Datea$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"   "</span><span class="token punctuation">;</span>Connectors$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">,</span>Meastype$
<span class="token number">13840</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"     "</span><span class="token punctuation">;</span><span class="token string">"("</span><span class="token punctuation">;</span>Cfile$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">", "</span><span class="token punctuation">;</span>Cdate$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">")       Measured on PORT "</span><span class="token punctuation">;</span>Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span>
<span class="token number">13850</span>     <span class="token keyword">NEXT</span> Eafile
<span class="token number">13860</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">13870</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">13880</span>   !
<span class="token number">13890</span>   <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to print the raw data?"</span><span class="token punctuation">,</span>Prrawd<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">13900</span>   <span class="token keyword">IF</span> Prrawd <span class="token keyword">THEN</span>
<span class="token number">13910</span>     <span class="token keyword">IF</span> Numfreqs<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token keyword">THEN</span>
<span class="token number">13920</span>       <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to SKIP PRINTING some of the "</span><span class="token operator">&amp;</span><span class="token function">VAL$</span><span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"freqs?"</span><span class="token punctuation">,</span>Skpprt<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">13930</span>       <span class="token keyword">IF</span> Skpprt <span class="token keyword">THEN</span>
<span class="token number">13940</span>         <span class="token keyword">INPUT</span> <span class="token string">"Enter how many freqs you want to skip (e.g. 5= print freqs 1,7,13 ...)"</span><span class="token punctuation">,</span>Skipnum
<span class="token number">13950</span>         <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" SKIPPING "</span><span class="token punctuation">;</span>Skipnum<span class="token punctuation">;</span><span class="token string">" FREQUENCIES..."</span>
<span class="token number">13960</span>         Skipnum<span class="token operator">=</span>Skipnum<span class="token operator">+</span><span class="token number">1</span>  <span class="token comment" spellcheck="true">! First freq printed: skip Skipnum after it</span>
<span class="token number">13970</span>         Howmany<span class="token operator">=</span>Numfreqs
<span class="token number">13980</span>       <span class="token keyword">ELSE</span>
<span class="token number">13990</span>         DISP <span class="token string">"You measured "</span><span class="token punctuation">;</span>Numfreqs<span class="token punctuation">;</span><span class="token string">" freqs -- for how many freqs do you want raw data?"</span><span class="token punctuation">;</span>
<span class="token number">14000</span>         <span class="token keyword">INPUT</span> Howmany
<span class="token number">14010</span>         <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" PRINTING RESULTS FOR FIRST "</span><span class="token punctuation">;</span>Howmany<span class="token punctuation">;</span><span class="token string">" FREQS..."</span>
<span class="token number">14020</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">14030</span>     <span class="token keyword">ELSE</span>
<span class="token number">14040</span>       Howmany<span class="token operator">=</span>Numfreqs
<span class="token number">14050</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">14060</span>     Skipit<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">14070</span>       !
<span class="token number">14080</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"FREQ  FILE CON     MAG. GAMMA     ARG. GAMMA   EFFICIENCY      CAL FACTOR"</span>
<span class="token number">14090</span>    !
<span class="token number">14100</span>     <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs<span class="token comment" spellcheck="true">! Each frequency</span>
<span class="token number">14110</span>       <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">14120</span>         Allfiles<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Files with this frequency on the SRM</span>
<span class="token number">14130</span>         <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Allfiles<span class="token comment" spellcheck="true">! Each file with frequency #I</span>
<span class="token number">14140</span>           J<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Eafile<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Which file has freq #I</span>
<span class="token number">14150</span>           <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token punctuation">(</span><span class="token function">POS</span><span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"N"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">AND</span> Numconnects<span class="token operator">=</span><span class="token number">6</span> <span class="token keyword">THEN</span>
<span class="token number">14160</span>             Allconnects<span class="token operator">=</span><span class="token number">3</span><span class="token comment" spellcheck="true">! Direct comp system has 6 connects, others have 3</span>
<span class="token number">14170</span>           <span class="token keyword">ELSE</span>
<span class="token number">14180</span>             Allconnects<span class="token operator">=</span>Numconnects
<span class="token number">14190</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">14200</span>           <span class="token keyword">FOR</span> K<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Allconnects<span class="token comment" spellcheck="true">! Each connect</span>
<span class="token number">14210</span>             <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Data in Datasp1(*)</span>
<span class="token number">14220</span>               <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> <span class="token number">14270</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">14230</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">14240</span>             <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Data in Datasp2(*)</span>
<span class="token number">14250</span>               <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> <span class="token number">14270</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">14260</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">14270</span>             <span class="token function">IMAGE</span> <span class="token number">2</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span><span class="token number">2</span>D<span class="token punctuation">,</span>X<span class="token punctuation">,</span>D<span class="token punctuation">,</span><span class="token number">8</span>X<span class="token punctuation">,</span>DD.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">9</span>X<span class="token punctuation">,</span>M3D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">6</span>X<span class="token punctuation">,</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">11</span>X<span class="token punctuation">,</span>D.<span class="token number">4</span>D
<span class="token number">14280</span>           <span class="token keyword">NEXT</span> K
<span class="token number">14290</span>         <span class="token keyword">NEXT</span> Eafile
<span class="token number">14300</span>         <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">14310</span>         <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">14320</span>       <span class="token keyword">ELSE</span>
<span class="token number">14330</span>         <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">14340</span>           Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">14350</span>           <span class="token keyword">IF</span> Skipit<span class="token operator">=</span>Skipnum <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span><span class="token comment" spellcheck="true">! Reset flag to print next freq</span>
<span class="token number">14360</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">14370</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">14380</span>     <span class="token keyword">NEXT</span> I
<span class="token number">14390</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Page feed</span>
<span class="token number">14400</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">14410</span> SUBEND   <span class="token comment" spellcheck="true">!.......Printprawdata.........................</span>


<span class="token number">14420</span> Computations<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Computations<span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Res<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">14430</span><span class="token comment" spellcheck="true">!This subroutine computes averages and uncertainties for the customer</span>
<span class="token number">14440</span><span class="token comment" spellcheck="true">!reports and data base.</span>
<span class="token number">14450</span><span class="token comment" spellcheck="true">!INPUT: Connector$=Type of connectors</span>
<span class="token number">14460</span><span class="token comment" spellcheck="true">!       Cfile$(*),Cdate$(*)= cal file names &amp; dates</span>
<span class="token number">14470</span><span class="token comment" spellcheck="true">!       Sport=Sp for each file(1 or 2);Datasp1(*)=Raw data for Sp=1 (port 1</span>
<span class="token number">14480</span><span class="token comment" spellcheck="true">!       or forward) for each frequency, file, connect, repeat, &amp; variable.</span>
<span class="token number">14490</span><span class="token comment" spellcheck="true">!            1-ports: Gamma magnitude &amp; phase.</span>
<span class="token number">14500</span><span class="token comment" spellcheck="true">!            2-ports: S11, S12, S21, S22 magnitude &amp; phase</span>
<span class="token number">14510</span><span class="token comment" spellcheck="true">!            Power: |Gamma|, efficiency, Kb, Pdc, Pinc, Arg(Gamma)</span>
<span class="token number">14520</span><span class="token comment" spellcheck="true">!       Datasp2(*)=Raw data Sp=2 (port 2 or reverse), same as Datasp1(*).</span>
<span class="token number">14530</span><span class="token comment" spellcheck="true">!       Pwrstd=Raw data for Power calibration standard (Gamma, efficiency,</span>
<span class="token number">14540</span><span class="token comment" spellcheck="true">!            etc, for the standard used for the power calib.  Used for</span>
<span class="token number">14550</span><span class="token comment" spellcheck="true">!            power systematic uncert calculations).</span>
<span class="token number">14560</span><span class="token comment" spellcheck="true">!       Res(*)= Residuals(*) array of main program. Has uncerts for Gamma</span>
<span class="token number">14570</span><span class="token comment" spellcheck="true">!          meas of a power device if device was measured on Direct comp</span>
<span class="token number">14580</span><span class="token comment" spellcheck="true">!          system, or calculation residuals if not measured on DCS.</span>
<span class="token number">14590</span>!
<span class="token number">14600</span><span class="token comment" spellcheck="true">! OUTPUT: If device is variable, output is for each setting measured for</span>
<span class="token number">14610</span><span class="token comment" spellcheck="true">!            each freq, else output is final average for each frequency.</span>
<span class="token number">14620</span><span class="token comment" spellcheck="true">!        Avgs=Final average of variables and difference of port 1-port 2 or</span>
<span class="token number">14630</span><span class="token comment" spellcheck="true">!        forward-reverse where applicable, for each frequency.</span>
<span class="token number">14640</span><span class="token comment" spellcheck="true">!           1-ports:  |Gamma|, Arg(Gamma), |Gamma1|-|Gamma2|,Arg(Gamma1)-</span>
<span class="token number">14650</span><span class="token comment" spellcheck="true">!                     Arg(Gamma2)</span>
<span class="token number">14660</span><span class="token comment" spellcheck="true">!           2-port RECIPROCAL: S11, S12, S22 magnitude &amp; phase, S11forward-</span>
<span class="token number">14670</span><span class="token comment" spellcheck="true">!                     S11reverse, S22forward-S22reverse mag &amp; phase</span>
<span class="token number">14680</span><span class="token comment" spellcheck="true">!           Power:    |Gamma|, efficiency, Kb, Pdc, Pinc, Arg(Gamma),</span>
<span class="token number">14690</span><span class="token comment" spellcheck="true">!                      difference Gamma port1-2 mag &amp; phase.</span>
<span class="token number">14700</span><span class="token comment" spellcheck="true">!        Sc=Sc short term (connector) uncertainty for each freq,each var.</span>
<span class="token number">14710</span><span class="token comment" spellcheck="true">!        Snist=Snist long term (between cals) uncert for ea freq, ea var.</span>
<span class="token number">14720</span><span class="token comment" spellcheck="true">!        Syst=Systematic uncertainty ea freq, ea var.</span>
<span class="token number">14730</span><span class="token comment" spellcheck="true">!        Totuncert=Total uncertainty ea freq, ea var.</span>
<span class="token number">14740</span><span class="token comment" spellcheck="true">!        Mags(*)= array of setting values, if device is variable (in COM)</span>
<span class="token number">14750</span><span class="token comment" spellcheck="true">! NOTE: for power, Snist, Systematic &amp; total uncerts are given for |Gamma|,</span>
<span class="token number">14760</span><span class="token comment" spellcheck="true">!    efficiency, and Kb only.</span>
<span class="token number">14770</span>!
<span class="token number">14780</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">14790</span>   <span class="token function">DEG</span>
<span class="token number">14800</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">14810</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">14820</span>   !
<span class="token number">14830</span>   <span class="token comment" spellcheck="true">!Meastype$ determines how the output is determined &amp; calcs done.</span>
<span class="token number">14840</span>   <span class="token comment" spellcheck="true">!  If device is fixed, an average is gotten for each freq.</span>
<span class="token number">14850</span>   <span class="token comment" spellcheck="true">!  If device is variable, an average is gotten for each repeat (setting)</span>
<span class="token number">14860</span>   <span class="token comment" spellcheck="true">!     for each freq.</span>
<span class="token number">14870</span>   !
<span class="token number">14880</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token keyword">CALL</span> Averagevariable<span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">14890</span>   !
<span class="token number">14900</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! Fixed device.</span>
<span class="token number">14910</span>     <span class="token keyword">CALL</span> Averagefixed<span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Res<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">14920</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">14930</span> SUBEND <span class="token comment" spellcheck="true">!..........Computations.........................</span>


<span class="token number">14940</span> Averagevariable<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Averagevariable<span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">14950</span>  <span class="token comment" spellcheck="true">! find final average of variables, and calculate uncertainties, for</span>
<span class="token number">14960</span>  <span class="token comment" spellcheck="true">!  variable devices.</span>
<span class="token number">14970</span>  !
<span class="token number">14980</span>  <span class="token comment" spellcheck="true">! INPUT: Meastype$= </span><span class="token string">"1-portV"</span><span class="token punctuation">,</span> <span class="token operator">or</span> <span class="token string">"2-portV"</span><span class="token punctuation">,</span> <span class="token operator">or</span> <span class="token string">"2-portVNR"</span>
<span class="token number">14990</span>  <span class="token comment" spellcheck="true">!        Connector$= type of connectors measured</span>
<span class="token number">15000</span>  <span class="token comment" spellcheck="true">!        Sport(*)= port # (1 or 2) or direction (1=forward, 2=reverse)</span>
<span class="token number">15010</span>  <span class="token comment" spellcheck="true">!            of measurement for each file.</span>
<span class="token number">15020</span>  <span class="token comment" spellcheck="true">!        Datasp1(*),Datasp2(*)= data for port 1 or 2 for each file</span>
<span class="token number">15030</span>  !
<span class="token number">15040</span>  <span class="token comment" spellcheck="true">! OUTPUT: Avgs(*) has averages each freq, each setting, each variable:</span>
<span class="token number">15050</span>  <span class="token comment" spellcheck="true">!           </span><span class="token string">"1-port"</span><span class="token operator">=</span> |Gamma|<span class="token punctuation">,</span> Arg<span class="token punctuation">(</span>Gamma<span class="token punctuation">)</span><span class="token punctuation">,</span> difference |Gamma| port <span class="token number">1</span>
<span class="token number">15060</span>  <span class="token comment" spellcheck="true">!                   minus port 2, difference Arg port 1 minus port 2.</span>
<span class="token number">15070</span>  <span class="token comment" spellcheck="true">!           </span><span class="token string">"2-port"</span><span class="token punctuation">,</span> <span class="token string">"2-portNR"</span><span class="token operator">=</span> mags <span class="token operator">&amp;</span> args <span class="token function">of</span> S11<span class="token punctuation">,</span> S12<span class="token punctuation">,</span> S21<span class="token punctuation">,</span> S22
<span class="token number">15080</span>  <span class="token comment" spellcheck="true">!               (for </span><span class="token string">"2-port"</span><span class="token punctuation">,</span> S12<span class="token operator">=</span>S21<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">and</span> differences <span class="token function">of</span> S11 mag <span class="token operator">&amp;</span>
<span class="token number">15090</span>  <span class="token comment" spellcheck="true">!               arg &amp; S22 mag and arg forward-reverse.</span>
<span class="token number">15100</span>  <span class="token comment" spellcheck="true">!           </span><span class="token string">"Thermistor"</span><span class="token punctuation">,</span> <span class="token string">"DryCal"</span><span class="token operator">=</span> |Gamma|<span class="token punctuation">,</span> efficiency<span class="token punctuation">,</span> Kb<span class="token punctuation">,</span> Pdc<span class="token punctuation">,</span> Pinc<span class="token punctuation">,</span>
<span class="token number">15110</span>  <span class="token comment" spellcheck="true">!                 Arg(Gamma), and difference mag &amp; arg Gamma port 1-2.</span>
<span class="token number">15120</span>  <span class="token comment" spellcheck="true">!         Sc(*)= short term (connector) uncertainty for data in Avgs(*)</span>
<span class="token number">15130</span>  <span class="token comment" spellcheck="true">!              (except for the difference calcs)</span>
<span class="token number">15140</span>  <span class="token comment" spellcheck="true">!         Snist(*)= long term (calib) uncertainty for data (except diffs)</span>
<span class="token number">15150</span>  <span class="token comment" spellcheck="true">!         Syst(*)= systematic uncertainty for data (except for diffs)</span>
<span class="token number">15160</span>  <span class="token comment" spellcheck="true">!         Totuncert(*)= total uncertainty for data (except for diffs)</span>
<span class="token number">15170</span>  <span class="token comment" spellcheck="true">!        Mags(*)= array of setting values (in COM)</span>
<span class="token number">15180</span>  !
<span class="token number">15190</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">15200</span>   <span class="token function">DEG</span>
<span class="token number">15210</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">15220</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">15230</span>   !
<span class="token number">15240</span>   <span class="token comment" spellcheck="true">! FOR A VARIABLE DEVICE, Numrepeats= TOTAL # OF VARIABLE SETTINGS.</span>
<span class="token number">15250</span>   !
<span class="token number">15260</span>   <span class="token comment" spellcheck="true">! Local vars:  Numvars= # of variables to calculate for (varies by</span>
<span class="token number">15270</span>   <span class="token comment" spellcheck="true">!       what Meastype$ is).  Connectavg(*)= avg of connects= avg for</span>
<span class="token number">15280</span>   <span class="token comment" spellcheck="true">!       each repeat (setting).  Fileavg(*)= avg of files= avg for each</span>
<span class="token number">15290</span>   <span class="token comment" spellcheck="true">!       setting, Avgs1(*)= averages for port 1 data. Avgs2(*)= avgs for</span>
<span class="token number">15300</span>   <span class="token comment" spellcheck="true">!       port 2. Difference(*) &amp; Var(*) used for random uncert calcs</span>
<span class="token number">15310</span>   !
<span class="token number">15320</span>   Numfiles<span class="token operator">=</span><span class="token function">SIZE</span><span class="token punctuation">(</span>Sport<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! TOTAL  # of files read in</span>
<span class="token number">15330</span>   !
<span class="token number">15340</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Determine # of variables needed</span>
<span class="token number">15350</span>     <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"What type of device is this variable 2-port?"</span><span class="token punctuation">,</span>Ans<span class="token punctuation">,</span><span class="token string">"01Phase shifter;02Variable atten;03   OTHER;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">15360</span>     <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Phaseshifter<span class="token operator">=</span><span class="token number">1</span>    <span class="token comment" spellcheck="true">! Arg(S12) only, w/diffs from 0 deg</span>
<span class="token number">15370</span>     <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Variableatten<span class="token operator">=</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! Need only |S12|, w/diffs from 0 dB</span>
<span class="token number">15380</span>     Numvars<span class="token operator">=</span><span class="token number">8</span>
<span class="token number">15390</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">15400</span>   !
<span class="token number">15410</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Determine type of sliding termination</span>
<span class="token number">15420</span>     <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"What type of device is this variable 1-port?"</span><span class="token punctuation">,</span>Ans<span class="token punctuation">,</span><span class="token string">"01Sliding Load;02Sliding Short;03   OTHER;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">15430</span>     <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Slidload<span class="token operator">=</span><span class="token number">1</span>    <span class="token comment" spellcheck="true">! Sliding load</span>
<span class="token number">15440</span>     <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Slidshort<span class="token operator">=</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! Sliding short</span>
<span class="token number">15450</span>     Numvars<span class="token operator">=</span><span class="token number">2</span>                   <span class="token comment" spellcheck="true">! Gamma Mag &amp; arg for sliding short.</span>
<span class="token number">15460</span>     <span class="token keyword">IF</span> Slidshort <span class="token keyword">THEN</span>
<span class="token number">15470</span>       <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numrepeats
<span class="token number">15480</span>         DISP <span class="token string">"ENTER the POSITION ( in mm ) for the sliding short setting # "</span><span class="token punctuation">;</span>Easet<span class="token punctuation">;</span>
<span class="token number">15490</span>         <span class="token keyword">INPUT</span> Mm
<span class="token number">15500</span>         Setting$<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">VAL$</span><span class="token punctuation">(</span>Mm<span class="token punctuation">)</span>
<span class="token number">15510</span>       <span class="token keyword">NEXT</span> Easet
<span class="token number">15520</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">15530</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">15540</span>   !
<span class="token number">15550</span>   DISP <span class="token string">".......  COMPUTING .........."</span>
<span class="token number">15560</span>   ALLOCATE Fileavg<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span><span class="token punctuation">,</span>Setavg<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span><span class="token punctuation">,</span>Connectavg<span class="token punctuation">(</span>Numconnects<span class="token punctuation">)</span>
<span class="token number">15570</span>   ALLOCATE Fileavg2<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span><span class="token punctuation">,</span>Setavg2<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span>
<span class="token number">15580</span>   ALLOCATE Difference<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span><span class="token punctuation">,</span>Var<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span>
<span class="token number">15590</span>   ALLOCATE Difference2<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span><span class="token punctuation">,</span>Variance2<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span>
<span class="token number">15600</span>   !
<span class="token number">15610</span>   <span class="token comment" spellcheck="true">!  IF THE VARIABLE DEVICE IS A SLIDING LOAD, CALL ROUTINE TO DO</span>
<span class="token number">15620</span>   <span class="token comment" spellcheck="true">!   SLIDING TERMS CALCULATIONS (CIRCLE FIT)</span>
<span class="token number">15630</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token operator">AND</span> Slidload <span class="token keyword">THEN</span> <span class="token keyword">CALL</span> Avgslidterm<span class="token punctuation">(</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">15640</span>   !
<span class="token number">15650</span>   !
<span class="token number">15660</span>   <span class="token comment" spellcheck="true">! IF THE VARIABLE DEVICE IS A 2-PORT OR SLIDING SHORT, get the average</span>
<span class="token number">15670</span>   <span class="token comment" spellcheck="true">!    of every setting measured for every variable:</span>
<span class="token number">15680</span>   <span class="token comment" spellcheck="true">!  For each setting, determine the # of files with data for the setting.</span>
<span class="token number">15690</span>   <span class="token comment" spellcheck="true">!    For each file that has data for the setting, determine which freqs</span>
<span class="token number">15700</span>   <span class="token comment" spellcheck="true">!    were measured.</span>
<span class="token number">15710</span>   <span class="token comment" spellcheck="true">!       For each frequency in the file, get the file's average for</span>
<span class="token number">15720</span>   <span class="token comment" spellcheck="true">!       the setting by averaging all the connects.</span>
<span class="token number">15730</span>   <span class="token comment" spellcheck="true">!    Determine the final setting average by averaging all file averages.</span>
<span class="token number">15740</span>   !
<span class="token number">15750</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> Slidshort <span class="token keyword">THEN</span>
<span class="token number">15760</span>     <span class="token keyword">IF</span> Variableatten <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Calculate for |S12| only</span>
<span class="token number">15770</span>       Startvar<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">15780</span>       Endvar<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">15790</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">15800</span>     <span class="token keyword">IF</span> Phaseshifter <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! Calculate for Arg(S12) only</span>
<span class="token number">15810</span>       Startvar<span class="token operator">=</span><span class="token number">4</span>
<span class="token number">15820</span>       Endvar<span class="token operator">=</span><span class="token number">4</span>
<span class="token number">15830</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">15840</span>     <span class="token keyword">IF</span> <span class="token operator">NOT</span> Variableatten <span class="token operator">AND</span> <span class="token operator">NOT</span> Phaseshifter <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Calc for all Sij,</span>
<span class="token number">15850</span>       Startvar<span class="token operator">=</span><span class="token number">1</span>                                   <span class="token comment" spellcheck="true">! or Gamma of sliding</span>
<span class="token number">15860</span>       Endvar<span class="token operator">=</span>Numvars                               <span class="token comment" spellcheck="true">! short</span>
<span class="token number">15870</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">15880</span>   !
<span class="token number">15890</span>     <span class="token keyword">FOR</span> Eavar<span class="token operator">=</span>Startvar <span class="token keyword">TO</span> Endvar    <span class="token comment" spellcheck="true">! Each variable for this device type</span>
<span class="token number">15900</span>       <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numrepeats     <span class="token comment" spellcheck="true">! Each variable setting measured</span>
<span class="token number">15910</span>         Filessp1<span class="token operator">=</span><span class="token number">0</span>   <span class="token comment" spellcheck="true">! Re-set # files on port 1</span>
<span class="token number">15920</span>         Filessp2<span class="token operator">=</span><span class="token number">0</span>   <span class="token comment" spellcheck="true">! Re-set # files on port 2</span>
<span class="token number">15930</span>         Filesthisset<span class="token operator">=</span>Filesperset<span class="token punctuation">(</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! # of files with the setting</span>
<span class="token number">15940</span>         <span class="token keyword">FOR</span> Portfile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Filesthisset    <span class="token comment" spellcheck="true">! Find # files port 1, # port 2</span>
<span class="token number">15950</span>           Fnum<span class="token operator">=</span>Filesperset<span class="token punctuation">(</span>Easet<span class="token punctuation">,</span>Portfile<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! # of this file</span>
<span class="token number">15960</span>           <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Fnum<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Filessp1<span class="token operator">=</span>Filessp1<span class="token operator">+</span><span class="token number">1</span>     <span class="token comment" spellcheck="true">! Port 1 file</span>
<span class="token number">15970</span>           <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Fnum<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Filessp2<span class="token operator">=</span>Filessp2<span class="token operator">+</span><span class="token number">1</span>     <span class="token comment" spellcheck="true">! Port 2 file</span>
<span class="token number">15980</span>         <span class="token keyword">NEXT</span> Portfile
<span class="token number">15990</span>         !
<span class="token number">16000</span>         <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Filesthisset       <span class="token comment" spellcheck="true">!  Each file with the setting</span>
<span class="token number">16010</span>           Filenum<span class="token operator">=</span>Filesperset<span class="token punctuation">(</span>Easet<span class="token punctuation">,</span>Eafile<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! File # of the file</span>
<span class="token number">16020</span>           <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs     <span class="token comment" spellcheck="true">! Each freq in file # Filenum</span>
<span class="token number">16030</span>             Usethisfile<span class="token operator">=</span><span class="token number">0</span>              <span class="token comment" spellcheck="true">! Check for freq # Eafreq in file</span>
<span class="token number">16040</span>             Check<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">16050</span>             <span class="token function">REPEAT</span>
<span class="token number">16060</span>               Check<span class="token operator">=</span>Check<span class="token operator">+</span><span class="token number">1</span> <span class="token comment" spellcheck="true">! Increment until find the file # or not</span>
<span class="token number">16070</span>               <span class="token keyword">IF</span> Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Check<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Filenum <span class="token keyword">THEN</span> Usethisfile<span class="token operator">=</span><span class="token number">1</span>  <span class="token comment" spellcheck="true">! This file contains freq # Eafreq.</span>
<span class="token number">16080</span>             <span class="token keyword">UNTIL</span> Check<span class="token operator">=</span>Numfiles <span class="token operator">OR</span> Usethisfile<span class="token operator">=</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! Until not found or matched ok</span>
<span class="token number">16090</span>             <span class="token keyword">IF</span> <span class="token operator">NOT</span> Usethisfile <span class="token keyword">THEN</span> <span class="token keyword">GOTO</span> Nextfreq    <span class="token comment" spellcheck="true">! THis file didn't have freq # Eafreq in it.</span>
<span class="token number">16100</span>             <span class="token keyword">FOR</span> Eaconnect<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numconnects    <span class="token comment" spellcheck="true">! Compute the setting average for this file,= average of all connects</span>
<span class="token number">16110</span>               <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Filenum<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Connectavg<span class="token punctuation">(</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">=</span>Datasp1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Pull data from port 1 array</span>
<span class="token number">16120</span>               <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Filenum<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Connectavg<span class="token punctuation">(</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">=</span>Datasp2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Pull data from port 2 array</span>
<span class="token number">16130</span>               !
<span class="token number">16140</span>               <span class="token keyword">IF</span> Phaseshifter <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Adjust data for dial settings</span>
<span class="token number">16150</span>                 <span class="token keyword">IF</span> Mags<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">360</span> <span class="token keyword">THEN</span> Temp<span class="token operator">=</span>Temp<span class="token operator">+</span><span class="token number">360</span>  <span class="token comment" spellcheck="true">! that are &gt;360</span>
<span class="token number">16160</span>                 <span class="token keyword">IF</span> Mags<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">720</span> <span class="token keyword">THEN</span> Temp<span class="token operator">=</span>Temp<span class="token operator">+</span><span class="token number">360</span>  <span class="token comment" spellcheck="true">! that are &gt;720</span>
<span class="token number">16170</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">16180</span>               !
<span class="token number">16190</span>               <span class="token keyword">IF</span> Eaconnect<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Sign<span class="token operator">=</span>Connectavg<span class="token punctuation">(</span>Eaconnect<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Keep first value to use to check for +- 180 degree discrepancy</span>
<span class="token number">16200</span>               <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Sign<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">100</span> <span class="token operator">OR</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Connectavg<span class="token punctuation">(</span>Eaconnect<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">100</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! This must be a phase variable</span>
<span class="token number">16210</span>                 <span class="token keyword">IF</span> <span class="token function">SGN</span><span class="token punctuation">(</span>Connectavg<span class="token punctuation">(</span>Eaconnect<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token function">SGN</span><span class="token punctuation">(</span>Sign<span class="token punctuation">)</span> <span class="token keyword">THEN</span> Connectavg<span class="token punctuation">(</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">=</span>Connectavg<span class="token punctuation">(</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">360</span><span class="token operator">*</span><span class="token function">SGN</span><span class="token punctuation">(</span>Sign<span class="token punctuation">)</span>
<span class="token number">16220</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">16230</span>               <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Fileavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Fileavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span>Connectavg<span class="token punctuation">(</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">/</span>Numconnects
<span class="token number">16240</span>               <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Fileavg2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Fileavg2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span>Connectavg<span class="token punctuation">(</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">/</span>Numconnects
<span class="token number">16250</span>             <span class="token keyword">NEXT</span> Eaconnect
<span class="token number">16260</span>               !
<span class="token number">16270</span>               <span class="token comment" spellcheck="true">! Compute the SUM of the differences squared of the file's average &amp; the connect averages</span>
<span class="token number">16280</span>             <span class="token keyword">FOR</span> Eaconnect<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numconnects
<span class="token number">16290</span>               <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">16300</span>                 Diffset<span class="token operator">=</span>Difference<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>Fileavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">-</span>Connectavg<span class="token punctuation">(</span>Eaconnect<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span>
<span class="token number">16310</span>                 Difference<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Diffset
<span class="token number">16320</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">16330</span>               <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span>
<span class="token number">16340</span>                 Diffset<span class="token operator">=</span>Difference2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>Fileavg2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">-</span>Connectavg<span class="token punctuation">(</span>Eaconnect<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span>
<span class="token number">16350</span>                 Difference2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Diffset
<span class="token number">16360</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">16370</span>             <span class="token keyword">NEXT</span> Eaconnect
<span class="token number">16380</span>               !
<span class="token number">16390</span>               <span class="token comment" spellcheck="true">! Compute the final average for a setting at this freq by averaging all the Fileavg(*) file averages, for each direction</span>
<span class="token number">16400</span>               !
<span class="token number">16410</span>             <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Setavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Setavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span>Fileavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">/</span>Filessp1
<span class="token number">16420</span>             <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Setavg2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Setavg2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span>Fileavg2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">/</span>Filessp2
<span class="token number">16430</span> Nextfreq<span class="token punctuation">:</span> <span class="token keyword">NEXT</span> Eafreq
<span class="token number">16440</span>         <span class="token keyword">NEXT</span> Eafile
<span class="token number">16450</span>        !
<span class="token number">16460</span>        <span class="token comment" spellcheck="true">! Difference(*) arrays have SUM (file avg-connect avg)^2</span>
<span class="token number">16470</span>        <span class="token comment" spellcheck="true">!  Compute final average, &amp; std devs.</span>
<span class="token number">16480</span>        !
<span class="token number">16490</span>         <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs        <span class="token comment" spellcheck="true">! Take Square root of diffs</span>
<span class="token number">16500</span>           <span class="token comment" spellcheck="true">! Check for +-180 deg phase diff</span>
<span class="token number">16510</span>           <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Setavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">100</span> <span class="token operator">OR</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Setavg2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">16520</span>             <span class="token keyword">IF</span> <span class="token function">SGN</span><span class="token punctuation">(</span>Setavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token function">SGN</span><span class="token punctuation">(</span>Setavg2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">16530</span>               Setavg2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Setavg2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">360</span><span class="token operator">*</span><span class="token function">SGN</span><span class="token punctuation">(</span>Setavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">16540</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">16550</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">16560</span>           !
<span class="token number">16570</span>           Setavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span>Setavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span>Setavg2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Filessp1<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>Filessp2<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! FINAL SETTING AVERAGE</span>
<span class="token number">16580</span>           !
<span class="token number">16590</span>           <span class="token comment" spellcheck="true">! Taking the square root makes this the std dev, not </span><span class="token string">"Variance"</span>
<span class="token number">16600</span>           Var<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Difference<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>Numconnects<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">16610</span>           Variance2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Difference2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>Numconnects<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">16620</span>           <span class="token comment" spellcheck="true">! Get final std dev as sum of squares of std dev each direction</span>
<span class="token number">16630</span>           Var<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Var<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Variance2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Filessp1<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>Filessp2<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">16640</span>         <span class="token keyword">NEXT</span> Eafreq
<span class="token number">16650</span>       <span class="token keyword">NEXT</span> Easet
<span class="token number">16660</span>     <span class="token keyword">NEXT</span> Eavar
<span class="token number">16670</span>     !
<span class="token number">16680</span>     <span class="token comment" spellcheck="true">! COMPUTE FINAL AVERAGES for phase shifter &amp; variable attenuator.</span>
<span class="token number">16690</span>     <span class="token comment" spellcheck="true">!    Final avg of jth setting (except for the 0 reference)= jth</span>
<span class="token number">16700</span>     <span class="token comment" spellcheck="true">!       setting - 0 reference.</span>
<span class="token number">16710</span>     <span class="token comment" spellcheck="true">! FINAL AVERAGE for a sliding short= the average for each setting.</span>
<span class="token number">16720</span>     !
<span class="token number">16730</span>     <span class="token keyword">FOR</span> Eavar<span class="token operator">=</span>Startvar <span class="token keyword">TO</span> Endvar    <span class="token comment" spellcheck="true">! Each variable for this device type</span>
<span class="token number">16740</span>       <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numrepeats     <span class="token comment" spellcheck="true">! Each setting</span>
<span class="token number">16750</span>         <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs    <span class="token comment" spellcheck="true">! Each freq</span>
<span class="token number">16760</span>           <span class="token keyword">IF</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">OR</span> Slidshort <span class="token keyword">THEN</span> Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Setavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span>
<span class="token number">16770</span>           <span class="token keyword">IF</span> Easet<span class="token operator">&gt;</span><span class="token number">1</span> <span class="token operator">AND</span> <span class="token operator">NOT</span> Slidshort <span class="token keyword">THEN</span> Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Setavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">-</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! Difference from 0 reference</span>
<span class="token number">16780</span>           <span class="token comment" spellcheck="true">! Keep phases for sliding short in +- 180 degree range</span>
<span class="token number">16790</span>           <span class="token keyword">IF</span> Slidshort <span class="token operator">AND</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">180</span> <span class="token keyword">THEN</span> Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token number">-360</span><span class="token operator">*</span><span class="token function">SGN</span><span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">16800</span>         <span class="token keyword">NEXT</span> Eafreq
<span class="token number">16810</span>       <span class="token keyword">NEXT</span> Easet
<span class="token number">16820</span>     <span class="token keyword">NEXT</span> Eavar
<span class="token number">16830</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>      <span class="token comment" spellcheck="true">! End of 2-port or sliding short calcs</span>
<span class="token number">16840</span>   !
<span class="token number">16850</span>   <span class="token comment" spellcheck="true">!         ********  COMPUTE UNCERTAINTIES  *****************</span>
<span class="token number">16860</span>   !
<span class="token number">16870</span>   ALLOCATE Pwrstd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Uncerts for 2-ports variable don't</span>
<span class="token number">16880</span>   Ps<span class="token operator">=</span>Phaseshifter                    <span class="token comment" spellcheck="true">! use Pwrstd values, or differences.</span>
<span class="token number">16890</span>   Va<span class="token operator">=</span>Variableatten
<span class="token number">16900</span>   Sl<span class="token operator">=</span>Slidload
<span class="token number">16910</span>   Ss<span class="token operator">=</span>Slidshort
<span class="token number">16920</span>   ALLOCATE R<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Dummy variable for residuals array</span>
<span class="token number">16930</span>   <span class="token keyword">CALL</span> Uncert<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numvars<span class="token punctuation">,</span>Ps<span class="token punctuation">,</span>Va<span class="token punctuation">,</span>Sl<span class="token punctuation">,</span>Ss<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Fileavg<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Var<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connector$<span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setavg<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>R<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">16940</span> SUBEND <span class="token comment" spellcheck="true">!...........Averagevariable...................</span>


<span class="token number">16950</span> Averagefixed<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Averagefixed<span class="token punctuation">(</span>C$<span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>R<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">16960</span>  <span class="token comment" spellcheck="true">! find final average of variables, and calculate uncertainties, for</span>
<span class="token number">16970</span>  <span class="token comment" spellcheck="true">!  fixed devices.</span>
<span class="token number">16980</span>  !
<span class="token number">16990</span>  <span class="token comment" spellcheck="true">! INPUT: Meastype$= </span><span class="token string">"1-port"</span><span class="token punctuation">,</span> <span class="token string">"2-port"</span><span class="token punctuation">,</span> <span class="token string">"Thermistor"</span> <span class="token operator">or</span> <span class="token string">"DryCal"</span><span class="token punctuation">,</span>
<span class="token number">17000</span>  <span class="token comment" spellcheck="true">!                    or </span><span class="token string">"2-portNR"</span>
<span class="token number">17010</span>  <span class="token comment" spellcheck="true">!        C$= type of connectors measured</span>
<span class="token number">17020</span>  <span class="token comment" spellcheck="true">!        Cfile$(*)= array of calibration files used to measure.</span>
<span class="token number">17030</span>  <span class="token comment" spellcheck="true">!        Sport(*)= port # (1 or 2) or direction (1=forward, 2=reverse)</span>
<span class="token number">17040</span>  <span class="token comment" spellcheck="true">!            of measurement for each file.</span>
<span class="token number">17050</span>  <span class="token comment" spellcheck="true">!        Datasp1(*),Datasp2(*)= data for port 1 or 2 for each file</span>
<span class="token number">17060</span>  <span class="token comment" spellcheck="true">!        Pwrstd(*)= data on standard used to calibrate for power,</span>
<span class="token number">17070</span>  <span class="token comment" spellcheck="true">!           if Meastype$ indicates a power device.</span>
<span class="token number">17080</span>  <span class="token comment" spellcheck="true">!        R(*)= uncertainties of gamma mag &amp; phase if device</span>
<span class="token number">17090</span>  <span class="token comment" spellcheck="true">!          was measured on direct comparison system:  Delta, Snist, Sc,</span>
<span class="token number">17100</span>  <span class="token comment" spellcheck="true">!          Total uncert, of |Gamma| &amp; Arg (Gamma), for each freq.</span>
<span class="token number">17110</span>  !
<span class="token number">17120</span>  <span class="token comment" spellcheck="true">! OUTPUT: Avgs(*) has averages for each freq, each variable:</span>
<span class="token number">17130</span>  <span class="token comment" spellcheck="true">!           </span><span class="token string">"1-port"</span><span class="token operator">=</span> |Gamma|<span class="token punctuation">,</span> Arg<span class="token punctuation">(</span>Gamma<span class="token punctuation">)</span><span class="token punctuation">,</span> difference |Gamma| port <span class="token number">1</span>
<span class="token number">17140</span>  <span class="token comment" spellcheck="true">!                   minus port 2, difference Arg port 1 minus port 2.</span>
<span class="token number">17150</span>  <span class="token comment" spellcheck="true">!           </span><span class="token string">"2-port"</span><span class="token punctuation">,</span> <span class="token string">"2-portNR"</span><span class="token operator">=</span> mags <span class="token operator">&amp;</span> args <span class="token function">of</span> S11<span class="token punctuation">,</span> S12<span class="token punctuation">,</span> S21<span class="token punctuation">,</span> S22
<span class="token number">17160</span>  <span class="token comment" spellcheck="true">!               (for </span><span class="token string">"2-port"</span><span class="token punctuation">,</span> S12<span class="token operator">=</span>S21<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">and</span> differences <span class="token function">of</span> S11 mag <span class="token operator">&amp;</span>
<span class="token number">17170</span>  <span class="token comment" spellcheck="true">!               arg &amp; S22 mag and arg forward-reverse.</span>
<span class="token number">17180</span>  <span class="token comment" spellcheck="true">!           </span><span class="token string">"Thermistor"</span><span class="token punctuation">,</span> <span class="token string">"DryCal"</span><span class="token operator">=</span> |Gamma|<span class="token punctuation">,</span> efficiency<span class="token punctuation">,</span> Kb<span class="token punctuation">,</span> Pdc<span class="token punctuation">,</span> Pinc<span class="token punctuation">,</span>
<span class="token number">17190</span>  <span class="token comment" spellcheck="true">!                 Arg(Gamma), and difference mag Gamma port 1-2 &amp; diff</span>
<span class="token number">17200</span>  <span class="token comment" spellcheck="true">!                 efficiency port 1 - 2.</span>
<span class="token number">17210</span>  <span class="token comment" spellcheck="true">!         Sc(*)= short term (connector) uncertainty for data in Avgs(*)</span>
<span class="token number">17220</span>  <span class="token comment" spellcheck="true">!              (except for the difference calcs)</span>
<span class="token number">17230</span>  <span class="token comment" spellcheck="true">!         Snist(*)= long term (calib) uncertainty for data (except diffs)</span>
<span class="token number">17240</span>  <span class="token comment" spellcheck="true">!         Syst(*)= systematic uncertainty for data (except for diffs)</span>
<span class="token number">17250</span>  <span class="token comment" spellcheck="true">!         Totuncert(*)= total uncertainty for data (except for diffs)</span>
<span class="token number">17260</span>  !
<span class="token number">17270</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">17280</span>   <span class="token function">DEG</span>
<span class="token number">17290</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">17300</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">17310</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$<span class="token punctuation">,</span>Devicedescript$<span class="token punctuation">,</span>Oneportonly
<span class="token number">17320</span>   <span class="token comment" spellcheck="true">! Local vars:  Numvars= # of variables to calculate for (varies by</span>
<span class="token number">17330</span>   <span class="token comment" spellcheck="true">!       what Meastype$ is).  Connectavg(*)= avg of repeats= avg for</span>
<span class="token number">17340</span>   <span class="token comment" spellcheck="true">!       each connect.  Fileavg(*)= avg of connects= avg for each file.</span>
<span class="token number">17350</span>   <span class="token comment" spellcheck="true">!       Avgs1(*)= averages for port 1 data. Avgs2(*)= avgs for port 2.</span>
<span class="token number">17360</span>   <span class="token comment" spellcheck="true">!       Difference(*) &amp; Variance(*) used for Sc &amp; uncert calcs.</span>
<span class="token number">17370</span>   !
<span class="token number">17380</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Numvars<span class="token operator">=</span><span class="token number">2</span>   <span class="token comment" spellcheck="true">! Gamma mag &amp; phase</span>
<span class="token number">17381</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Numvars<span class="token operator">=</span><span class="token number">8</span>   <span class="token comment" spellcheck="true">! mag &amp; phase of S11,S12,S21,S22</span>
<span class="token number">17382</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"T"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Numvars<span class="token operator">=</span><span class="token number">6</span>  <span class="token comment" spellcheck="true">! Power vars</span>
<span class="token number">17410</span>   Numfiles<span class="token operator">=</span><span class="token function">SIZE</span><span class="token punctuation">(</span>Sport<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! TOTAL  # of files read in: assume an = # were measured on each port</span>
<span class="token number">17420</span>   ALLOCATE Avgs1<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs2<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span><span class="token punctuation">,</span>Connectavg<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span><span class="token punctuation">,</span>Fileavg<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span>
<span class="token number">17430</span>   ALLOCATE Difference<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span><span class="token punctuation">,</span>Variance<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span><span class="token punctuation">,</span>D<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! D(*)= dummy pass variable to SUB Uncert CALL</span>
<span class="token number">17440</span>   !
<span class="token number">17450</span>   <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs
<span class="token number">17460</span>     Firstfile<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! First file read for freq # Eafreq</span>
<span class="token number">17470</span>     <span class="token keyword">FOR</span> Eavar<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numvars    <span class="token comment" spellcheck="true">! Each variable for this device type</span>
<span class="token number">17480</span>        <span class="token comment" spellcheck="true">! Sign is used to check sign of first angle read in &amp; correct for</span>
<span class="token number">17490</span>        <span class="token comment" spellcheck="true">!  +-180 degree problem in rest of angles read in.</span>
<span class="token number">17502</span>        !
<span class="token number">17530</span>       Filesthisfreq<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! # of files for this freq</span>
<span class="token number">17540</span>       <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Filesthisfreq         <span class="token comment" spellcheck="true">! Each file, freq # Eafreq</span>
<span class="token number">17550</span>         <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Sign<span class="token operator">=</span>Datasp1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span>
<span class="token number">17551</span>         <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Sign<span class="token operator">=</span>Datasp2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eafile<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span>
<span class="token number">17552</span>        !
<span class="token number">17554</span>         Filenum<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eafile<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! # of the file</span>
<span class="token number">17560</span>         <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Cfile$<span class="token punctuation">(</span>Filenum<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"N"</span><span class="token punctuation">)</span> <span class="token operator">AND</span> Numconnects<span class="token operator">=</span><span class="token number">6</span> <span class="token keyword">THEN</span>
<span class="token number">17570</span>           Allconnects<span class="token operator">=</span><span class="token number">3</span><span class="token comment" spellcheck="true">! Direct comparison system has 6, others 3</span>
<span class="token number">17580</span>         <span class="token keyword">ELSE</span>
<span class="token number">17590</span>           Allconnects<span class="token operator">=</span>Numconnects
<span class="token number">17600</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">17610</span>         <span class="token keyword">FOR</span> Eaconnect<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Allconnects   <span class="token comment" spellcheck="true">! Each connect: find file avg</span>
<span class="token number">17620</span>           <span class="token keyword">FOR</span> Earepeat<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numrepeats   <span class="token comment" spellcheck="true">! Each repeat: find connect avg</span>
<span class="token number">17630</span>             <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Filenum<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Temp<span class="token operator">=</span>Datasp1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Earepeat<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Pull data from port 1 array</span>
<span class="token number">17640</span>             <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Filenum<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Temp<span class="token operator">=</span>Datasp2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Earepeat<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Pull data from port 2 array</span>
<span class="token number">17650</span>             Phasecheck<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">17654</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token operator">AND</span> Eavar<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Phasecheck<span class="token operator">=</span><span class="token number">42</span>
<span class="token number">17655</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token punctuation">(</span>Eavar<span class="token operator">=</span><span class="token number">2</span> <span class="token operator">OR</span> Eavar<span class="token operator">=</span><span class="token number">4</span> <span class="token operator">OR</span> Eavar<span class="token operator">=</span><span class="token number">6</span> <span class="token operator">OR</span> Eavar<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Phasecheck<span class="token operator">=</span><span class="token number">42</span>
<span class="token number">17656</span>             <span class="token keyword">IF</span> <span class="token punctuation">(</span><span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"T"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">AND</span> Eavar<span class="token operator">=</span><span class="token number">6</span> <span class="token keyword">THEN</span> Phasecheck<span class="token operator">=</span><span class="token number">42</span>
<span class="token number">17657</span>             <span class="token keyword">IF</span> Phasecheck<span class="token operator">=</span><span class="token number">42</span> <span class="token keyword">THEN</span>
<span class="token number">17661</span>               <span class="token keyword">IF</span> <span class="token function">SGN</span><span class="token punctuation">(</span>Temp<span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token function">SGN</span><span class="token punctuation">(</span>Sign<span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Temp<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">90</span> <span class="token keyword">THEN</span> Temp<span class="token operator">=</span>Temp<span class="token operator">+</span><span class="token number">360</span><span class="token operator">*</span><span class="token function">SGN</span><span class="token punctuation">(</span>Sign<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Correct for 180 degree discrepancy</span>
<span class="token number">17670</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">17680</span>        <span class="token comment" spellcheck="true">!  Compute average of each connect for file # Filenum by averaging</span>
<span class="token number">17690</span>        <span class="token comment" spellcheck="true">!     measurements for each repeat of a connect.</span>
<span class="token number">17700</span>             Connectavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Connectavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span>Temp<span class="token operator">/</span>Numrepeats
<span class="token number">17701</span>             <span class="token keyword">IF</span> Eaconnect<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Signc<span class="token operator">=</span>Connectavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Use this to correct for phase problems in connectavg(*)</span>
<span class="token number">17710</span>           <span class="token keyword">NEXT</span> Earepeat
<span class="token number">17720</span>        <span class="token comment" spellcheck="true">! Compute final average for the file # Filenum by averaging</span>
<span class="token number">17730</span>        <span class="token comment" spellcheck="true">!   all the connects measured for the file.</span>
<span class="token number">17735</span>           <span class="token keyword">IF</span> Phasecheck<span class="token operator">=</span><span class="token number">42</span> <span class="token operator">AND</span> Eaconnect<span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>        <span class="token comment" spellcheck="true">! Look for phase problems</span>
<span class="token number">17736</span>             Tempca<span class="token operator">=</span>Connectavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span>
<span class="token number">17739</span>             <span class="token keyword">IF</span> <span class="token function">SGN</span><span class="token punctuation">(</span>Tempca<span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token function">SGN</span><span class="token punctuation">(</span>Signc<span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Tempca<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">90</span> <span class="token keyword">THEN</span>
<span class="token number">17740</span>               Connectavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Connectavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">360</span><span class="token operator">*</span><span class="token function">SGN</span><span class="token punctuation">(</span>Signc<span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! Correct phase problem</span>
<span class="token number">17741</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">17742</span>        !
<span class="token number">17743</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">17744</span>           Fileavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Fileavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span>Connectavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">/</span>Allconnects
<span class="token number">17750</span>         <span class="token keyword">NEXT</span> Eaconnect
<span class="token number">17760</span>        !
<span class="token number">17770</span>        <span class="token comment" spellcheck="true">! COMPUTE uncertainty for the difference between each file's</span>
<span class="token number">17780</span>        <span class="token comment" spellcheck="true">!    connect averages, and the file's final average.   Square</span>
<span class="token number">17790</span>        <span class="token comment" spellcheck="true">!    the difference.</span>
<span class="token number">17795</span>        !
<span class="token number">17800</span>         <span class="token keyword">FOR</span> Eaconnect<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Allconnects
<span class="token number">17810</span>           Difference<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Difference<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>Connectavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">-</span>Fileavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span>
<span class="token number">17820</span>         <span class="token keyword">NEXT</span> Eaconnect
<span class="token number">17830</span>        <span class="token comment" spellcheck="true">! Variance=SUM[(avg each connect of file-file avg)^2/(#connects-1)]</span>
<span class="token number">17840</span>         Variance<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Difference<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>Allconnects<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">17850</span>        !
<span class="token number">17860</span>        <span class="token comment" spellcheck="true">! Find the FINAL average for EACH DIRECTION (port) for the freq</span>
<span class="token number">17870</span>        <span class="token comment" spellcheck="true">!   # Eafreq.</span>
<span class="token number">17880</span>         <span class="token keyword">IF</span> Filesthisfreq<span class="token operator">&gt;</span><span class="token number">1</span> <span class="token operator">AND</span> Oneportonly <span class="token keyword">THEN</span> Divbyport<span class="token operator">=</span>Filesthisfreq <span class="token comment" spellcheck="true">!direct comp system measures on one port only</span>
<span class="token number">17890</span>         <span class="token keyword">IF</span> Filesthisfreq<span class="token operator">&gt;</span><span class="token number">1</span> <span class="token operator">AND</span> <span class="token function">MAX</span><span class="token punctuation">(</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token function">MIN</span><span class="token punctuation">(</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Divbyport<span class="token operator">=</span>Filesthisfreq<span class="token operator">/</span><span class="token number">2</span>
<span class="token number">17900</span>         <span class="token keyword">IF</span> Filesthisfreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Divbyport<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">17910</span>         <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Filenum<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span>Fileavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">/</span>Divbyport
<span class="token number">17920</span>         <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Filenum<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span>Fileavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">/</span>Divbyport
<span class="token number">17930</span>        !
<span class="token number">17940</span>        <span class="token comment" spellcheck="true">!  If this variable is &gt;180, assume it is a phase meas &amp; check</span>
<span class="token number">17950</span>        <span class="token comment" spellcheck="true">!   that it stays in the + to - 180 degree range.</span>
<span class="token number">17960</span>         <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">180</span> <span class="token keyword">THEN</span> Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token number">-360</span><span class="token operator">*</span><span class="token function">SGN</span><span class="token punctuation">(</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">17970</span>         <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">180</span> <span class="token keyword">THEN</span> Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token number">-360</span><span class="token operator">*</span><span class="token function">SGN</span><span class="token punctuation">(</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">17980</span>       <span class="token keyword">NEXT</span> Eafile
<span class="token number">17990</span>        !
<span class="token number">18000</span>        <span class="token comment" spellcheck="true">!  Check for 180 degree discrepancy between port 1 &amp; 2 meas's.</span>
<span class="token number">18010</span>        <span class="token comment" spellcheck="true">! Combine the averages for each port (direction) into the Avgs(*)</span>
<span class="token number">18020</span>        <span class="token comment" spellcheck="true">!  array.   If the variable is a phase, make sure it stays in the</span>
<span class="token number">18030</span>        <span class="token comment" spellcheck="true">!   + to - 180 degree range</span>
<span class="token number">18031</span>    <span class="token comment" spellcheck="true">!    PRINT Avgs2(Eafreq,Eavar)</span>
<span class="token number">18040</span>       <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">90</span> <span class="token operator">AND</span> <span class="token function">SGN</span><span class="token punctuation">(</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token function">SGN</span><span class="token punctuation">(</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>      <span class="token comment" spellcheck="true">! There is 180 degree discrepancy</span>
<span class="token number">18041</span>         <span class="token keyword">IF</span> Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">360</span>
<span class="token number">18042</span>         <span class="token keyword">IF</span> Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">360</span>
<span class="token number">18050</span>        <span class="token comment" spellcheck="true">!IF Avgs2(Eafreq,Eavar)&lt;&gt;0 THEN Avgs2(Eafreq,Eavar)=Avgs2(Eafreq,Eavar)+360*SGN(Avgs1(Eafreq,Eavar))</span>
<span class="token number">18060</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">18070</span>       !
<span class="token number">18080</span>       <span class="token comment" spellcheck="true">! Take average of port 1+port 2 (forward &amp; reverse) for FINAL avg.</span>
<span class="token number">18090</span>       <span class="token keyword">IF</span> Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator">OR</span> Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> Finaldiv<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">18100</span>       <span class="token keyword">IF</span> Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token operator">AND</span> Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Finaldiv<span class="token operator">=</span><span class="token number">2</span>
<span class="token number">18110</span>       Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>Finaldiv
<span class="token number">18120</span>       <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">180</span> <span class="token keyword">THEN</span> Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token number">-360</span><span class="token operator">*</span><span class="token function">SGN</span><span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Keep in + to - 180 degree range</span>
<span class="token number">18128</span>       <span class="token keyword">IF</span> Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">180</span> <span class="token keyword">THEN</span> Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token number">-360</span>
<span class="token number">18129</span>       <span class="token keyword">IF</span> Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">180</span> <span class="token keyword">THEN</span> Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token number">-360</span>
<span class="token number">18134</span>     <span class="token keyword">NEXT</span> Eavar     <span class="token comment" spellcheck="true">! Next variable</span>
<span class="token number">18140</span>     !
<span class="token number">18150</span>     <span class="token comment" spellcheck="true">! Compute difference of port 1- port 2 for Gammas or |S11|,S12,|S22|</span>
<span class="token number">18160</span>     <span class="token comment" spellcheck="true">!    Differences are plotted only, not used for reports.</span>
<span class="token number">18170</span>     !
<span class="token number">18180</span>     Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Numvars<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! |S11|,|Gamma|</span>
<span class="token number">18190</span>     <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Numvars<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Arg(Gamma) for 1-port</span>
<span class="token number">18200</span>     <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"T"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! Power differences</span>
<span class="token number">18210</span>       Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Numvars<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">!Efficiency</span>
<span class="token number">18220</span>       Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Numvars<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">-</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! ArgGamma</span>
<span class="token number">18230</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">18240</span>     <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Compute diffs for S22 &amp; S12, 2-port</span>
<span class="token number">18250</span>       <span class="token keyword">IF</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! If non reciprocal, see if want S12 or S21</span>
<span class="token number">18260</span>         <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"NR"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">18270</span>           <span class="token keyword">INPUT</span> <span class="token string">"Enter a 1 to compute the difference of S12 side to side, or a 0 for S21"</span><span class="token punctuation">,</span>Scol
<span class="token number">18280</span>           DISP <span class="token string">"... COMPUTING ..."</span>
<span class="token number">18290</span>           <span class="token keyword">IF</span> Scol <span class="token keyword">THEN</span>
<span class="token number">18300</span>             Scol<span class="token operator">=</span><span class="token number">3</span>   <span class="token comment" spellcheck="true">! S12</span>
<span class="token number">18310</span>           <span class="token keyword">ELSE</span>
<span class="token number">18320</span>             Scol<span class="token operator">=</span><span class="token number">5</span>   <span class="token comment" spellcheck="true">! S21</span>
<span class="token number">18330</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">18340</span>         <span class="token keyword">ELSE</span>
<span class="token number">18350</span>           Scol<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">18360</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">18370</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">18380</span>       Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Numvars<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Scol<span class="token punctuation">)</span><span class="token operator">-</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Scol<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! |S12| or |S21|</span>
<span class="token number">18390</span>       Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Numvars<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">-</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! |S22|</span>
<span class="token number">18400</span>       Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Numvars<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Scol<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>Avgs2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Scol<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Arg(S12) or Arg(S21)</span>
<span class="token number">18410</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">18420</span>   <span class="token keyword">NEXT</span> Eafreq       <span class="token comment" spellcheck="true">! Next freq</span>
<span class="token number">18430</span>   !
<span class="token number">18440</span>   <span class="token comment" spellcheck="true">!         ********  COMPUTE UNCERTAINTIES  *****************</span>
<span class="token number">18450</span>   !
<span class="token number">18460</span>   N<span class="token operator">=</span>Numvars
<span class="token number">18470</span>   <span class="token keyword">CALL</span> Uncert<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>N<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>D<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectavg<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Variance<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Difference<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>C$<span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Fileavg<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>R<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">18480</span> SUBEND <span class="token comment" spellcheck="true">!...........Averagefixed......................</span>


<span class="token number">18490</span> Sc<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Sc<span class="token punctuation">(</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Ps<span class="token punctuation">,</span>Va<span class="token punctuation">,</span>Ss<span class="token punctuation">,</span>Numvars<span class="token punctuation">,</span>Connectavg<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Variance<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Difference<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">18500</span>  <span class="token comment" spellcheck="true">! Compute short term (connector) uncertainty Sc</span>
<span class="token number">18510</span>  !
<span class="token number">18520</span>  <span class="token comment" spellcheck="true">! IN COM:Meastype$= </span><span class="token string">"1-port"</span><span class="token punctuation">,</span> <span class="token string">"2-port"</span><span class="token punctuation">,</span> <span class="token string">"Thermistor"</span><span class="token punctuation">,</span> <span class="token string">"DryCal"</span><span class="token punctuation">,</span><span class="token string">"2-portNR"</span>
<span class="token number">18530</span>  <span class="token comment" spellcheck="true">! INPUT: Sport(*)= which port device was measured on for each file</span>
<span class="token number">18540</span>  <span class="token comment" spellcheck="true">!        Avgs(*)= averages for each frequency for each variable (e.g.</span>
<span class="token number">18550</span>  <span class="token comment" spellcheck="true">!                of |Gamma| and Arg(Gamma) if Meastype$= </span><span class="token string">"1-port"</span><span class="token punctuation">)</span>
<span class="token number">18560</span>  <span class="token comment" spellcheck="true">!        Ps=1 if device is a phase shifter</span>
<span class="token number">18570</span>  <span class="token comment" spellcheck="true">!        Va=1 if device is a variable attenuator</span>
<span class="token number">18580</span>  <span class="token comment" spellcheck="true">!        Ss=1 if device is a sliding short</span>
<span class="token number">18590</span>  <span class="token comment" spellcheck="true">!        Numvars= # of variables for this device type.</span>
<span class="token number">18600</span>  <span class="token comment" spellcheck="true">!        Connectavg(*)= averages for each freq, file, &amp; connect for each</span>
<span class="token number">18610</span>  <span class="token comment" spellcheck="true">!                  variable.</span>
<span class="token number">18620</span>  <span class="token comment" spellcheck="true">!        Variance(*)= SUM[(Connectavg-Fileavg)^2]/(# connects-1)]</span>
<span class="token number">18630</span>  <span class="token comment" spellcheck="true">!                Where Fileavg= average for each freq,file for each var.</span>
<span class="token number">18640</span>  <span class="token comment" spellcheck="true">!        Difference(*)= SUM[(Connectavg-Fileavg)^2]</span>
<span class="token number">18650</span>  !
<span class="token number">18660</span>  <span class="token comment" spellcheck="true">! OUTPUT: Sc(*) has short term connector uncert for each freq &amp; variable</span>
<span class="token number">18670</span>  <span class="token comment" spellcheck="true">!       If device is a phase shifter, Sc for Arg(S12) only is stored</span>
<span class="token number">18680</span>  <span class="token comment" spellcheck="true">!       If device is a variable attenuator, Sc for |S12| only is stored</span>
<span class="token number">18690</span>  !
<span class="token number">18700</span>  <span class="token comment" spellcheck="true">! NOTE: FOR SLIDING TERMINATIONS, Sc IS CALCULATED IN SUB Avgslidterm.</span>
<span class="token number">18710</span>  !
<span class="token number">18720</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">18730</span>   <span class="token function">DEG</span>
<span class="token number">18740</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">18750</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">18760</span>   !
<span class="token number">18770</span>   <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token function">SIZE</span><span class="token punctuation">(</span>Sport<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! See if an uneven # of ports used:</span>
<span class="token number">18780</span>     <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>      <span class="token comment" spellcheck="true">! If # on port 1 &lt;&gt; # on port 2, then</span>
<span class="token number">18790</span>       Numport1<span class="token operator">=</span>Numport1<span class="token operator">+</span><span class="token number">1</span>        <span class="token comment" spellcheck="true">! direct comparison system &amp; another</span>
<span class="token number">18800</span>     <span class="token keyword">ELSE</span>                         <span class="token comment" spellcheck="true">! system were used, &amp; # of connects for</span>
<span class="token number">18810</span>       Numport2<span class="token operator">=</span>Numport2<span class="token operator">+</span><span class="token number">1</span>        <span class="token comment" spellcheck="true">! the other system won't be correct.</span>
<span class="token number">18820</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">18830</span>   <span class="token keyword">NEXT</span> Eafile
<span class="token number">18840</span>   <span class="token keyword">IF</span> Numport1<span class="token operator">&lt;&gt;</span>Numport2 <span class="token operator">AND</span> Numport2<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Dircompused<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">18850</span>   !
<span class="token number">18860</span>   <span class="token keyword">IF</span> Ps <span class="token operator">OR</span> Va <span class="token operator">OR</span> Ss <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! Store Uncertainties of the settings</span>
<span class="token number">18870</span>     <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs
<span class="token number">18880</span>       <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numrepeats
<span class="token number">18890</span>         <span class="token keyword">IF</span> Ps <span class="token keyword">THEN</span> Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span>Variance<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">18900</span>         <span class="token keyword">IF</span> Va <span class="token keyword">THEN</span> Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span>Variance<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">18910</span>         <span class="token keyword">IF</span> Ss <span class="token keyword">THEN</span>
<span class="token number">18920</span>           Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Variance<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! For mag gamma</span>
<span class="token number">18930</span>           Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Variance<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! for arg gamma</span>
<span class="token number">18940</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">18950</span>       <span class="token keyword">NEXT</span> Easet
<span class="token number">18960</span>     <span class="token keyword">NEXT</span> Eafreq
<span class="token number">18970</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">18980</span>   !
<span class="token number">18990</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> Ps <span class="token operator">AND</span> <span class="token operator">NOT</span> Va <span class="token operator">AND</span> <span class="token operator">NOT</span> Ss <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! Not a variable atten or phase shifter or sliding short</span>
<span class="token number">19000</span>     <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs
<span class="token number">19010</span>       Numfileseafreq<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! # of files for this frequency</span>
<span class="token number">19020</span>       <span class="token keyword">FOR</span> Eavar<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numvars<span class="token comment" spellcheck="true">! Each variable</span>
<span class="token number">19030</span>         <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! For each file for this freq</span>
<span class="token number">19040</span>           Filenum<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eafile<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! File # for file # Eafile</span>
<span class="token number">19050</span>         !
<span class="token number">19060</span>         <span class="token comment" spellcheck="true">!  IF DEVICE IS A &gt; LOSS 2-PORT, NEED TO RECALC THE VARIANCE.</span>
<span class="token number">19070</span>         <span class="token comment" spellcheck="true">!  If device is a high loss 2-port, treat each measurement</span>
<span class="token number">19080</span>         <span class="token comment" spellcheck="true">!   separately instead of averaging each port (i.e. treat</span>
<span class="token number">19090</span>         <span class="token comment" spellcheck="true">!   # of connects as 6 instead of 3).</span>
<span class="token number">19100</span>         <span class="token comment" spellcheck="true">! Variance for &gt; loss= SUM(connect avg ea file- FINAL avg)^2, and</span>
<span class="token number">19110</span>         <span class="token comment" spellcheck="true">!            divide by (# connects*2) - 1</span>
<span class="token number">19120</span>           <span class="token keyword">IF</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Eavar<span class="token operator">=</span><span class="token number">3</span> <span class="token operator">OR</span> Eavar<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">AND</span> Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Eavar<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token punctuation">(</span>Eavar<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">AND</span> Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">19130</span>             <span class="token keyword">IF</span> Dircompused<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">AND</span> Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">19140</span>               Allconnects<span class="token operator">=</span><span class="token number">3</span> <span class="token comment" spellcheck="true">! Freqs &lt;1 done on System I, w/3 connects</span>
<span class="token number">19150</span>             <span class="token keyword">ELSE</span>
<span class="token number">19160</span>               Allconnects<span class="token operator">=</span>Numconnects
<span class="token number">19170</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">19180</span>             <span class="token keyword">FOR</span> Eaconnect<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Allconnects<span class="token comment" spellcheck="true">! Compute Sc^2</span>
<span class="token number">19190</span>             !
<span class="token number">19200</span>               Sign<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Make sure connect's phase &amp; avg phase in same quadrant before taking the difference (if a phase variable)</span>
<span class="token number">19210</span>               <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Sign<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">100</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! This must be a phase variable</span>
<span class="token number">19220</span>                 <span class="token keyword">IF</span> <span class="token function">SGN</span><span class="token punctuation">(</span>Connectavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token function">SGN</span><span class="token punctuation">(</span>Sign<span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Connectavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">100</span> <span class="token keyword">THEN</span>
<span class="token number">19230</span>                   Connectavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Connectavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">360</span><span class="token operator">*</span><span class="token function">SGN</span><span class="token punctuation">(</span>Sign<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Resolve +-180 problem</span>
<span class="token number">19240</span>                 <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">19250</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">19260</span>               !
<span class="token number">19270</span>               Vardiff<span class="token operator">=</span><span class="token punctuation">(</span>Connectavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">-</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span>
<span class="token number">19280</span>               Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span>Vardiff<span class="token operator">/</span><span class="token punctuation">(</span>Allconnects<span class="token operator">*</span><span class="token number">2</span><span class="token number">-1</span><span class="token punctuation">)</span>
<span class="token number">19290</span>             <span class="token keyword">NEXT</span> Eaconnect
<span class="token number">19300</span>           !
<span class="token number">19310</span>           <span class="token keyword">ELSE</span> <span class="token comment" spellcheck="true">! NOT A HIGH-LOSS DEVICE:  compute Sc^2= Variance/(# files)</span>
<span class="token number">19320</span>             Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">+</span>Variance<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">/</span>Numfileseafreq
<span class="token number">19330</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">19340</span>         <span class="token keyword">NEXT</span> Eafile
<span class="token number">19350</span>         Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">19360</span>       !
<span class="token number">19361</span>    !
<span class="token number">19363</span>    <span class="token comment" spellcheck="true">!  The following 5 lines were commented out to keep the uncert in numeric instead of percentage form.   !RAG</span>
<span class="token number">19370</span>    <span class="token comment" spellcheck="true">!     IF POS(Meastype$,</span><span class="token string">"T"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Power device</span>
<span class="token number">19380</span>    <span class="token comment" spellcheck="true">!       IF Eavar&lt;&gt;1 AND Eavar&lt;&gt;6 THEN ! Change Sc to % (except Gamma's)</span>
<span class="token number">19390</span>    <span class="token comment" spellcheck="true">!         IF Avgs(Eafreq,1,Eavar)&lt;&gt;0 THEN Sc(Eafreq,1,Eavar)=100*(Sc(Eafreq,1,Eavar)/Avgs(Eafreq,1,Eavar))</span>
<span class="token number">19400</span>    <span class="token comment" spellcheck="true">!       END IF</span>
<span class="token number">19410</span>    <span class="token comment" spellcheck="true">!     END IF</span>
<span class="token number">19420</span>       <span class="token keyword">NEXT</span> Eavar
<span class="token number">19430</span>     <span class="token keyword">NEXT</span> Eafreq
<span class="token number">19440</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">19450</span> SUBEND   <span class="token comment" spellcheck="true">!................Sc...............</span>


<span class="token number">19460</span> Snist<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Snist<span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span>Numsets<span class="token punctuation">,</span>Connector$<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numvars<span class="token punctuation">,</span>Ps<span class="token punctuation">,</span>Va<span class="token punctuation">,</span>Sl<span class="token punctuation">,</span>Ss<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">19470</span> <span class="token comment" spellcheck="true">! Compute Snist for the device.   TYPE A</span>
<span class="token number">19480</span> !
<span class="token number">19490</span> <span class="token comment" spellcheck="true">! INPUT: Meastype$=</span><span class="token string">"1-port"</span><span class="token punctuation">,</span><span class="token string">"2-port"</span><span class="token punctuation">,</span><span class="token string">"2-portNR"</span><span class="token punctuation">,</span><span class="token string">"Thermistor"</span> <span class="token operator">or</span> <span class="token string">"DryCal"</span>
<span class="token number">19500</span> <span class="token comment" spellcheck="true">!        Numsets= # of settings measured (variable device). =1 if device</span>
<span class="token number">19510</span> <span class="token comment" spellcheck="true">!           is fixed.</span>
<span class="token number">19520</span> <span class="token comment" spellcheck="true">!        Connector$= type of connectors</span>
<span class="token number">19530</span> <span class="token comment" spellcheck="true">!        Avgs(*)= final averages for each freq, each variable.</span>
<span class="token number">19540</span> <span class="token comment" spellcheck="true">!    Numvars= # of variables for the device</span>
<span class="token number">19550</span> <span class="token comment" spellcheck="true">!      =1 for 1-ports: mag &amp; phase Gamma</span>
<span class="token number">19560</span> <span class="token comment" spellcheck="true">!      =8 for 2-ports: mag &amp; phase S11,S12,S21,S22</span>
<span class="token number">19570</span> <span class="token comment" spellcheck="true">!      =6 for Thermistor/DryCal: |Gamma|,efficiency,Kb,Pdc,Pinc,Arg(Gamma)</span>
<span class="token number">19580</span> <span class="token comment" spellcheck="true">!  Ps=1 if phase shifter</span>
<span class="token number">19590</span> <span class="token comment" spellcheck="true">!  Va= 1 if variable atten</span>
<span class="token number">19600</span> <span class="token comment" spellcheck="true">!  Sl=1 if sliding load</span>
<span class="token number">19610</span> <span class="token comment" spellcheck="true">!  Ss= 1 if sliding short</span>
<span class="token number">19620</span> !
<span class="token number">19630</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">19640</span>   <span class="token function">DEG</span>
<span class="token number">19650</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">19660</span> !
<span class="token number">19670</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"T"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Powerdevice<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">19680</span>         <span class="token comment" spellcheck="true">! Powerdevices= Thermistor or DryCal</span>
<span class="token number">19690</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> Ps <span class="token operator">AND</span> <span class="token operator">NOT</span> Va <span class="token operator">AND</span> <span class="token operator">NOT</span> Sl <span class="token operator">AND</span> <span class="token operator">NOT</span> Ss <span class="token keyword">THEN</span>
<span class="token number">19700</span>     Startvar<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">19710</span>     Endvar<span class="token operator">=</span>Numvars
<span class="token number">19720</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">19730</span>   <span class="token keyword">IF</span> Numvars<span class="token operator">=</span><span class="token number">10</span> <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! UNCERT CALCS ONLY, FOR GAMMA</span>
<span class="token number">19740</span>     Startvar<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">19750</span>     Endvar<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">19760</span>     Numsets<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">19770</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">19780</span>   <span class="token keyword">IF</span> Numvars<span class="token operator">=</span><span class="token number">20</span> <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! UNCERT CALCS ONLY, FOR EFFICIENCY</span>
<span class="token number">19790</span>     Startvar<span class="token operator">=</span><span class="token number">2</span>
<span class="token number">19800</span>     Endvar<span class="token operator">=</span><span class="token number">2</span>
<span class="token number">19810</span>     Numsets<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">19820</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">19830</span>   <span class="token keyword">IF</span> Numvars<span class="token operator">=</span><span class="token number">30</span> <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! UNCERT CALCS ONLY, FOR S12</span>
<span class="token number">19840</span>     Startvar<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">19850</span>     Endvar<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">19860</span>     Numsets<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">19870</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">19880</span>   !
<span class="token number">19890</span>   <span class="token keyword">IF</span> Sl <span class="token operator">OR</span> Ss <span class="token keyword">THEN</span>             <span class="token comment" spellcheck="true">! Calc for Gamma (S11 or S22) only</span>
<span class="token number">19900</span>     Startvar<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">19910</span>     Endvar<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">19920</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">19930</span>   <span class="token keyword">IF</span> Ps <span class="token operator">OR</span> Va <span class="token keyword">THEN</span>             <span class="token comment" spellcheck="true">! Calculate for S12 only</span>
<span class="token number">19940</span>     Startvar<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">19950</span>     Endvar<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">19960</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">19970</span>         !
<span class="token number">19980</span>   <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs     <span class="token comment" spellcheck="true">! Each frequency</span>
<span class="token number">19990</span>     Frequency<span class="token operator">=</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span>
<span class="token number">20000</span>     <span class="token keyword">FOR</span> Eavar<span class="token operator">=</span>Startvar <span class="token keyword">TO</span> Endvar           <span class="token comment" spellcheck="true">! Each variable</span>
<span class="token number">20010</span>       <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numsets
<span class="token number">20020</span>         Magsnist<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">20030</span>         Phasnist<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">20040</span>         Mag<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Value of variable # Eavar, freq # Eafreq</span>
<span class="token number">20050</span> !
<span class="token number">20060</span> <span class="token comment" spellcheck="true">! Compute Snist for  ***   1- &amp; 2-ports, AND GAMMA OF POWER DEVICE ***</span>
<span class="token number">20070</span> !
<span class="token number">20080</span>         <span class="token keyword">IF</span> <span class="token operator">NOT</span> Powerdevice <span class="token operator">OR</span> <span class="token punctuation">(</span>Powerdevice <span class="token operator">AND</span> Eavar<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">20090</span> Mm7<span class="token punctuation">:</span>      <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"7"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! 7 mm</span>
<span class="token number">20100</span>             <span class="token function">SELECT</span> Eavar
<span class="token number">20110</span>             <span class="token keyword">CASE</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token comment" spellcheck="true">! Gamma or S11, or S22</span>
<span class="token number">20120</span>               Magsnist<span class="token operator">=</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">-3.303</span><span class="token operator">+</span><span class="token number">.025</span><span class="token operator">*</span>Frequency<span class="token punctuation">)</span>
<span class="token number">20130</span>               Phasnist<span class="token operator">=</span><span class="token function">ATN</span><span class="token punctuation">(</span>Magsnist<span class="token operator">/</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">20140</span>             <span class="token keyword">CASE</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token comment" spellcheck="true">! S12 or S21</span>
<span class="token number">20150</span>               <span class="token keyword">IF</span> Mag<span class="token operator">&lt;=</span><span class="token number">25</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! 0-20 dB</span>
<span class="token number">20160</span>                 <span class="token keyword">IF</span> Frequency<span class="token operator">&gt;=</span><span class="token number">.01</span> <span class="token operator">AND</span> Frequency<span class="token operator">&lt;=</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">!  .01-1 GHz</span>
<span class="token number">20170</span>                   Magsnist<span class="token operator">=</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">-3.06</span><span class="token operator">+</span><span class="token number">.51</span><span class="token operator">*</span>Frequency<span class="token punctuation">)</span>
<span class="token number">20180</span>                   Phasnist<span class="token operator">=</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">-1.95</span><span class="token operator">+</span><span class="token number">.792</span><span class="token operator">*</span>Frequency<span class="token punctuation">)</span>
<span class="token number">20190</span>                 <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">20200</span>                 <span class="token keyword">IF</span> Frequency<span class="token operator">&gt;</span><span class="token number">1</span> <span class="token operator">AND</span> Frequency<span class="token operator">&lt;=</span><span class="token number">18</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! &gt;2-18 GHz</span>
<span class="token number">20210</span>                   Magsnist<span class="token operator">=</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">-2.816</span><span class="token operator">+</span><span class="token number">.038</span><span class="token operator">*</span>Frequency<span class="token punctuation">)</span>
<span class="token number">20220</span>                   Phasnist<span class="token operator">=</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">.927</span><span class="token operator">+</span><span class="token number">.023</span><span class="token operator">*</span>Frequency<span class="token punctuation">)</span>
<span class="token number">20230</span>                 <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">20240</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">20250</span>               <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">25</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">100</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! &gt;20-100 dB</span>
<span class="token number">20260</span>                 <span class="token keyword">IF</span> Frequency<span class="token operator">&gt;=</span><span class="token number">.01</span> <span class="token operator">AND</span> Frequency<span class="token operator">&lt;=</span><span class="token number">18</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! .01-18 GHz</span>
<span class="token number">20270</span>                   Phasnist<span class="token operator">=</span><span class="token number">.1</span><span class="token operator">+</span><span class="token number">.017</span><span class="token operator">*</span>Frequency
<span class="token number">20280</span>                 <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">20290</span>                 <span class="token keyword">IF</span> Frequency<span class="token operator">&gt;=</span><span class="token number">.01</span> <span class="token operator">AND</span> Frequency<span class="token operator">&lt;=</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">!  .01-1 GHz, PHASE</span>
<span class="token number">20300</span>                   Phasnist<span class="token operator">=</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">.96</span><span class="token operator">+</span><span class="token number">.259</span><span class="token operator">*</span>Frequency<span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">!  ONLY recalc</span>
<span class="token number">20310</span>                 <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">20320</span>                 <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">25</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">40</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.02</span>
<span class="token number">20330</span>                 <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">100</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.02</span><span class="token operator">+</span><span class="token number">.00015</span><span class="token operator">*</span><span class="token punctuation">(</span>Mag<span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Mag<span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span>
<span class="token number">20340</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">20350</span>               <span class="token keyword">IF</span> Magsnist<span class="token operator">&lt;</span><span class="token number">.004</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.004</span>  <span class="token comment" spellcheck="true">! .004 dB minimum</span>
<span class="token number">20360</span>               <span class="token keyword">IF</span> Phasnist<span class="token operator">&lt;</span><span class="token number">.01</span> <span class="token keyword">THEN</span> Phasnist<span class="token operator">=</span><span class="token number">.01</span>    <span class="token comment" spellcheck="true">!.01 deg min.</span>
<span class="token number">20370</span>             <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">20380</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span> <span class="token comment" spellcheck="true">! (7 mm)</span>
<span class="token number">20390</span>   !
<span class="token number">20400</span> Typen<span class="token punctuation">:</span>    <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"N"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Type N</span>
<span class="token number">20410</span>             <span class="token function">SELECT</span> Eavar
<span class="token number">20420</span>             <span class="token keyword">CASE</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token comment" spellcheck="true">! Gamma or S11, or S22</span>
<span class="token number">20430</span>               Magsnist<span class="token operator">=</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">-3.327</span><span class="token operator">+</span><span class="token number">.046</span><span class="token operator">*</span>Frequency<span class="token punctuation">)</span>
<span class="token number">20440</span>               Phasnist<span class="token operator">=</span><span class="token function">ATN</span><span class="token punctuation">(</span>Magsnist<span class="token operator">/</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">20450</span>             <span class="token keyword">CASE</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token comment" spellcheck="true">! S12 or S21</span>
<span class="token number">20460</span>               <span class="token keyword">IF</span> Mag<span class="token operator">&lt;=</span><span class="token number">25</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! 0-20 dB</span>
<span class="token number">20470</span>                 Magsnist<span class="token operator">=</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">-2.17</span><span class="token operator">+</span><span class="token number">.024</span><span class="token operator">*</span>Frequency<span class="token punctuation">)</span>
<span class="token number">20480</span>                 Phasnist<span class="token operator">=</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">-1.138</span><span class="token operator">+</span><span class="token number">.032</span><span class="token operator">*</span>Frequency<span class="token punctuation">)</span>
<span class="token number">20490</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">20500</span>               <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">25</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">100</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! &gt;20-100 dB</span>
<span class="token number">20510</span>                 <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">25</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">40</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.02</span>
<span class="token number">20520</span>                 <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">100</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.02</span><span class="token operator">+</span><span class="token number">.00015</span><span class="token operator">*</span><span class="token punctuation">(</span>Mag<span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Mag<span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span>
<span class="token number">20530</span>                 Phasnist<span class="token operator">=</span><span class="token number">.1</span><span class="token operator">+</span><span class="token number">.017</span><span class="token operator">*</span>Frequency
<span class="token number">20540</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">20550</span>               <span class="token keyword">IF</span> Magsnist<span class="token operator">&lt;</span><span class="token number">.004</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.004</span>  <span class="token comment" spellcheck="true">! .004 dB minimum</span>
<span class="token number">20560</span>               <span class="token keyword">IF</span> Phasnist<span class="token operator">&lt;</span><span class="token number">.01</span> <span class="token keyword">THEN</span> Phasnist<span class="token operator">=</span><span class="token number">.01</span>    <span class="token comment" spellcheck="true">!.01 deg min.</span>
<span class="token number">20570</span>             <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">20580</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span> <span class="token comment" spellcheck="true">! (Type N)</span>
<span class="token number">20590</span>   !
<span class="token number">20600</span> Mm2_92<span class="token punctuation">:</span>  !
<span class="token number">20610</span> Mm2_4<span class="token punctuation">:</span>   !
<span class="token number">20620</span> Mm3_5<span class="token punctuation">:</span>    <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"3.5"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"2.9"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"2.4"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! 3.5 mmOR 2.92 mm OR 2.4</span>
<span class="token number">20630</span>             <span class="token function">SELECT</span> Eavar
<span class="token number">20640</span>             <span class="token keyword">CASE</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token comment" spellcheck="true">! Gamma or S11, or S22</span>
<span class="token number">20641</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"2.4"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! 2.4 mm Only</span>
<span class="token number">20642</span>                 Magsnist<span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token operator">+</span><span class="token operator">-</span><span class="token number">.75</span><span class="token operator">*</span>Frequency<span class="token operator">*</span><span class="token function">EXP</span><span class="token punctuation">(</span><span class="token number">.04</span><span class="token operator">*</span>Frequency<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Changed formula for 2.4 mm based on analysis of data - 2/26/99 RAG</span>
<span class="token number">20643</span>               <span class="token keyword">ELSE</span>
<span class="token number">20650</span>                 Magsnist<span class="token operator">=</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">-3.281</span><span class="token operator">+</span><span class="token number">.030</span><span class="token operator">*</span>Frequency<span class="token punctuation">)</span>
<span class="token number">20651</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">20660</span>               Phasnist<span class="token operator">=</span><span class="token function">ATN</span><span class="token punctuation">(</span>Magsnist<span class="token operator">/</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">20670</span>             <span class="token keyword">CASE</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token comment" spellcheck="true">! S12  or S21</span>
<span class="token number">20680</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"2.4"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! 2.4 mm only</span>
<span class="token number">20690</span>                 <span class="token keyword">IF</span> Mag<span class="token operator">&gt;=</span><span class="token number">0</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">25</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.01</span><span class="token operator">+</span><span class="token number">.0004</span><span class="token operator">*</span>Frequency
<span class="token number">20700</span>                 <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">25</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">40</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.03</span>
<span class="token number">20710</span>                 <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">100</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.03</span><span class="token operator">+</span><span class="token number">.00015</span><span class="token operator">*</span><span class="token punctuation">(</span>Mag<span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Mag<span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span>
<span class="token number">20720</span>               <span class="token keyword">ELSE</span> <span class="token comment" spellcheck="true">! 3.5, 2.92 mm</span>
<span class="token number">20730</span>                 <span class="token keyword">IF</span> Mag<span class="token operator">&lt;=</span><span class="token number">25</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.005</span><span class="token operator">+</span><span class="token number">.00027</span><span class="token operator">*</span>Frequency
<span class="token number">20740</span>                 <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">25</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">40</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.02</span>
<span class="token number">20750</span>                 <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">100</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.02</span><span class="token operator">+</span><span class="token number">.00015</span><span class="token operator">*</span><span class="token punctuation">(</span>Mag<span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Mag<span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span>
<span class="token number">20760</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">20770</span>               !
<span class="token number">20780</span>               Phasnist<span class="token operator">=</span><span class="token number">.1</span><span class="token operator">+</span><span class="token number">.0098</span><span class="token operator">*</span>Frequency    <span class="token comment" spellcheck="true">! Unc phase 3.5, 2.92, 2.4</span>
<span class="token number">20790</span>               <span class="token keyword">IF</span> Magsnist<span class="token operator">&lt;</span><span class="token number">.002</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.002</span>  <span class="token comment" spellcheck="true">! .002 dB minimum</span>
<span class="token number">20800</span>               <span class="token keyword">IF</span> Phasnist<span class="token operator">&lt;</span><span class="token number">.01</span> <span class="token keyword">THEN</span> Phasnist<span class="token operator">=</span><span class="token number">.01</span>    <span class="token comment" spellcheck="true">!.01 deg min.</span>
<span class="token number">20810</span>             <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">20820</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span> <span class="token comment" spellcheck="true">! (3.5 mm)</span>
<span class="token number">20830</span>   !
<span class="token number">20840</span> Mm14<span class="token punctuation">:</span>     <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"14"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! 14 mm</span>
<span class="token number">20850</span>             <span class="token function">SELECT</span> Eavar
<span class="token number">20860</span>             <span class="token keyword">CASE</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token comment" spellcheck="true">! Gamma or S11, or S22</span>
<span class="token number">20870</span>               Magsnist<span class="token operator">=</span><span class="token number">.0005</span>
<span class="token number">20880</span>               Phasnist<span class="token operator">=</span><span class="token function">ATN</span><span class="token punctuation">(</span>Magsnist<span class="token operator">/</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">20890</span>             <span class="token keyword">CASE</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token comment" spellcheck="true">! S12 or S21</span>
<span class="token number">20900</span>               <span class="token keyword">IF</span> Mag<span class="token operator">&lt;=</span><span class="token number">25</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! 0-20 dB</span>
<span class="token number">20910</span>                 Magsnist<span class="token operator">=</span><span class="token number">.005</span><span class="token operator">+</span><span class="token number">.00035</span><span class="token operator">*</span>Frequency
<span class="token number">20920</span>                 Phasnist<span class="token operator">=</span><span class="token number">.02</span><span class="token operator">+</span><span class="token number">.0153</span><span class="token operator">*</span>Frequency
<span class="token number">20930</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">20940</span>               <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">25</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">100</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! &gt;20-100 dB</span>
<span class="token number">20950</span>                 <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">25</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">40</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.02</span>
<span class="token number">20960</span>                 <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">100</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.02</span><span class="token operator">+</span><span class="token number">.00015</span><span class="token operator">*</span><span class="token punctuation">(</span>Mag<span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Mag<span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span>
<span class="token number">20970</span>                 Phasnist<span class="token operator">=</span><span class="token number">.1</span><span class="token operator">+</span><span class="token number">.017</span><span class="token operator">*</span>Frequency
<span class="token number">20980</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">20990</span>               <span class="token keyword">IF</span> Magsnist<span class="token operator">&lt;</span><span class="token number">.002</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.002</span>  <span class="token comment" spellcheck="true">! .002 dB minimum</span>
<span class="token number">21000</span>               <span class="token keyword">IF</span> Phasnist<span class="token operator">&lt;</span><span class="token number">.01</span> <span class="token keyword">THEN</span> Phasnist<span class="token operator">=</span><span class="token number">.01</span>    <span class="token comment" spellcheck="true">!.01 deg min.</span>
<span class="token number">21010</span>             <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">21020</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span> <span class="token comment" spellcheck="true">! (14 mm)</span>
<span class="token number">21030</span>   !
<span class="token number">21040</span> Waveguide<span class="token punctuation">:</span> <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"W"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! 1- and 2-PORTS WAVEGUIDE</span>
<span class="token number">21050</span>             <span class="token function">SELECT</span> Eavar
<span class="token number">21060</span>             <span class="token keyword">CASE</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token comment" spellcheck="true">! Gamma OR S11,S22</span>
<span class="token number">21070</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.0015</span>
<span class="token number">21080</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"90"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"62"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.0015</span>
<span class="token number">21090</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"22"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"15"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.003</span>
<span class="token number">21100</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"10"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.004</span><span class="token comment" spellcheck="true">! WR-10</span>
<span class="token number">21110</span>             !
<span class="token number">21120</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Phasnist<span class="token operator">=</span><span class="token number">.09</span>
<span class="token number">21130</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"90"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"62"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Phasnist<span class="token operator">=</span><span class="token number">.09</span>
<span class="token number">21140</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"22"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"15"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Phasnist<span class="token operator">=</span><span class="token number">.17</span>
<span class="token number">21150</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"10"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Phasnist<span class="token operator">=</span><span class="token number">.23</span>      <span class="token comment" spellcheck="true">! WR-10</span>
<span class="token number">21160</span>             <span class="token keyword">CASE</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span> <span class="token comment" spellcheck="true">! S12</span>
<span class="token number">21170</span>               <span class="token keyword">IF</span> Mag<span class="token operator">&lt;=</span><span class="token number">25</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.01</span>
<span class="token number">21180</span>               <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">25</span> <span class="token operator">AND</span> Mag<span class="token operator">&lt;=</span><span class="token number">40</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.02</span>
<span class="token number">21190</span>               <span class="token keyword">IF</span> Mag<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.02</span><span class="token operator">+</span><span class="token number">.00015</span><span class="token operator">*</span><span class="token punctuation">(</span>Mag<span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Mag<span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span>
<span class="token number">21191</span>     <span class="token comment" spellcheck="true">! Increased snist for WR15 &amp; WR10 S12 on 01/14/02 after reviewing current calibration data</span>
<span class="token number">21192</span>     <span class="token comment" spellcheck="true">! Short term deviations on six-port as high as 0.06 at times.  Also starting</span>
<span class="token number">21193</span>     <span class="token comment" spellcheck="true">! to measure devices on HP8510 (noise lab WR-15 armadillos)</span>
<span class="token number">21195</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"15"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"10"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>Magsnist
<span class="token number">21200</span>               Phasnist<span class="token operator">=</span><span class="token number">.15</span>
<span class="token number">21201</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"15"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"10"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Phasnist<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>Phasnist
<span class="token number">21210</span>               <span class="token keyword">IF</span> Phasnist<span class="token operator">&gt;</span><span class="token number">180</span> <span class="token keyword">THEN</span> Phasnist<span class="token operator">=</span><span class="token number">180</span>
<span class="token number">21220</span>             <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">21230</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">21240</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>    <span class="token comment" spellcheck="true">! END OF Snist for 1- or 2-port section WAVEGUIDE</span>
<span class="token number">21250</span>     !
<span class="token number">21260</span>     <span class="token comment" spellcheck="true">! For POWER DEVICES, Snist is calculated for efficiency, Kb</span>
<span class="token number">21270</span>     <span class="token comment" spellcheck="true">!   only (the last 2 variables, or Eavar=2,3).  Snist for Gamma</span>
<span class="token number">21280</span>     <span class="token comment" spellcheck="true">!   is calculated above, as for the 1- and 2-port devices.</span>
<span class="token number">21290</span>     !
<span class="token number">21300</span>         <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"T"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Power devices</span>
<span class="token number">21310</span>           <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"W"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Compute  NON-WAVEGUIDE (COAX)</span>
<span class="token number">21320</span>             <span class="token function">SELECT</span> Eavar
<span class="token number">21330</span>             <span class="token keyword">CASE</span> <span class="token number">2</span><span class="token comment" spellcheck="true">! Efficiency</span>
<span class="token number">21340</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"3"</span><span class="token punctuation">)</span> <span class="token operator">AND</span> Frequency<span class="token operator">&gt;</span><span class="token number">18</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! 3.5 mm &gt; 18 GHz</span>
<span class="token number">21350</span>                 Magsnist<span class="token operator">=</span><span class="token number">.25</span>
<span class="token number">21360</span>               <span class="token keyword">ELSE</span>  <span class="token comment" spellcheck="true">! 3.5mm below 18 GHz, and all other coax (N, 7)</span>
<span class="token number">21370</span>                 Magsnist<span class="token operator">=</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">.04</span><span class="token operator">*</span>Frequency<span class="token operator">-</span><span class="token number">1.4</span><span class="token punctuation">)</span>
<span class="token number">21380</span>                 <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"7"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.09</span><span class="token operator">+</span><span class="token number">.01</span><span class="token operator">*</span>Frequency<span class="token comment" spellcheck="true">!7mm</span>
<span class="token number">21390</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">21400</span>             <span class="token keyword">CASE</span> <span class="token number">3</span><span class="token comment" spellcheck="true">! Kb</span>
<span class="token number">21410</span>               Magsnist<span class="token operator">=</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Snist Kb= Snist for efficiency</span>
<span class="token number">21420</span>             <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">21430</span>           !
<span class="token number">21440</span>           <span class="token keyword">ELSE</span>   <span class="token comment" spellcheck="true">! Compute for WAVEGUIDE power</span>
<span class="token number">21450</span>       <span class="token comment" spellcheck="true">!  If WR-22,28,42 POWER DEVICE, then Snist is constant value</span>
<span class="token number">21460</span>             <span class="token function">SELECT</span> Eavar
<span class="token number">21470</span>             <span class="token keyword">CASE</span> <span class="token number">2</span>  <span class="token comment" spellcheck="true">! Efficiency</span>
<span class="token number">21480</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"90"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"62"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.20</span>
<span class="token number">21490</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"10"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"22"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.5</span>
<span class="token number">21500</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"15"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.75</span>
<span class="token number">21510</span>             <span class="token keyword">CASE</span> <span class="token number">3</span> <span class="token comment" spellcheck="true">! Kb</span>
<span class="token number">21520</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"90"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"62"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.20</span>
<span class="token number">21530</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"10"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"22"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.5</span>
<span class="token number">21540</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"15"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span><span class="token number">.75</span>
<span class="token number">21550</span>             <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">21560</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">21570</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">21571</span>         <span class="token keyword">IF</span> Powerdevice <span class="token keyword">THEN</span>
<span class="token number">21572</span>           <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"W"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">21574</span>             <span class="token keyword">IF</span> Eavar<span class="token operator">&lt;&gt;</span><span class="token number">1</span> <span class="token operator">AND</span> Eavar<span class="token operator">&lt;&gt;</span><span class="token number">3</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span>Magsnist<span class="token operator">/</span><span class="token number">100</span>    <span class="token comment" spellcheck="true">! Put eff eff and Kb uncert in numeric form.   !RAG</span>
<span class="token number">21575</span>           <span class="token keyword">ELSE</span>
<span class="token number">21576</span>             <span class="token keyword">IF</span> Eavar<span class="token operator">&lt;&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span> Magsnist<span class="token operator">=</span>Magsnist<span class="token operator">/</span><span class="token number">100</span>                 <span class="token comment" spellcheck="true">! Adjust waveguide case for eff and Kb</span>
<span class="token number">21577</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">21579</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">21580</span>       !
<span class="token number">21590</span>       <span class="token comment" spellcheck="true">! For a 1- or 2-port, store mag &amp; phase info calc'd for every</span>
<span class="token number">21600</span>       <span class="token comment" spellcheck="true">!  ODD value of Eavar (it does mag &amp; phase at same time)</span>
<span class="token number">21610</span>         <span class="token keyword">IF</span> <span class="token operator">NOT</span> Powerdevice <span class="token operator">AND</span> <span class="token punctuation">(</span>Eavar<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">OR</span> Eavar<span class="token operator">=</span><span class="token number">3</span> <span class="token operator">OR</span> Eavar<span class="token operator">=</span><span class="token number">5</span> <span class="token operator">OR</span> Eavar<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">21620</span>           Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Magsnist
<span class="token number">21630</span>           Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Phasnist
<span class="token number">21640</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">21650</span>       !
<span class="token number">21660</span>       <span class="token comment" spellcheck="true">! For a power device, only Gamma has a phase uncert.</span>
<span class="token number">21670</span>         <span class="token keyword">IF</span> Powerdevice <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! Store uncert for gamma mag, effic, &amp; Kb</span>
<span class="token number">21680</span>           <span class="token keyword">IF</span> Eavar<span class="token operator">&lt;&gt;</span><span class="token number">6</span> <span class="token keyword">THEN</span> Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Magsnist
<span class="token number">21690</span>           <span class="token keyword">IF</span> Eavar<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span>Phasnist<span class="token comment" spellcheck="true">! Arg(Gamma) uncert</span>
<span class="token number">21700</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">21710</span>       <span class="token keyword">NEXT</span> Easet
<span class="token number">21720</span>     <span class="token keyword">NEXT</span> Eavar
<span class="token number">21730</span>   <span class="token keyword">NEXT</span> Eafreq
<span class="token number">21740</span> SUBEND  <span class="token comment" spellcheck="true">!............Snist.....................</span>


<span class="token number">21750</span> Syst1or2port<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Syst1or2port<span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span>Connector$<span class="token punctuation">,</span>Numvars<span class="token punctuation">,</span>Numsets<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Ps<span class="token punctuation">,</span>Va<span class="token punctuation">,</span>Sl<span class="token punctuation">,</span>Ss<span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">21760</span> <span class="token comment" spellcheck="true">! COMPUTE TYPE B (SYSTEMATIC) UNCERTAINTIES FOR FIXED DEVICE, 1- OR 2-PORT</span>
<span class="token number">21770</span> <span class="token comment" spellcheck="true">!  OR A SLIDING LOAD</span>
<span class="token number">21780</span> !
<span class="token number">21790</span> <span class="token comment" spellcheck="true">! INPUT: Meastype$= type of device, </span><span class="token string">"1-port"</span><span class="token punctuation">,</span> <span class="token string">"2-port"</span><span class="token punctuation">,</span> <span class="token operator">or</span> <span class="token string">"2-portNR"</span>
<span class="token number">21800</span> <span class="token comment" spellcheck="true">!        Connector$= type of connectors measured.</span>
<span class="token number">21810</span> <span class="token comment" spellcheck="true">!        Numvars= # of variables for the device type, e.g. if Meastype$</span>
<span class="token number">21820</span> <span class="token comment" spellcheck="true">!           =</span><span class="token string">"1-port"</span><span class="token punctuation">,</span> Numvars<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">for</span> |Gamma| <span class="token operator">&amp;</span> Arg<span class="token punctuation">(</span>Gamma<span class="token punctuation">)</span>
<span class="token number">21830</span> <span class="token comment" spellcheck="true">! Ps=1 if phase shifter</span>
<span class="token number">21840</span> <span class="token comment" spellcheck="true">! Va=1 if variable attenuator</span>
<span class="token number">21850</span> <span class="token comment" spellcheck="true">! Sl=1 if sliding load</span>
<span class="token number">21860</span> <span class="token comment" spellcheck="true">! Ss=1 if sliding short</span>
<span class="token number">21870</span> <span class="token comment" spellcheck="true">!        Numsets&gt;1 if device is variable (# of settings measured)</span>
<span class="token number">21880</span> <span class="token comment" spellcheck="true">!        Avgs(*)= FINAL averages for each frequency, each variable</span>
<span class="token number">21890</span> !
<span class="token number">21900</span> <span class="token comment" spellcheck="true">! OUTPUT: Syst(*)= systematic uncertainties for each freq, each variable</span>
<span class="token number">21910</span> !
<span class="token number">21920</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">21930</span>   <span class="token function">DEG</span>
<span class="token number">21940</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">21950</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> Ps <span class="token operator">AND</span> <span class="token operator">NOT</span> Va <span class="token operator">AND</span> <span class="token operator">NOT</span> Sl <span class="token operator">AND</span> <span class="token operator">NOT</span> Ss <span class="token keyword">THEN</span>
<span class="token number">21960</span>     Startvar<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">21970</span>     Endvar<span class="token operator">=</span>Numvars
<span class="token number">21980</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">21990</span>   <span class="token keyword">IF</span> Numvars<span class="token operator">=</span><span class="token number">10</span> <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! UNCERT CALCS ONLY, FOR GAMMA</span>
<span class="token number">22000</span>     Startvar<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">22010</span>     Endvar<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">22020</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22030</span>   <span class="token keyword">IF</span> Numvars<span class="token operator">=</span><span class="token number">20</span> <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! UNCERT CALCS ONLY, FOR EFFICIENCY</span>
<span class="token number">22040</span>     Startvar<span class="token operator">=</span><span class="token number">2</span>
<span class="token number">22050</span>     Endvar<span class="token operator">=</span><span class="token number">2</span>
<span class="token number">22060</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22070</span>   <span class="token keyword">IF</span> Numvars<span class="token operator">=</span><span class="token number">30</span> <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">! UNCERT CALCS ONLY, FOR S12</span>
<span class="token number">22080</span>     Startvar<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">22090</span>     Endvar<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">22100</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22110</span>   <span class="token keyword">IF</span> Sl <span class="token operator">OR</span> Ss <span class="token keyword">THEN</span>            <span class="token comment" spellcheck="true">! Calculate for Gamma (S11 or S22) only</span>
<span class="token number">22120</span>     Startvar<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">22130</span>     Endvar<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">22140</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22150</span>   <span class="token keyword">IF</span> Ps <span class="token operator">OR</span> Va <span class="token keyword">THEN</span>            <span class="token comment" spellcheck="true">! Calculate for S12 only</span>
<span class="token number">22160</span>     Startvar<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">22170</span>     Endvar<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">22180</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22190</span>  !
<span class="token number">22200</span>  <span class="token comment" spellcheck="true">! Systematic uncertainty depends on frequency, variable, connector type.</span>
<span class="token number">22210</span>  !
<span class="token number">22220</span>   <span class="token keyword">FOR</span> Eavar<span class="token operator">=</span>Startvar <span class="token keyword">TO</span> Endvar            <span class="token comment" spellcheck="true">! Each variable |Sij| or |Gamma|</span>
<span class="token number">22230</span>     <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs    <span class="token comment" spellcheck="true">! Each frequency, in GHz</span>
<span class="token number">22240</span>       <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numsets
<span class="token number">22250</span>         Mag<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Magnitude variable #Eavar, freq #Eafreq</span>
<span class="token number">22260</span>  !
<span class="token number">22270</span>         <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"W"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! NOT WAVEGUIDE</span>
<span class="token number">22280</span>           <span class="token function">SELECT</span> Eavar
<span class="token number">22290</span>           <span class="token keyword">CASE</span> <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span>                              <span class="token comment" spellcheck="true">! S11,S22 or Gamma</span>
<span class="token number">22300</span>             Dx<span class="token operator">=</span><span class="token number">.001</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1.61</span><span class="token operator">+</span><span class="token number">.07</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">.04</span><span class="token operator">/</span><span class="token function">SQR</span><span class="token punctuation">(</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">.0012</span>
<span class="token number">22310</span>             Dy<span class="token operator">=</span><span class="token number">.001</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">.01</span><span class="token operator">*</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">.04</span><span class="token operator">/</span><span class="token function">SQR</span><span class="token punctuation">(</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">22320</span>  <span class="token comment" spellcheck="true">! Add Dx and Dy in quadrature to find Um1, and other terms</span>
<span class="token number">22330</span>  <span class="token comment" spellcheck="true">! Add all terms in quad to get final uncert</span>
<span class="token number">22340</span>             Um1<span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Dx<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Dy<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">22350</span>             Uarg1<span class="token operator">=</span><span class="token function">ATN</span><span class="token punctuation">(</span>Um1<span class="token operator">/</span>Mag<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Here, assume magnitude= mag of the DUT</span>
<span class="token number">22360</span>                                <span class="token comment" spellcheck="true">!   and not the mag of an actual cal std</span>
<span class="token number">22370</span>             Um2<span class="token operator">=</span><span class="token number">.00008</span><span class="token operator">/</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Uncert due to electricaly short lines</span>
<span class="token number">22380</span>             Uarg2<span class="token operator">=</span><span class="token function">ATN</span><span class="token punctuation">(</span>Um2<span class="token operator">/</span>Mag<span class="token punctuation">)</span>
<span class="token number">22390</span>             Um3<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">.1651</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">5</span><span class="token operator">*</span><span class="token number">6.E+6</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">.35</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">1.4E+7</span><span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">22400</span>             Uarg3<span class="token operator">=</span><span class="token number">12.0115</span><span class="token operator">*</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">.0025</span>
<span class="token number">22410</span>             Delta<span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Um1<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Um2<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Um3<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span>          <span class="token comment" spellcheck="true">! Type B for mag</span>
<span class="token number">22420</span>             Deltaarg<span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Uarg1<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Uarg2<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Uarg3<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Type B for phase</span>
<span class="token number">22430</span> !
<span class="token number">22440</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"N"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"7"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">22450</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Delta          <span class="token comment" spellcheck="true">! Syst unc for mag</span>
<span class="token number">22451</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Deltaarg     <span class="token comment" spellcheck="true">! Syst unc for phase</span>
<span class="token number">22455</span>         <span class="token comment" spellcheck="true">! Re-adjust 7 mm gamma uncertainties to cover deteriorating air lines  07/25/00  !RAG</span>
<span class="token number">22461</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"7"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">22470</span>                 Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Delta<span class="token operator">*</span><span class="token number">2</span>          <span class="token comment" spellcheck="true">! Adjust syst uncert for mag by factor of 2   07/25/00   !RAG</span>
<span class="token number">22471</span>                 Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Deltaarg<span class="token operator">*</span><span class="token number">2</span>     <span class="token comment" spellcheck="true">! Adjust Syst unc for phase by a factor of 2   07/25/00   !RAG</span>
<span class="token number">22472</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22474</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22480</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"14"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">!Modify 7 mm's by 7/14</span>
<span class="token number">22490</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Delta          <span class="token comment" spellcheck="true">! Syst unc for mag</span>
<span class="token number">22500</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">.5</span><span class="token operator">*</span>Deltaarg  <span class="token comment" spellcheck="true">! Syst unc for phase</span>
<span class="token number">22510</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22520</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"3.5"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Modify 7 mm's by 7/3.5</span>
<span class="token number">22530</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>Delta        <span class="token comment" spellcheck="true">! Syst unc for mag</span>
<span class="token number">22540</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>Deltaarg   <span class="token comment" spellcheck="true">! S.U. for phase</span>
<span class="token number">22550</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22560</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"2.9"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Modify 7 mm's by 7/2.92</span>
<span class="token number">22570</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2.4</span><span class="token operator">*</span>Delta      <span class="token comment" spellcheck="true">! Syst unc for mag</span>
<span class="token number">22580</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2.4</span><span class="token operator">*</span>Deltaarg <span class="token comment" spellcheck="true">! Syst unc for phase</span>
<span class="token number">22590</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22600</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"2.4"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Modify 7 mm's by 7/2.4</span>
<span class="token number">22610</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Delta<span class="token operator">*</span><span class="token number">2.92</span>    <span class="token comment" spellcheck="true">!*1.5 ! * by 1.5, 11/18/94 - Removed the extra *1.5 2/26/99  RAG</span>
<span class="token number">22620</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2.92</span><span class="token operator">*</span>Deltaarg  <span class="token comment" spellcheck="true">! S.U. for phase</span>
<span class="token number">22630</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22640</span> !
<span class="token number">22650</span>           <span class="token keyword">CASE</span> <span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span>                              <span class="token comment" spellcheck="true">! S12</span>
<span class="token number">22660</span> <span class="token comment" spellcheck="true">!  If a 2port, Syst depends on frequency, connector type</span>
<span class="token number">22670</span>             Um4<span class="token operator">=</span><span class="token number">.0006</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">.0011</span>
<span class="token number">22680</span>             Uarg4<span class="token operator">=</span><span class="token function">ATN</span><span class="token punctuation">(</span><span class="token number">.01</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">.017</span><span class="token operator">+</span><span class="token number">.018</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">.005</span><span class="token operator">*</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">.018</span><span class="token operator">*</span><span class="token punctuation">(</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">22690</span>             Um5<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1.434</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">5</span><span class="token operator">*</span><span class="token number">6.E+6</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">.35</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">1.4E+7</span><span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">22700</span>             Uarg5<span class="token operator">=</span><span class="token number">12.0115</span><span class="token operator">*</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">.0025</span>
<span class="token number">22710</span>             Delmag<span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Um4<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Um5<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">22720</span>             Delarg<span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Uarg4<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Uarg5<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">22730</span> !
<span class="token number">22740</span>             <span class="token keyword">IF</span> Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Delarg<span class="token operator">=</span><span class="token number">.03</span>  <span class="token comment" spellcheck="true">! Set min for arg uncerts</span>
<span class="token number">22750</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"N"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"7"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">22760</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Delmag   <span class="token comment" spellcheck="true">! Syst unc for mag</span>
<span class="token number">22761</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Delarg <span class="token comment" spellcheck="true">! Syst unc for phase</span>
<span class="token number">22765</span>         <span class="token comment" spellcheck="true">!   Re-adjust 7 mm S12 uncerts for deteriorating air lines    07/25/00    !RAG</span>
<span class="token number">22771</span>               <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"7"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">22780</span>                 Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Delmag<span class="token operator">*</span><span class="token number">2</span>   <span class="token comment" spellcheck="true">! Adjust Syst unc for mag by a factor of 2     07/25/00      !RAG</span>
<span class="token number">22781</span>                 Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Delarg<span class="token operator">*</span><span class="token number">2</span>    <span class="token comment" spellcheck="true">! Adjust Syst unc for phase by a factor of 2 07/25/00     !RAG</span>
<span class="token number">22782</span>               <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22784</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22790</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"14"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! use 7mm's modified by 7/14</span>
<span class="token number">22800</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Delmag <span class="token comment" spellcheck="true">! Syst unc for mag</span>
<span class="token number">22810</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Delarg <span class="token comment" spellcheck="true">! Syst unc for phase</span>
<span class="token number">22820</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22830</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"3.5"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! use 7 mm's modified by 7/3.5</span>
<span class="token number">22840</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Delmag<span class="token operator">*</span><span class="token number">2</span> <span class="token comment" spellcheck="true">! Syst unc for mag</span>
<span class="token number">22850</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Delarg <span class="token comment" spellcheck="true">! Syst unc for phase</span>
<span class="token number">22860</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22870</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"2.9"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Use 7 mm's modified by 7/2.92</span>
<span class="token number">22880</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Delmag<span class="token operator">*</span><span class="token number">2.4</span> <span class="token comment" spellcheck="true">! Syst unc for mag</span>
<span class="token number">22890</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Delarg   <span class="token comment" spellcheck="true">! Syst unc for phase</span>
<span class="token number">22900</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22910</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"2.4"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Use 7 mm's modified by 7/2.4</span>
<span class="token number">22920</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Delmag<span class="token operator">*</span><span class="token number">2.92</span> <span class="token comment" spellcheck="true">! Syst unc for mag</span>
<span class="token number">22930</span>               Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Delarg    <span class="token comment" spellcheck="true">! Syst unc for phase</span>
<span class="token number">22940</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22950</span>           <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">22960</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">22970</span>       !
<span class="token number">22980</span> <span class="token comment" spellcheck="true">! Waveguide uncertainty subroutine modified by JRJ 4/23/97.</span>
<span class="token number">22990</span>         <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"W"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! First set wg phase uncert in deg</span>
<span class="token number">23000</span>           <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"90"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Offthruuncert<span class="token operator">=</span><span class="token number">.2</span>   <span class="token comment" spellcheck="true">! wg phase unc, deg</span>
<span class="token number">23010</span>           <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"62"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Offthruuncert<span class="token operator">=</span><span class="token number">.5</span>   <span class="token comment" spellcheck="true">! wg phase unc, deg</span>
<span class="token number">23020</span>           <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Offthruuncert<span class="token operator">=</span><span class="token number">.85</span>  <span class="token comment" spellcheck="true">! wg phase unc, deg</span>
<span class="token number">23030</span>           <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Offthruuncert<span class="token operator">=</span><span class="token number">1.0</span>  <span class="token comment" spellcheck="true">! wg phase unc, deg</span>
<span class="token number">23040</span>           <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"15"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Offthruuncert<span class="token operator">=</span><span class="token number">2.29</span> <span class="token comment" spellcheck="true">! wg phase unc, deg</span>
<span class="token number">23050</span>           <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"22"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Offthruuncert<span class="token operator">=</span><span class="token number">1.53</span> <span class="token comment" spellcheck="true">! wg phase unc, deg</span>
<span class="token number">23060</span>           <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"10"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Offthruuncert<span class="token operator">=</span><span class="token number">3.36</span> <span class="token comment" spellcheck="true">! wg phase unc, deg</span>
<span class="token number">23070</span>           <span class="token function">SELECT</span> Eavar
<span class="token number">23080</span>           <span class="token keyword">CASE</span> <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span>                   <span class="token comment" spellcheck="true">! Set unc for mag S11,S22, Gamma1,Gamma2</span>
<span class="token number">23090</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"90"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Dterm<span class="token operator">=</span><span class="token number">.003</span>       <span class="token comment" spellcheck="true">! unc mag</span>
<span class="token number">23100</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"62"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Dterm<span class="token operator">=</span><span class="token number">.003</span>       <span class="token comment" spellcheck="true">! unc mag</span>
<span class="token number">23110</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Dterm<span class="token operator">=</span><span class="token number">.002</span>       <span class="token comment" spellcheck="true">! unc mag</span>
<span class="token number">23120</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Dterm<span class="token operator">=</span><span class="token number">.002</span>       <span class="token comment" spellcheck="true">! unc mag</span>
<span class="token number">23130</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"22"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Dterm<span class="token operator">=</span><span class="token number">.004</span>       <span class="token comment" spellcheck="true">! unc mag</span>
<span class="token number">23140</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"15"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Dterm<span class="token operator">=</span><span class="token number">.004</span>       <span class="token comment" spellcheck="true">! unc mag</span>
<span class="token number">23150</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"10"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Dterm<span class="token operator">=</span><span class="token number">.010</span>       <span class="token comment" spellcheck="true">! unc mag</span>
<span class="token number">23160</span>             Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span>Dterm<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>Mag<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Type B mag unc</span>
<span class="token number">23170</span>           <span class="token comment" spellcheck="true">! Following 2 lines compute Type B Phase uncertainty in deg</span>
<span class="token number">23180</span>             Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ATN</span><span class="token punctuation">(</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>Mag<span class="token operator">+</span><span class="token number">.001</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>Offthruuncert<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">23190</span>             Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! TYPE B PHASE</span>
<span class="token number">23200</span>           <span class="token keyword">CASE</span> <span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span>                   <span class="token comment" spellcheck="true">! Set unc for mag S12 in dB</span>
<span class="token number">23210</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"90"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">.02</span><span class="token operator">/</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">23220</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"62"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">.02</span><span class="token operator">/</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">23230</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">.01</span><span class="token operator">/</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">23240</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">.01</span><span class="token operator">/</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">23250</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"22"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">.01</span><span class="token operator">/</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">23260</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"15"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">.012</span><span class="token operator">/</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">23270</span>             <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"10"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">.022</span><span class="token operator">/</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">23280</span>             Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Offthruuncert<span class="token operator">/</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">23290</span>           <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">23300</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span> <span class="token comment" spellcheck="true">! End uncertainties for Waveguide</span>
<span class="token number">23310</span>       !
<span class="token number">23320</span>         <span class="token keyword">IF</span> Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">180</span> <span class="token keyword">THEN</span> Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">180</span>
<span class="token number">23330</span>       <span class="token keyword">NEXT</span> Easet
<span class="token number">23340</span>     <span class="token keyword">NEXT</span> Eafreq
<span class="token number">23350</span>   <span class="token keyword">NEXT</span> Eavar
<span class="token number">23360</span> SUBEND   <span class="token comment" spellcheck="true">!........Syst1or2port..............</span>


<span class="token number">23370</span> Systpower<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Systpower<span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connector$<span class="token punctuation">,</span>Numvars<span class="token punctuation">,</span>Numsets<span class="token punctuation">,</span>Fileavg<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">23380</span> <span class="token comment" spellcheck="true">! COMPUTE SYSTEMATIC UNCERTAINTIES FOR FIXED DEVICE, POWER</span>
<span class="token number">23390</span> !
<span class="token number">23400</span> <span class="token comment" spellcheck="true">! INPUT: Meastype$= type of device,  </span><span class="token string">"Thermistor"</span> <span class="token operator">or</span> <span class="token string">"DryCal"</span>
<span class="token number">23410</span> <span class="token comment" spellcheck="true">!        Sport(*) has port # measured on (1 or 2), for each file</span>
<span class="token number">23420</span> <span class="token comment" spellcheck="true">!        Connector$= type of connectors measured.</span>
<span class="token number">23430</span> <span class="token comment" spellcheck="true">!        Numvars= # of variables for the device type, e.g. if Meastype$</span>
<span class="token number">23440</span> <span class="token comment" spellcheck="true">!           =</span><span class="token string">"1-port"</span><span class="token punctuation">,</span> Numvars<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">for</span> |Gamma| <span class="token operator">&amp;</span> Arg<span class="token punctuation">(</span>Gamma<span class="token punctuation">)</span>
<span class="token number">23450</span> <span class="token comment" spellcheck="true">!           =20 to calculate for efficiency only</span>
<span class="token number">23460</span> <span class="token comment" spellcheck="true">!        Numsets&gt;1 if device is variable (# of settings measured)</span>
<span class="token number">23470</span> <span class="token comment" spellcheck="true">!        Fileavg(*)= averages for each freq, each file, each variable.</span>
<span class="token number">23480</span> <span class="token comment" spellcheck="true">!        Avgs(*)= FINAL averages for each frequency, each variable</span>
<span class="token number">23490</span> <span class="token comment" spellcheck="true">!        Pwrstd(*)= data for power standard used to calibrate for power.</span>
<span class="token number">23500</span> !
<span class="token number">23510</span> <span class="token comment" spellcheck="true">! OUTPUT: Syst(*)= systematic uncertainties for each freq, each variable</span>
<span class="token number">23520</span> !
<span class="token number">23530</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">23540</span>   <span class="token function">DEG</span>
<span class="token number">23550</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">23560</span>   ALLOCATE Effsysterr<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span>
<span class="token number">23570</span>   !
<span class="token number">23580</span>   <span class="token keyword">IF</span> Numvars<span class="token operator">=</span><span class="token number">20</span> <span class="token keyword">THEN</span>
<span class="token number">23590</span>     Startvar<span class="token operator">=</span><span class="token number">2</span>
<span class="token number">23600</span>     Endvar<span class="token operator">=</span><span class="token number">2</span>
<span class="token number">23610</span>   <span class="token keyword">ELSE</span>
<span class="token number">23620</span>     Startvar<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">23630</span>     Endvar<span class="token operator">=</span>Numvars
<span class="token number">23640</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">23650</span>   <span class="token comment" spellcheck="true">!  Get systematic uncertainty for efficiency.</span>
<span class="token number">23660</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"N"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Typendevice<span class="token operator">=</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! Type N</span>
<span class="token number">23670</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"3"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Typendevice<span class="token operator">=</span><span class="token number">3</span>   <span class="token comment" spellcheck="true">! 3.5 mm.</span>
<span class="token number">23680</span>   <span class="token keyword">CALL</span> Systuncerteff<span class="token punctuation">(</span>Typendevice<span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Fileavg<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connector$<span class="token punctuation">,</span>Effsysterr<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">23690</span>   <span class="token keyword">CALL</span> Syst1or2port<span class="token punctuation">(</span><span class="token string">"1-port"</span><span class="token punctuation">,</span>Connector$<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Numsets<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">23700</span>   !
<span class="token number">23710</span>   <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs
<span class="token number">23720</span>     Numfiles<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">23730</span>     <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numsets
<span class="token number">23740</span>       Mag<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Value of Gamma mag</span>
<span class="token number">23750</span>       <span class="token keyword">FOR</span> Eavar<span class="token operator">=</span>Startvar <span class="token keyword">TO</span> Endvar
<span class="token number">23760</span>         <span class="token function">SELECT</span> Eavar
<span class="token number">23770</span>         <span class="token keyword">CASE</span> <span class="token operator">=</span><span class="token number">1</span>     <span class="token comment" spellcheck="true">! |Gamma| &amp; Arg(G) syst found in Syst1or2port:  need to put arg(gamma) in</span>
<span class="token number">23780</span>           Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! different location for power device</span>
<span class="token number">23790</span> !
<span class="token number">23800</span>         <span class="token keyword">CASE</span> <span class="token operator">=</span><span class="token number">2</span>      <span class="token comment" spellcheck="true">! Efficiency, calculated by SUB Systuncerteff</span>
<span class="token number">23810</span>           Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Effsysterr<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">23820</span>         !
<span class="token number">23830</span>         <span class="token keyword">CASE</span> <span class="token operator">=</span><span class="token number">3</span>    <span class="token comment" spellcheck="true">!CAL FACTOR Kb=Ne(1-|Gamma|^2). UNCERT Syst. IS IN %</span>
<span class="token number">23840</span>           <span class="token comment" spellcheck="true">!REFERENCE:  </span><span class="token string">"Notes on the use of propagation of error formulas"</span> by H.H. Ku<span class="token punctuation">,</span> NBS Journal <span class="token function">of</span> Research<span class="token punctuation">,</span> V. <span class="token number">70</span>C<span class="token punctuation">,</span> No.<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1966</span>
<span class="token number">23850</span>           <span class="token comment" spellcheck="true">!Uncert(Kb)=|(dKb/dNe)uncertNe|+|(dKb/d|Gamma|)uncert|Gamma||</span>
<span class="token number">23860</span>           Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Correct to produce numeric uncert  8/28/00   !RAG</span>
<span class="token number">23870</span>         <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">23880</span>       <span class="token keyword">NEXT</span> Eavar
<span class="token number">23890</span>     <span class="token keyword">NEXT</span> Easet
<span class="token number">23900</span>   <span class="token keyword">NEXT</span> Eafreq
<span class="token number">23910</span> SUBEND   <span class="token comment" spellcheck="true">!........Systpower.................</span>


<span class="token number">23920</span> Systuncerteff<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Systuncerteff<span class="token punctuation">(</span>Typendevice<span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cav<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connector$<span class="token punctuation">,</span>Effsysterr<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">23930</span>   <span class="token comment" spellcheck="true">! Calculates systematic error components for efficiency: TYPE B</span>
<span class="token number">23940</span>   !
<span class="token number">23950</span>   <span class="token comment" spellcheck="true">! INPUT: Typendevice=1 if device is type N, =3 for 3.5 mm, else=0.</span>
<span class="token number">23960</span>   <span class="token comment" spellcheck="true">!        Sport(*)= port # for each file.</span>
<span class="token number">23970</span>   <span class="token comment" spellcheck="true">!        Cav(*)= file averages for each frequency of |Gamma|,</span>
<span class="token number">23980</span>   <span class="token comment" spellcheck="true">!          efficiency, Kb, Pdc, Pinc, Arg(Gamma) (= the Fileavg(*)</span>
<span class="token number">23990</span>   <span class="token comment" spellcheck="true">!          array in other SUBs).</span>
<span class="token number">24000</span>   <span class="token comment" spellcheck="true">!        Pwrstd(*):  data for standard used for power calibration:</span>
<span class="token number">24010</span>   <span class="token comment" spellcheck="true">!          frequency, GammaG, Total error, |Gamma|, Arg(Gamma), Pdc,</span>
<span class="token number">24020</span>   <span class="token comment" spellcheck="true">!          Pinc, Std dev of power meter on port 1 &amp; port 2.  For each</span>
<span class="token number">24030</span>   <span class="token comment" spellcheck="true">!          file read in.</span>
<span class="token number">24040</span>   <span class="token comment" spellcheck="true">!        Connector$= type of connectors measured</span>
<span class="token number">24050</span>   !
<span class="token number">24060</span>   <span class="token comment" spellcheck="true">! OUTPUT: Effsysterr(*), systematic errors for each freq.</span>
<span class="token number">24070</span>   !
<span class="token number">24080</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">24090</span>   !
<span class="token number">24100</span>   <span class="token comment" spellcheck="true">!  If the device was done on WR-22,28,42 then systematic stuff is</span>
<span class="token number">24110</span>   <span class="token comment" spellcheck="true">! determined differently.  The math is less complex.</span>
<span class="token number">24120</span>   !
<span class="token number">24130</span>   <span class="token keyword">IF</span> Freq<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">18</span> <span class="token operator">AND</span> Freq<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token punctuation">(</span>Numfreqs<span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">18</span> <span class="token keyword">THEN</span>    <span class="token comment" spellcheck="true">!If on other systems</span>
<span class="token number">24140</span>     <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs
<span class="token number">24150</span>       <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"3"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Deltas<span class="token operator">=</span><span class="token number">.7</span>        <span class="token comment" spellcheck="true">!3.5 mm</span>
<span class="token number">24160</span>       <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"22"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Deltas<span class="token operator">=</span><span class="token number">.4</span>       <span class="token comment" spellcheck="true">! WR-22, Type B changed 3/20/98</span>
<span class="token number">24170</span>       <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"15"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Deltas<span class="token operator">=</span><span class="token number">.4</span>       <span class="token comment" spellcheck="true">! WR-15, Type B changed 4/16/98</span>
<span class="token number">24180</span>       <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"10"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Deltas<span class="token operator">=</span><span class="token number">.9</span>       <span class="token comment" spellcheck="true">! WR-10</span>
<span class="token number">24190</span>       <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"90"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"62"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Deltas<span class="token operator">=</span><span class="token number">.5</span>
<span class="token number">24200</span>       Effsysterr<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Deltas<span class="token operator">/</span><span class="token number">100</span>     <span class="token comment" spellcheck="true">! 1/100 added to keep uncert in numeric instead of percentage    !RAG</span>
<span class="token number">24210</span>     <span class="token keyword">NEXT</span> Eafreq
<span class="token number">24220</span>     !
<span class="token number">24230</span>   <span class="token keyword">ELSE</span>      <span class="token comment" spellcheck="true">! Systems A,B,C &amp; DIRECT COMPARISON SYSTEM</span>
<span class="token number">24240</span>     Arrayplace<span class="token operator">=</span><span class="token number">0</span> <span class="token comment" spellcheck="true">! So Matchfreq starts at beginning of freq array</span>
<span class="token number">24250</span>     <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs    <span class="token comment" spellcheck="true">! Each frequency</span>
<span class="token number">24260</span>       Filesthisfreq<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! # files for this freq</span>
<span class="token number">24270</span>       <span class="token keyword">CALL</span> Matchfreq<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">24280</span>     !
<span class="token number">24290</span>       Directcomp<span class="token operator">=</span><span class="token number">0</span>      <span class="token comment" spellcheck="true">! Assume not direct comp system</span>
<span class="token number">24300</span>         !
<span class="token number">24310</span>       <span class="token keyword">IF</span> <span class="token operator">NOT</span> Typendevice <span class="token keyword">THEN</span> Deltas<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">.365</span><span class="token operator">+</span><span class="token number">.105</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">! Uncert in eff of std, old std ( not Fred clague's), for Non-typeN devices</span>
<span class="token number">24320</span>       <span class="token keyword">IF</span> Typendevice<span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">THEN</span> Deltas<span class="token operator">=</span><span class="token number">.0103</span><span class="token operator">*</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">.582</span>    <span class="token comment" spellcheck="true">! 3.5 mm below 18 GHz.</span>
<span class="token number">24330</span>       <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"62"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"90"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Deltas<span class="token operator">=</span><span class="token number">.5</span>    <span class="token comment" spellcheck="true">! WR-62 &amp; 90 below 18 GHz.</span>
<span class="token number">24340</span>         !
<span class="token number">24350</span>       <span class="token keyword">IF</span> Typendevice<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>     <span class="token comment" spellcheck="true">! Uncerts from F.Clague calorimeter mount</span>
<span class="token number">24360</span>         <span class="token keyword">IF</span> Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">.05</span> <span class="token keyword">THEN</span> Deltas<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">.365</span><span class="token operator">+</span><span class="token number">.105</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! Uncert in eff of std, old std ( not Fred clague's)</span>
<span class="token number">24365</span>         <span class="token keyword">IF</span> Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">.05</span> <span class="token keyword">THEN</span> Deltas<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">.24</span><span class="token operator">+</span><span class="token number">.00346</span><span class="token operator">*</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">.000453</span><span class="token operator">*</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>         <span class="token comment" spellcheck="true">! FRED CLAGUE MOUNT UNCERT  CN05 adjusted by T. Crowley 8/16/01  !RAG</span>
<span class="token number">24370</span>    <span class="token comment" spellcheck="true">!    IF Freq(Eafreq)&gt;=.05 THEN Deltas=.09+.00267*Freq(Eafreq)+.000223*Freq(Eafreq)^2         ! FRED CLAGUE MOUNT UNCERT  CN05  - old format</span>
<span class="token number">24380</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">24390</span>         !
<span class="token number">24400</span>       File<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! One file only on direct comparison</span>
<span class="token number">24410</span>       <span class="token keyword">IF</span> Cav<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>File<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> Directcomp<span class="token operator">=</span><span class="token number">1</span>    <span class="token comment" spellcheck="true">! Pinc std=0 on direct comparison system</span>
<span class="token number">24420</span>       <span class="token function">Pos</span><span class="token operator">=</span>Pwrstd<span class="token punctuation">(</span>File<span class="token punctuation">,</span>Arrayplace<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! = Uncert in mismatch term if direct comparison system was used.</span>
<span class="token number">24430</span>         !
<span class="token number">24440</span>       <span class="token keyword">IF</span> <span class="token operator">NOT</span> Directcomp <span class="token keyword">THEN</span>
<span class="token number">24450</span>         Effsysterr<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Deltas<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">.2</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Type N &amp; 7 mm</span>
<span class="token number">24460</span>         <span class="token keyword">IF</span> Typendevice<span class="token operator">=</span><span class="token number">3</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"62"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"90"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Effsysterr<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Deltas <span class="token comment" spellcheck="true">! 3.5 mm OR WR62/90 FOR &lt;18 GHz</span>
<span class="token number">24470</span>       <span class="token keyword">ELSE</span>              <span class="token comment" spellcheck="true">! Measured on direct comparison system</span>
<span class="token number">24480</span>         Deltas<span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Deltas<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token function">Pos</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">.1</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! .1 % uncert due to nonlinearity, &amp; Pos= mismatch term</span>
<span class="token number">24490</span>         <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Connector$<span class="token punctuation">,</span><span class="token string">"7"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Deltas<span class="token operator">=</span><span class="token number">.1223</span><span class="token operator">+</span><span class="token number">.0076</span><span class="token operator">*</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! 7mmm</span>
<span class="token number">24500</span>         Effsysterr<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Deltas
<span class="token number">24510</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">24511</span>       Effsysterr<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Effsysterr<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span>    <span class="token comment" spellcheck="true">! Adjusted to be in numeric instead of percentage form    !RAG</span>
<span class="token number">24520</span>     <span class="token keyword">NEXT</span> Eafreq
<span class="token number">24530</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">24540</span> SUBEND          <span class="token comment" spellcheck="true">!.............Systuncerteff................</span>


<span class="token number">24550</span> Uncert<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Uncert<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numvars<span class="token punctuation">,</span>Ps<span class="token punctuation">,</span>Va<span class="token punctuation">,</span>Sl<span class="token punctuation">,</span>Ss<span class="token punctuation">,</span>Mag<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connavg<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Var<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Diff<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>C$<span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Fileavg<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>R<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">24560</span>  <span class="token comment" spellcheck="true">! COMPUTE Sc, Snist (TYPE A), Systematic (TYPE B) , and total uncerts</span>
<span class="token number">24570</span>  !
<span class="token number">24580</span>  <span class="token comment" spellcheck="true">! INPUT: Avgs(*)= Final averages for each freq, each variable.</span>
<span class="token number">24590</span>  <span class="token comment" spellcheck="true">!        Numvars= # of variables for the device type (e.g. for </span><span class="token string">"1-port"</span><span class="token punctuation">,</span>
<span class="token number">24600</span>  <span class="token comment" spellcheck="true">!            Numvars=2, for |Gamma| and Arg(Gamma)</span>
<span class="token number">24610</span>  <span class="token comment" spellcheck="true">!        Ps=1 if device is a phase shifter (variable 2-port device)</span>
<span class="token number">24620</span>  <span class="token comment" spellcheck="true">!        Va=1 if device is a variable attenuator (variable 2-port device)</span>
<span class="token number">24630</span>  <span class="token comment" spellcheck="true">!        Sl=1 if device is a sliding load (variable 1-port)</span>
<span class="token number">24640</span>  <span class="token comment" spellcheck="true">!        Ss=1 if device is a sliding short (variable 1-port)</span>
<span class="token number">24650</span>  <span class="token comment" spellcheck="true">!        Mag(*) has mags of variable settings measured, if Ps or Va=1</span>
<span class="token number">24660</span>  <span class="token comment" spellcheck="true">!        Connavg(*)= averages for each freq, file, connect, variable.</span>
<span class="token number">24670</span>  <span class="token comment" spellcheck="true">!        Var(*)= variance between connect &amp; file averages.</span>
<span class="token number">24680</span>  <span class="token comment" spellcheck="true">!        Diff(*)= differences squared between connect &amp; file avgs</span>
<span class="token number">24690</span>  <span class="token comment" spellcheck="true">!        C$= type of connectors measured</span>
<span class="token number">24700</span>  <span class="token comment" spellcheck="true">!        Sport(*)= which port (direction, 1 or 2) for each file.</span>
<span class="token number">24710</span>  <span class="token comment" spellcheck="true">!        Fileavg(*)= averages for each freq, file, variable.</span>
<span class="token number">24720</span>  <span class="token comment" spellcheck="true">!        Pwrstd(*)= data for power std used for power calibration, if</span>
<span class="token number">24730</span>  <span class="token comment" spellcheck="true">!             device is a power device (</span><span class="token string">"Thermistor"</span> <span class="token operator">or</span> <span class="token string">"DryCal"</span><span class="token punctuation">)</span>
<span class="token number">24740</span>  <span class="token comment" spellcheck="true">!        R(*) contains uncertainties for Gamma if the device was</span>
<span class="token number">24750</span>  <span class="token comment" spellcheck="true">!          measured on the direct comparison system.</span>
<span class="token number">24760</span>  !
<span class="token number">24770</span>  <span class="token comment" spellcheck="true">! OUTPUT: Sc(*)= Short term (connector) uncertainty for each freq, each</span>
<span class="token number">24780</span>  <span class="token comment" spellcheck="true">!             variable.</span>
<span class="token number">24790</span>  <span class="token comment" spellcheck="true">!         Snist(*)= long term (between cals) uncert each freq, variable</span>
<span class="token number">24800</span>  <span class="token comment" spellcheck="true">!         Syst(*)= systematic uncertainty for each freq, each variable</span>
<span class="token number">24810</span>  <span class="token comment" spellcheck="true">!         Totuncert(*)= total uncert for each freq, each variable.</span>
<span class="token number">24820</span>  !
<span class="token number">24830</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">24840</span>   <span class="token function">DEG</span>
<span class="token number">24850</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">24860</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">24870</span>   !
<span class="token number">24880</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Numsets<span class="token operator">=</span>Numrepeats  <span class="token comment" spellcheck="true">! # settings</span>
<span class="token number">24890</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Numsets<span class="token operator">=</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! 1 setting for fixed device</span>
<span class="token number">24900</span>   ALLOCATE Random<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numsets<span class="token punctuation">,</span>Numvars<span class="token punctuation">)</span>
<span class="token number">24910</span>   Numfiles<span class="token operator">=</span><span class="token function">SIZE</span><span class="token punctuation">(</span>Sport<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Total # of files read in.</span>
<span class="token number">24920</span>   !
<span class="token number">24930</span>     <span class="token comment" spellcheck="true">! COMPUTE SHORT-TERM (CONNECTOR) UNCERTAINTY Sc   TYPE A</span>
<span class="token number">24940</span>     <span class="token comment" spellcheck="true">! Sc for a sliding load (1-portV, Sl=1) was computed in SUB</span>
<span class="token number">24950</span>     <span class="token comment" spellcheck="true">!  Avgslidterm.</span>
<span class="token number">24960</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> Sl <span class="token keyword">THEN</span> <span class="token keyword">CALL</span> Sc<span class="token punctuation">(</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Ps<span class="token punctuation">,</span>Va<span class="token punctuation">,</span>Ss<span class="token punctuation">,</span>Numvars<span class="token punctuation">,</span>Connavg<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Var<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Diff<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">24970</span>   !
<span class="token number">24980</span>   <span class="token comment" spellcheck="true">!  On the direct comparison system, Gamma info is supplied &amp; is the</span>
<span class="token number">24990</span>   <span class="token comment" spellcheck="true">!  same for all connects, so Sc(*) will contain 0's for Sc of the gammas</span>
<span class="token number">25000</span>   <span class="token comment" spellcheck="true">!  .  Store proper Sc info from the R(*) array.</span>
<span class="token number">25010</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> Ps <span class="token operator">AND</span> <span class="token operator">NOT</span> Va <span class="token keyword">THEN</span>
<span class="token number">25020</span>     <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs
<span class="token number">25030</span>       <span class="token keyword">IF</span> PROUND<span class="token punctuation">(</span>Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">-5</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator">AND</span> PROUND<span class="token punctuation">(</span>Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">-5</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Sc for |Gamma| &amp; Arg(Gamma)=0</span>
<span class="token number">25040</span>         Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>R<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Sc for Gamma was stored in</span>
<span class="token number">25050</span>         Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span>R<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! the meas results files for</span>
<span class="token number">25060</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">25070</span>     <span class="token keyword">NEXT</span> Eafreq      <span class="token comment" spellcheck="true">! measurements done on the direct comp system.</span>
<span class="token number">25080</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">25090</span>   !
<span class="token number">25100</span>     <span class="token comment" spellcheck="true">!                        TYPE A</span>
<span class="token number">25110</span>     <span class="token comment" spellcheck="true">! COMPUTE LONG TERM (BETWEEN CALS) UNCERTAINTY Snist</span>
<span class="token number">25120</span>     !
<span class="token number">25130</span>   <span class="token keyword">CALL</span> Snist<span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span>Numsets<span class="token punctuation">,</span>C$<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numvars<span class="token punctuation">,</span>Ps<span class="token punctuation">,</span>Va<span class="token punctuation">,</span>Sl<span class="token punctuation">,</span>Ss<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">25140</span>   !
<span class="token number">25150</span>     <span class="token comment" spellcheck="true">!                    TYPE A TOTAL</span>
<span class="token number">25160</span>     <span class="token comment" spellcheck="true">! COMPUTE TOTAL RANDOM UNCERTAINTY AS THE COMBINATION OF Snist &amp; Sc</span>
<span class="token number">25170</span>     <span class="token comment" spellcheck="true">! FOR FIXED DEVICES, AND THE COMBINATION OF Sc FOR THE jTH CONNECT &amp;</span>
<span class="token number">25180</span>     <span class="token comment" spellcheck="true">! Sc FOR THE 0 REFERENCE AND Snist FOR A VARIABLE 2-PORT DEVICE</span>
<span class="token number">25190</span>     !
<span class="token number">25200</span>   <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs
<span class="token number">25210</span>     Numfiles<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! # of files this frequency</span>
<span class="token number">25220</span>     <span class="token keyword">IF</span> Meastype$<span class="token operator">&lt;&gt;</span><span class="token string">"2-portV"</span> <span class="token keyword">THEN</span>      <span class="token comment" spellcheck="true">! Fixed device, and sliding terms.</span>
<span class="token number">25230</span>       Divby<span class="token operator">=</span>Numconnects<span class="token operator">*</span>Numfiles
<span class="token number">25240</span>       <span class="token keyword">IF</span> Sl <span class="token keyword">THEN</span> Divby<span class="token operator">=</span>Numfiles    <span class="token comment" spellcheck="true">! Sliding load</span>
<span class="token number">25250</span>       <span class="token keyword">FOR</span> Eavar<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numvars
<span class="token number">25260</span>         Random<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">/</span>Divby<span class="token punctuation">)</span>
<span class="token number">25270</span>       <span class="token keyword">NEXT</span> Eavar
<span class="token number">25280</span>       !
<span class="token number">25290</span>     <span class="token keyword">ELSE</span>   <span class="token comment" spellcheck="true">! VARIABLE 2-port DEVICE</span>
<span class="token number">25300</span>       <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">TO</span> Numsets   <span class="token comment" spellcheck="true">! All but the 0 reference setting</span>
<span class="token number">25310</span>         <span class="token keyword">FOR</span> Eavar<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numvars
<span class="token number">25320</span>           Random<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Var<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Var<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>Numconnects<span class="token operator">*</span>Numfiles<span class="token punctuation">)</span><span class="token operator">+</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">25330</span>         <span class="token keyword">NEXT</span> Eavar
<span class="token number">25340</span>       <span class="token keyword">NEXT</span> Easet
<span class="token number">25350</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">25360</span>   <span class="token keyword">NEXT</span> Eafreq
<span class="token number">25370</span>     !
<span class="token number">25380</span>     <span class="token comment" spellcheck="true">! COMPUTE SYSTEMATIC UNCERTAINTIES     TYPE B</span>
<span class="token number">25390</span>     !
<span class="token number">25400</span>   <span class="token keyword">IF</span> Sl <span class="token keyword">THEN</span> Numsets<span class="token operator">=</span><span class="token number">1</span>    <span class="token comment" spellcheck="true">! Sliding load does circle fit to get 1 value</span>
<span class="token number">25410</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"T"</span><span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token keyword">CALL</span> Syst1or2port<span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span>C$<span class="token punctuation">,</span>Numvars<span class="token punctuation">,</span>Numsets<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Ps<span class="token punctuation">,</span>Va<span class="token punctuation">,</span>Sl<span class="token punctuation">,</span>Ss<span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! 1- and 2-ports</span>
<span class="token number">25420</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"T"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token keyword">CALL</span> Systpower<span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>C$<span class="token punctuation">,</span>Numvars<span class="token punctuation">,</span>Numsets<span class="token punctuation">,</span>Fileavg<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">25430</span>     !
<span class="token number">25440</span>     <span class="token comment" spellcheck="true">! COMPUTE TOTAL UNCERTAINTY   :   RSS OF TYPE A &amp; B, W/ COVERAGE OF 2</span>
<span class="token number">25450</span>     !
<span class="token number">25460</span>   <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs
<span class="token number">25470</span>     <span class="token keyword">FOR</span> Eavar<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numvars
<span class="token number">25480</span>       <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numsets
<span class="token number">25490</span>         Totuncert<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span>Random<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">25500</span>         <span class="token keyword">IF</span> Totuncert<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">180</span> <span class="token keyword">THEN</span> Totuncert<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Eavar<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">180</span>
<span class="token number">25510</span>       <span class="token keyword">NEXT</span> Easet
<span class="token number">25520</span>     <span class="token keyword">NEXT</span> Eavar
<span class="token number">25530</span>   <span class="token keyword">NEXT</span> Eafreq
<span class="token number">25540</span> SUBEND    <span class="token comment" spellcheck="true">!.............Uncert.......................</span>


<span class="token number">25550</span> Printtables<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Printtables<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">25560</span>  <span class="token comment" spellcheck="true">! Print tables of final averages &amp; uncertainties.</span>
<span class="token number">25570</span>  !
<span class="token number">25580</span>  <span class="token comment" spellcheck="true">! INPUT: Avgs(*)= final averages for each freq, variable.</span>
<span class="token number">25590</span>  <span class="token comment" spellcheck="true">!        Sc(*)= short term uncert Sc for each freq, variable.</span>
<span class="token number">25600</span>  <span class="token comment" spellcheck="true">!        Snist(*)= long term Snist for each freq, variable</span>
<span class="token number">25610</span>  <span class="token comment" spellcheck="true">!        Syst(*)= systematic term Delta for each freq, variable.</span>
<span class="token number">25620</span>  <span class="token comment" spellcheck="true">!        Totuncert(*)= total uncert for each freq, variable.</span>
<span class="token number">25630</span>  <span class="token comment" spellcheck="true">!        Mags(*)= array of setting values, if device is variable</span>
<span class="token number">25640</span>  <span class="token comment" spellcheck="true">!        @Prt= I/O path to assigned system printer</span>
<span class="token number">25650</span>  <span class="token comment" spellcheck="true">!        Smoothed= # of points averaged to smooth 8510/360 S12, S21</span>
<span class="token number">25660</span>  <span class="token comment" spellcheck="true">!              data.  =0 ifno smoothing was done</span>
<span class="token number">25670</span>  !
<span class="token number">25680</span>  <span class="token comment" spellcheck="true">! OUTPUT: Tables (same as will be merged into customer's reports) printed</span>
<span class="token number">25690</span>  !
<span class="token number">25700</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">25710</span>   <span class="token function">DEG</span>
<span class="token number">25720</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">25730</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">25731</span>   !
<span class="token number">25750</span>   <span class="token function">SELECT</span> Meastype$
<span class="token number">25760</span>   <span class="token keyword">CASE</span> <span class="token string">"1-port"</span>
<span class="token number">25770</span>     <span class="token keyword">CALL</span> Printtableg<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">)</span>
<span class="token number">25780</span>   <span class="token keyword">CASE</span> <span class="token string">"1-portV"</span>   <span class="token comment" spellcheck="true">! Sliding termination</span>
<span class="token number">25790</span>     <span class="token keyword">CALL</span> Printtableslid<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">)</span>
<span class="token number">25800</span>   <span class="token keyword">CASE</span> <span class="token string">"2-port"</span><span class="token punctuation">,</span><span class="token string">"2-portNR"</span>
<span class="token number">25810</span>     <span class="token keyword">CALL</span> Printtablesij<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">25820</span>   <span class="token keyword">CASE</span> <span class="token string">"2-portV"</span>   <span class="token comment" spellcheck="true">! Variable attenuator, or phase shifter</span>
<span class="token number">25830</span>     <span class="token keyword">CALL</span> Printtablesijv<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">25840</span>   <span class="token keyword">CASE</span> <span class="token string">"2-portVNR"</span>
<span class="token number">25850</span>   <span class="token keyword">CASE</span> <span class="token string">"Thermistor"</span><span class="token punctuation">,</span><span class="token string">"DryCal"</span>
<span class="token number">25860</span>     <span class="token keyword">CALL</span> Printtablepower<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">)</span>
<span class="token number">25870</span>   <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">25880</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! Page feed</span>
<span class="token number">25890</span> SUBEND   <span class="token comment" spellcheck="true">!...........Printtables.......................</span>


<span class="token number">25900</span> Printtableg<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Printtableg<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">)</span>
<span class="token number">25910</span>   <span class="token function">DEG</span>
<span class="token number">25920</span>   <span class="token comment" spellcheck="true">! Print final results for 1-port devices</span>
<span class="token number">25930</span>   <span class="token comment" spellcheck="true">! INPUT: Avgs(*)= average Gamma for each freq. Sc(*)= connector std dev</span>
<span class="token number">25940</span>   <span class="token comment" spellcheck="true">!      ea freq, Snist= calibration std dev ea freq, Systuncert(*)=</span>
<span class="token number">25950</span>   <span class="token comment" spellcheck="true">!      systematic uncert ea freq, Totuncert(*)= total uncert ea freq</span>
<span class="token number">25960</span>   !
<span class="token number">25970</span>   <span class="token comment" spellcheck="true">! OUTPUT: Table of final results is printed.  This is same table that</span>
<span class="token number">25980</span>   <span class="token comment" spellcheck="true">!         will be stored in the ASCII file used for customer reports.</span>
<span class="token number">25990</span>   !
<span class="token number">26000</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">26010</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$[<span class="token number">10</span>]<span class="token punctuation">,</span>Devicedescript$<span class="token punctuation">,</span>Oneportonly
<span class="token number">26020</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">26030</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">26040</span>!
<span class="token number">26050</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"DEVICE DESCRIPTION: "</span><span class="token punctuation">;</span>Devicedescript$
<span class="token number">26060</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                    "</span><span class="token punctuation">;</span>Nisttestno$<span class="token punctuation">;</span><span class="token string">"  TYPE = "</span><span class="token punctuation">;</span>Meastype$
<span class="token number">26070</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">26080</span>   !
<span class="token number">26090</span>   <span class="token keyword">IF</span> Numfreqs<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! See if operator would like to skip some printing.</span>
<span class="token number">26100</span>     <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token function">VAL$</span><span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"freqs --  Do you want to SKIP PRINTING some freqs?"</span><span class="token punctuation">,</span>Skpprt<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">26110</span>     <span class="token keyword">IF</span> Skpprt <span class="token keyword">THEN</span>
<span class="token number">26120</span>       <span class="token keyword">INPUT</span> <span class="token string">"Enter # to skip (e.g. Enter 5 to print freqs # 1, 7, 13, ...)"</span><span class="token punctuation">,</span>Skipnum
<span class="token number">26130</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" SKIPPING "</span><span class="token punctuation">;</span>Skipnum<span class="token punctuation">;</span><span class="token string">" FREQUENCIES..."</span>
<span class="token number">26140</span>       Skipnum<span class="token operator">=</span>Skipnum<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">26150</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">26160</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">26170</span>   Skipit<span class="token operator">=</span><span class="token number">0</span>    <span class="token comment" spellcheck="true">! Flag to print or not</span>
<span class="token number">26180</span>   !
<span class="token number">26190</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                                 TABLE 1 - GAMMA"</span>
<span class="token number">26200</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"--------------------------------------------------------------------------------"</span>
<span class="token number">26210</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">26220</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                MAGNITUDE                                   PHASE"</span>
<span class="token number">26230</span> <span class="token comment" spellcheck="true">! Print table column titles</span>
<span class="token number">26240</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">26250</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"FREQ.   MEAN  TYPE   TYPE A  TYPE A  U     MEAN         TYPE A  TYPE A  U"</span>
<span class="token number">26260</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" GHz    VALUE    B   (Snist)  (Sc)    T    VALUE    B   (Snist)  (Sc)    T"</span>
<span class="token number">26270</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">26280</span>   !
<span class="token number">26290</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs  <span class="token comment" spellcheck="true">! Each freq</span>
<span class="token number">26300</span>     <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! Print this freq</span>
<span class="token number">26310</span>       Avg1<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">26320</span>       Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">26330</span>       Snist1<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">26340</span>       Sc1<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">26350</span>       Total1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">26360</span>       Avg2<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">26370</span>       Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">26380</span>       Snist2<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">26390</span>       Sc2<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">26400</span>       Total2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">26410</span>       <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> A<span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avg1<span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist1<span class="token punctuation">,</span>Sc1<span class="token punctuation">,</span>Total1<span class="token punctuation">,</span>Avg2<span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist2<span class="token punctuation">,</span>Sc2<span class="token punctuation">,</span>Total2
<span class="token number">26420</span> A<span class="token punctuation">:</span>    <span class="token function">IMAGE</span> <span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span> X<span class="token punctuation">,</span>M3D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.<span class="token number">2</span>D
<span class="token number">26430</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span> <span class="token comment" spellcheck="true">! Increment for next freq</span>
<span class="token number">26440</span>     <span class="token keyword">ELSE</span>
<span class="token number">26450</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">26460</span>         Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">26470</span>         <span class="token keyword">IF</span> Skipit<span class="token operator">=</span>Skipnum <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span>    <span class="token comment" spellcheck="true">! Reset flag to print next one</span>
<span class="token number">26480</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">26490</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">26500</span>   <span class="token keyword">NEXT</span> I
<span class="token number">26510</span> SUBEND  <span class="token comment" spellcheck="true">!.........Printtableg...................</span>


<span class="token number">26520</span> Printtablesij<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Printtablesij<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">26530</span>   <span class="token function">DEG</span>
<span class="token number">26540</span>   <span class="token comment" spellcheck="true">! Print final results tables for 2-port devices: S11, S12, S22 for</span>
<span class="token number">26550</span>   <span class="token comment" spellcheck="true">!    reciprocal device, S11, S12, S21, S22 for non-reciprocal</span>
<span class="token number">26560</span>   <span class="token comment" spellcheck="true">! INPUT: Avgs(*)= average Sij for each freq. Sc(*)= connector std dev</span>
<span class="token number">26570</span>   <span class="token comment" spellcheck="true">!      ea freq, Snist= calibration std dev ea freq, Systuncert(*)=</span>
<span class="token number">26580</span>   <span class="token comment" spellcheck="true">!      systematic uncert ea freq, Totuncert(*)= total uncert ea freq</span>
<span class="token number">26590</span>   !
<span class="token number">26600</span>   <span class="token comment" spellcheck="true">! OUTPUT: Table of final results is printed, which is the same as</span>
<span class="token number">26610</span>   <span class="token comment" spellcheck="true">!         the table that will be stored in one of the ASCII files</span>
<span class="token number">26620</span>   <span class="token comment" spellcheck="true">!         to be merged into the customer report.</span>
<span class="token number">26630</span>   !
<span class="token number">26640</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">26650</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$[<span class="token number">10</span>]<span class="token punctuation">,</span>Devicedescript$<span class="token punctuation">,</span>Oneportonly
<span class="token number">26660</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">26670</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">26680</span>!
<span class="token number">26690</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"DEVICE DESCRIPTION: "</span><span class="token punctuation">;</span>Devicedescript$
<span class="token number">26700</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                    "</span><span class="token punctuation">;</span>Nisttestno$<span class="token punctuation">;</span><span class="token string">"  TYPE = "</span><span class="token punctuation">;</span>Meastype$
<span class="token number">26710</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">26720</span>   <span class="token keyword">IF</span> Smoothed <span class="token keyword">THEN</span>
<span class="token number">26730</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"S12 (S21) DATA SMOOTHED FOR 8510/360:  average of "</span><span class="token punctuation">;</span>Smoothed<span class="token punctuation">;</span><span class="token string">" points."</span>
<span class="token number">26740</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">26750</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">26760</span>   !
<span class="token number">26770</span>   <span class="token keyword">IF</span> Numfreqs<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! See if operator would like to skip some printing.</span>
<span class="token number">26780</span>     <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token function">VAL$</span><span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"freqs --  Do you want to SKIP PRINTING some freqs?"</span><span class="token punctuation">,</span>Skpprt<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">26790</span>     <span class="token keyword">IF</span> Skpprt <span class="token keyword">THEN</span>
<span class="token number">26800</span>       <span class="token keyword">INPUT</span> <span class="token string">"Enter # to skip (e.g. Enter 5 to print freqs # 1, 7, 13, ...)"</span><span class="token punctuation">,</span>Skipnum
<span class="token number">26810</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" SKIPPING "</span><span class="token punctuation">;</span>Skipnum<span class="token punctuation">;</span><span class="token string">" FREQUENCIES..."</span>
<span class="token number">26820</span>       Skipnum<span class="token operator">=</span>Skipnum<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">26830</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">26840</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">26850</span>   Skipit<span class="token operator">=</span><span class="token number">0</span>    <span class="token comment" spellcheck="true">! Flag to print or not</span>
<span class="token number">26860</span>   !
<span class="token number">26870</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                                 TABLE 1 - S11"</span>
<span class="token number">26880</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"--------------------------------------------------------------------------------"</span>
<span class="token number">26890</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">26900</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                MAGNITUDE                                   PHASE"</span>
<span class="token number">26910</span>   <span class="token keyword">GOSUB</span> Printcoltitles
<span class="token number">26920</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs  <span class="token comment" spellcheck="true">! Each freq</span>
<span class="token number">26930</span>     <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Print this freq</span>
<span class="token number">26940</span>       Avg1<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">26950</span>       Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">26960</span>       Snist1<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">26970</span>       Sc1<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">26980</span>       Total1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">26990</span>       Avg2<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">27000</span>       Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">27010</span>       Snist2<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">27020</span>       Sc2<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">27030</span>       Total2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">27040</span>       <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> <span class="token number">27050</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avg1<span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist1<span class="token punctuation">,</span>Sc1<span class="token punctuation">,</span>Total1<span class="token punctuation">,</span>Avg2<span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist2<span class="token punctuation">,</span>Sc2<span class="token punctuation">,</span>Total2
<span class="token number">27050</span>       <span class="token function">IMAGE</span> <span class="token number">3</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span> X<span class="token punctuation">,</span>M3D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D
<span class="token number">27060</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">27070</span>     <span class="token keyword">ELSE</span>
<span class="token number">27080</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">27090</span>         Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">27100</span>         <span class="token keyword">IF</span> Skipit<span class="token operator">=</span>Skipnum <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token comment" spellcheck="true">! Reset flag to print next one</span>
<span class="token number">27110</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">27120</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">27130</span>   <span class="token keyword">NEXT</span> I
<span class="token number">27140</span>  !
<span class="token number">27150</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">27160</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">27170</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                                 TABLE 2 - S22"</span>
<span class="token number">27180</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"--------------------------------------------------------------------------------"</span>
<span class="token number">27190</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">27200</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                MAGNITUDE                                   PHASE"</span>
<span class="token number">27210</span>   <span class="token keyword">GOSUB</span> Printcoltitles
<span class="token number">27220</span>   Skipit<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">27230</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs <span class="token comment" spellcheck="true">! Each freq</span>
<span class="token number">27240</span>     <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">27250</span>       Avg1<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token number">27260</span>       Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token number">27270</span>       Snist1<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token number">27280</span>       Sc1<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token number">27290</span>       Total1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token number">27300</span>       Avg2<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">27310</span>       Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">27320</span>       Snist2<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">27330</span>       Sc2<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">27340</span>       Total2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">27350</span>       <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> <span class="token number">27360</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avg1<span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist1<span class="token punctuation">,</span>Sc1<span class="token punctuation">,</span>Total1<span class="token punctuation">,</span>Avg2<span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist2<span class="token punctuation">,</span>Sc2<span class="token punctuation">,</span>Total2
<span class="token number">27360</span>       <span class="token function">IMAGE</span> <span class="token number">3</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span> X<span class="token punctuation">,</span>M3D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D
<span class="token number">27370</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">27380</span>     <span class="token keyword">ELSE</span>
<span class="token number">27390</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">27400</span>         Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">27410</span>         <span class="token keyword">IF</span> Skipit<span class="token operator">=</span>Skipnum <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token comment" spellcheck="true">! Reset flag to print next one</span>
<span class="token number">27420</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">27430</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">27440</span>   <span class="token keyword">NEXT</span> I
<span class="token number">27450</span>   !
<span class="token number">27460</span>   Skipit<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">27470</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">27480</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">27490</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                                 TABLE 3 - S12 "</span>
<span class="token number">27500</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"--------------------------------------------------------------------------------"</span>
<span class="token number">27510</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">27520</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"             MAGNITUDE - dB                                 PHASE"</span>
<span class="token number">27530</span>   <span class="token keyword">GOSUB</span> Printcoltitles
<span class="token number">27540</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs  <span class="token comment" spellcheck="true">! Each freq</span>
<span class="token number">27550</span>     <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">27560</span>       Avg1<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">27570</span>       Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">27580</span>       Snist1<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">27590</span>       Sc1<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">27600</span>       Total1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">27610</span>       Avg2<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">27620</span>       Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">27630</span>       Snist2<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">27640</span>       Sc2<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">27650</span>       Total2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">27660</span>       <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> <span class="token number">27670</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avg1<span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist1<span class="token punctuation">,</span>Sc1<span class="token punctuation">,</span>Total1<span class="token punctuation">,</span>Avg2<span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist2<span class="token punctuation">,</span>Sc2<span class="token punctuation">,</span>Total2
<span class="token number">27670</span>       <span class="token function">IMAGE</span> <span class="token number">3</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span> X<span class="token punctuation">,</span>M3D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D
<span class="token number">27680</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">27690</span>     <span class="token keyword">ELSE</span>
<span class="token number">27700</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">27710</span>         Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">27720</span>         <span class="token keyword">IF</span> Skipit<span class="token operator">=</span>Skipnum <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token comment" spellcheck="true">! Reset flag to print next one</span>
<span class="token number">27730</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">27740</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">27750</span>   <span class="token keyword">NEXT</span> I
<span class="token number">27760</span>   !
<span class="token number">27770</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"NR"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! NON-RECIPROCAL</span>
<span class="token number">27780</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">27790</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">27800</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                                 TABLE 3 - S21 "</span>
<span class="token number">27810</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"--------------------------------------------------------------------------------"</span>
<span class="token number">27820</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">27830</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"             MAGNITUDE - dB                                 PHASE"</span>
<span class="token number">27840</span>     <span class="token keyword">GOSUB</span> Printcoltitles
<span class="token number">27850</span>     Skipit<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">27860</span>     <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs<span class="token comment" spellcheck="true">! Each freq</span>
<span class="token number">27870</span>       <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">27880</span>         Avg1<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token number">27890</span>         Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token number">27900</span>         Snist1<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token number">27910</span>         Sc1<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token number">27920</span>         Total1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token number">27930</span>         Avg2<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token number">27940</span>         Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token number">27950</span>         Snist2<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token number">27960</span>         Sc2<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token number">27970</span>         Total2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token number">27980</span>         <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> <span class="token number">27990</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avg1<span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist1<span class="token punctuation">,</span>Sc1<span class="token punctuation">,</span>Total1<span class="token punctuation">,</span>Avg2<span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist2<span class="token punctuation">,</span>Sc2<span class="token punctuation">,</span>Total2
<span class="token number">27990</span>         <span class="token function">IMAGE</span> <span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span> X<span class="token punctuation">,</span>M3D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D
<span class="token number">28000</span>         <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">28010</span>       <span class="token keyword">ELSE</span>
<span class="token number">28020</span>         <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">28030</span>           Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">28040</span>           <span class="token keyword">IF</span> Skipit<span class="token operator">=</span>Skipnum <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span><span class="token comment" spellcheck="true">! Reset flag to print next one</span>
<span class="token number">28050</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">28060</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">28070</span>     <span class="token keyword">NEXT</span> I
<span class="token number">28080</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">28090</span>   <span class="token keyword">GOTO</span> Endprint
<span class="token number">28100</span>     !
<span class="token number">28110</span> Printcoltitles<span class="token punctuation">:</span>      <span class="token comment" spellcheck="true">! Print table column titles</span>
<span class="token number">28120</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">28130</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"FREQ.   MEAN    U     U       U      U       MEAN    U     U      U     U"</span>
<span class="token number">28140</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" GHz    VALUE    B     A       D      C      VALUE    B     A      D     C"</span>
<span class="token number">28150</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">28160</span>   <span class="token keyword">RETURN</span>
<span class="token number">28170</span> Endprint<span class="token punctuation">:</span> !
<span class="token number">28180</span> SUBEND  <span class="token comment" spellcheck="true">!.........Printtablesij.................</span>


<span class="token number">28190</span> Printtablepower<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Printtablepower<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">)</span>
<span class="token number">28200</span>   <span class="token function">DEG</span>
<span class="token number">28210</span>   <span class="token comment" spellcheck="true">! Print tables for power devices: |Gamma|, efficiency, Calib factor Kb</span>
<span class="token number">28220</span>   <span class="token comment" spellcheck="true">! OUTPUT: Table of final results is printed.  This is same table that</span>
<span class="token number">28230</span>   <span class="token comment" spellcheck="true">!         will be stored in the ASCII file used for customer reports.</span>
<span class="token number">28240</span>   !
<span class="token number">28250</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">28260</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$[<span class="token number">10</span>]<span class="token punctuation">,</span>Devicedescript$<span class="token punctuation">,</span>Oneportonly
<span class="token number">28270</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">28280</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">28290</span>!
<span class="token number">28300</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"DEVICE DESCRIPTION: "</span><span class="token punctuation">;</span>Devicedescript$
<span class="token number">28310</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                    "</span><span class="token punctuation">;</span>Nisttestno$<span class="token punctuation">;</span><span class="token string">"    TYPE = "</span><span class="token punctuation">;</span>Meastype$
<span class="token number">28320</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">28330</span>   !
<span class="token number">28340</span>   <span class="token keyword">IF</span> Numfreqs<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! See if operator would like to skip some printing.</span>
<span class="token number">28350</span>     <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token function">VAL$</span><span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"freqs --  Do you want to SKIP PRINTING some freqs?"</span><span class="token punctuation">,</span>Skpprt<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">28360</span>     <span class="token keyword">IF</span> Skpprt <span class="token keyword">THEN</span>
<span class="token number">28370</span>       <span class="token keyword">INPUT</span> <span class="token string">"Enter # to skip (e.g. Enter 5 to print freqs # 1, 7, 13, ...)"</span><span class="token punctuation">,</span>Skipnum
<span class="token number">28380</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" SKIPPING "</span><span class="token punctuation">;</span>Skipnum<span class="token punctuation">;</span><span class="token string">" FREQUENCIES..."</span>
<span class="token number">28390</span>       Skipnum<span class="token operator">=</span>Skipnum<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">28400</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">28410</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">28420</span>   Skipit<span class="token operator">=</span><span class="token number">0</span>    <span class="token comment" spellcheck="true">! Flag to print or not</span>
<span class="token number">28430</span>   !
<span class="token number">28440</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                                 TABLE 1 - GAMMA"</span>
<span class="token number">28450</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"--------------------------------------------------------------------------------"</span>
<span class="token number">28460</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">28470</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                MAGNITUDE                                   PHASE"</span>
<span class="token number">28480</span>   <span class="token keyword">GOSUB</span> Printcoltitles    <span class="token comment" spellcheck="true">! Titles for data columns</span>
<span class="token number">28490</span>   !
<span class="token number">28500</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs  <span class="token comment" spellcheck="true">!Each frequency, print Gamma info</span>
<span class="token number">28510</span>     <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">28520</span>       Avg1<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">28530</span>       Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">28540</span>       Snist1<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">28550</span>       Sc1<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">28560</span>       Total1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">28570</span>       Avg2<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token number">28580</span>       Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token number">28590</span>       Snist2<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token number">28600</span>       Sc2<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token number">28610</span>       Total2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token number">28620</span>       <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> E<span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avg1<span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist1<span class="token punctuation">,</span>Sc1<span class="token punctuation">,</span>Total1<span class="token punctuation">,</span>Avg2<span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist2<span class="token punctuation">,</span>Sc2<span class="token punctuation">,</span>Total2
<span class="token number">28630</span> E<span class="token punctuation">:</span>    <span class="token function">IMAGE</span> <span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span>M3D.D<span class="token punctuation">,</span> X<span class="token punctuation">,</span>DD.D<span class="token punctuation">,</span> X<span class="token punctuation">,</span>DD.<span class="token number">2</span>D<span class="token punctuation">,</span> X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span> X<span class="token punctuation">,</span><span class="token number">4</span>D.D
<span class="token number">28640</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">28650</span>     <span class="token keyword">ELSE</span>
<span class="token number">28660</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">28670</span>         Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">28680</span>         <span class="token keyword">IF</span> Skipit<span class="token operator">=</span>Skipnum <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span><span class="token comment" spellcheck="true">! Reset flag to print next one</span>
<span class="token number">28690</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">28700</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">28710</span>   <span class="token keyword">NEXT</span> I
<span class="token number">28720</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">28730</span>  !
<span class="token number">28740</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">28750</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                                 TABLE 2"</span>
<span class="token number">28760</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"--------------------------------------------------------------------------------"</span>
<span class="token number">28770</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">28780</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"               EFFICIENCY                              CAL FACTOR"</span>
<span class="token number">28790</span>   <span class="token keyword">GOSUB</span> Printcoltitles
<span class="token number">28800</span>   Skipit<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">28810</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs  <span class="token comment" spellcheck="true">! Each freq, print efficiency &amp; Kb info</span>
<span class="token number">28820</span>     <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">28830</span>       Avg1<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">28840</span>       Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">28850</span>       Snist1<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">28860</span>       Sc1<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">28870</span>       Total1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">28880</span>       Avg2<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">28890</span>       Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">28900</span>       Snist2<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">28910</span>       Sc2<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">28920</span>       Total2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">28930</span>       <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> <span class="token number">28940</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avg1<span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist1<span class="token punctuation">,</span>Sc1<span class="token punctuation">,</span>Total1<span class="token punctuation">,</span>Avg2<span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist2<span class="token punctuation">,</span>Sc2<span class="token punctuation">,</span>Total2
<span class="token number">28940</span>       <span class="token function">IMAGE</span> <span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span> X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span> X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D
<span class="token number">28950</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">28960</span>     <span class="token keyword">ELSE</span>
<span class="token number">28970</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">28980</span>         Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">28990</span>         <span class="token keyword">IF</span> Skipit<span class="token operator">=</span>Skipnum <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span><span class="token comment" spellcheck="true">! Reset flag to print next one</span>
<span class="token number">29000</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">29010</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">29020</span>   <span class="token keyword">NEXT</span> I
<span class="token number">29030</span>   <span class="token keyword">GOTO</span> Sbend
<span class="token number">29040</span>   !
<span class="token number">29050</span> Printcoltitles<span class="token punctuation">:</span>      <span class="token comment" spellcheck="true">! Print column titles</span>
<span class="token number">29060</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">29070</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"FREQ.   MEAN   TYPE  TYPE A  TYPE A  U     MEAN   TYPE  TYPE A  TYPE A  U"</span>
<span class="token number">29080</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" GHz    VALUE    B   (Snist)  (Sc)    T    VALUE    B   (Snist)  (Sc)    T"</span>
<span class="token number">29090</span>   <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">29100</span>   <span class="token keyword">RETURN</span>
<span class="token number">29110</span> Sbend<span class="token punctuation">:</span> SUBEND <span class="token comment" spellcheck="true">!.........Printtablepower.............</span>


<span class="token number">29120</span> Storedata<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Storedata<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Nisttestno$<span class="token punctuation">,</span>Ctype$<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">29130</span>  <span class="token comment" spellcheck="true">! Create string arrays, store data in string  arrays, create ASCII files</span>
<span class="token number">29140</span>  <span class="token comment" spellcheck="true">!    &amp; store string array in ASCII files.</span>
<span class="token number">29150</span>  !
<span class="token number">29160</span>  <span class="token comment" spellcheck="true">! INPUT: Filename$(*)= file names of data files.</span>
<span class="token number">29170</span>  <span class="token comment" spellcheck="true">!        Numfreqs= # of freqs measured</span>
<span class="token number">29180</span>  <span class="token comment" spellcheck="true">!        Nisttestno$= device ID or test #.</span>
<span class="token number">29190</span>  <span class="token comment" spellcheck="true">!        Ctype$= abbreviated form of connector type used.</span>
<span class="token number">29200</span>  <span class="token comment" spellcheck="true">!        Avgs(*)= final averages for each freq, each variable</span>
<span class="token number">29210</span>  <span class="token comment" spellcheck="true">!        Sc(*)= short term Sc uncert for each freq, each variable</span>
<span class="token number">29220</span>  <span class="token comment" spellcheck="true">!        Snist(*)= long term Snist uncert for each freq, each variable.</span>
<span class="token number">29230</span>  <span class="token comment" spellcheck="true">!        Systuncert(*)= systematic uncert for each freq, each variable.</span>
<span class="token number">29240</span>  <span class="token comment" spellcheck="true">!        Totuncert(*)= total uncert for each freq, each variable</span>
<span class="token number">29250</span>  <span class="token comment" spellcheck="true">!        Mags(*)= magnitude of variable settings if device is variable</span>
<span class="token number">29260</span>  !
<span class="token number">29270</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">29280</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">29281</span>   <span class="token keyword">DIM</span> Buttons$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>[<span class="token number">5</span>]
<span class="token number">29290</span>   <span class="token function">DEG</span>
<span class="token number">29340</span>   DISP <span class="token string">"... STORING DATA FOR ASCII FILES ... "</span>
<span class="token number">29341</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Numsets<span class="token operator">=</span>Numrepeats
<span class="token number">29342</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Numsets<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">29343</span>   <span class="token keyword">IF</span> Meastype$<span class="token operator">=</span><span class="token string">"1-port"</span> <span class="token operator">AND</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">POS</span><span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"L"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token function">POS</span><span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"l"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token punctuation">(</span><span class="token function">POS</span><span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"R"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token punctuation">(</span><span class="token function">POS</span><span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> E8510<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">29344</span>   <span class="token keyword">IF</span> E8510 <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! See if need to make ASCII instead of HP-UX file</span>
<span class="token number">29345</span>     Buttons$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"NO"</span>
<span class="token number">29346</span>     Buttons$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"YES"</span>
<span class="token number">29347</span>     DIALOG <span class="token string">"QUESTION"</span><span class="token punctuation">,</span><span class="token string">"Will this Gamma file be used on the NEW DIRECT COMPARISON SYSTEM ?"</span><span class="token punctuation">,</span>Makeascii<span class="token punctuation">;</span><span class="token function">SET</span> <span class="token punctuation">(</span><span class="token string">"DIALOG BUTTONS"</span><span class="token punctuation">:</span>Buttons$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"PEN"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"X"</span><span class="token punctuation">:</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token string">"Y"</span><span class="token punctuation">:</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token number">29349</span>     <span class="token comment" spellcheck="true">!   CALL Keyques(</span><span class="token string">"Will this Gamma file be used on the Direct Comparison System?"</span><span class="token punctuation">,</span>Makeascii<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">29350</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">29351</span>   ALLOCATE Table1$<span class="token punctuation">(</span>Numfreqs<span class="token operator">*</span>Numsets<span class="token punctuation">)</span>[<span class="token number">99</span>]<span class="token punctuation">,</span>Table2$<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span>[<span class="token number">99</span>]<span class="token punctuation">,</span>Table3$<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span>[<span class="token number">99</span>]
<span class="token number">29352</span>   ALLOCATE Table1c$<span class="token punctuation">(</span>Numfreqs<span class="token operator">*</span>Numsets<span class="token punctuation">)</span>[<span class="token number">99</span>]<span class="token punctuation">,</span>Table2c$<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span>[<span class="token number">99</span>]<span class="token punctuation">,</span>Table3c$<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span>[<span class="token number">99</span>]
<span class="token number">29353</span>   ALLOCATE Db1port$<span class="token punctuation">(</span>Numfreqs<span class="token operator">*</span>Numsets<span class="token punctuation">)</span>[<span class="token number">100</span>]<span class="token punctuation">,</span>Db2port$<span class="token punctuation">(</span>Numfreqs<span class="token operator">*</span>Numsets<span class="token punctuation">)</span>[<span class="token number">180</span>]
<span class="token number">29360</span>   <span class="token function">SELECT</span> Meastype$
<span class="token number">29370</span>   <span class="token keyword">CASE</span> <span class="token string">"1-port"</span>
<span class="token number">29380</span>     <span class="token keyword">CALL</span> Storetable1<span class="token punctuation">(</span>Makeascii<span class="token punctuation">,</span>Ctype$<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">29390</span>   <span class="token keyword">CASE</span> <span class="token string">"1-portV"</span>
<span class="token number">29400</span>     <span class="token keyword">CALL</span> Storetabslid<span class="token punctuation">(</span>Ctype$<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">29410</span>   <span class="token keyword">CASE</span> <span class="token string">"2-port"</span><span class="token punctuation">,</span><span class="token string">"2-portV"</span><span class="token punctuation">,</span><span class="token string">"2-portNR"</span>
<span class="token number">29420</span>     <span class="token keyword">CALL</span> Storetable2<span class="token punctuation">(</span>Ctype$<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table2$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table3$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table2c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table3c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">29430</span>   <span class="token keyword">CASE</span> <span class="token string">"Thermistor"</span><span class="token punctuation">,</span><span class="token string">"DryCal"</span>
<span class="token number">29440</span>     <span class="token keyword">CALL</span> Storetablep<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Newdircomp<span class="token punctuation">,</span>Ctype$<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table2$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table2c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">29450</span>   <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">29460</span>   <span class="token keyword">CALL</span> Createandstore<span class="token punctuation">(</span>Makeascii<span class="token punctuation">,</span>E8510<span class="token punctuation">,</span>Nisttestno$<span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Meastype$<span class="token punctuation">,</span>Newdircomp<span class="token punctuation">,</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table2$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table3$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table2c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table3c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">29470</span> SUBEND <span class="token comment" spellcheck="true">!..........Storedata.............</span>


<span class="token number">29480</span> Storetable1<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Storetable1<span class="token punctuation">(</span>Makeascii<span class="token punctuation">,</span>Ctype$<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">29490</span>   <span class="token comment" spellcheck="true">! Store final data in string arrays for 1-ports.</span>
<span class="token number">29500</span>   !
<span class="token number">29510</span>   <span class="token comment" spellcheck="true">! INPUT: Ctype$= shortened version of connectors measured.</span>
<span class="token number">29520</span>   <span class="token comment" spellcheck="true">!        Avgs(*)= final average of variables for</span>
<span class="token number">29530</span>   <span class="token comment" spellcheck="true">!        each frequency.  Sc(*)= connector deviation for each freq,</span>
<span class="token number">29540</span>   <span class="token comment" spellcheck="true">!        Snist(*)= between cals deviation for each freq, Systuncert(*)=</span>
<span class="token number">29550</span>   <span class="token comment" spellcheck="true">!        systematic uncert for each freq, Totuncert(*)= total uncert</span>
<span class="token number">29560</span>   <span class="token comment" spellcheck="true">!        for each freq.</span>
<span class="token number">29570</span>   !
<span class="token number">29580</span>   <span class="token comment" spellcheck="true">! OUTPUT: Table1$(*)= data in table form for use in reports.</span>
<span class="token number">29590</span>   <span class="token comment" spellcheck="true">!         Db1port$(*)= data for use in data bases.</span>
<span class="token number">29600</span>   !
<span class="token number">29610</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">29620</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$[<span class="token number">10</span>]<span class="token punctuation">,</span>Devicedescript$<span class="token punctuation">,</span>Oneportonly
<span class="token number">29630</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">29640</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">29650</span>   <span class="token keyword">DIM</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>[<span class="token number">12</span>]<span class="token punctuation">,</span>S1$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>[<span class="token number">12</span>]
<span class="token number">29651</span>   !
<span class="token number">29660</span>   <span class="token keyword">IF</span> Makeascii <span class="token keyword">THEN</span>
<span class="token number">29661</span>     <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs<span class="token comment" spellcheck="true">! Each freq</span>
<span class="token number">29662</span>       Numfiles<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! # of files input for this freq</span>
<span class="token number">29663</span>       Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">29664</span>       Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">29665</span>       Tot1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">29666</span>       Tot2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">29670</span>       <span class="token function">OUTPUT</span> Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token keyword">USING</span> T1image<span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span>Tot2
<span class="token number">29671</span>       <span class="token function">OUTPUT</span> Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token keyword">USING</span> T1image<span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span><span class="token string">","</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span><span class="token string">","</span><span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span><span class="token string">","</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span><span class="token punctuation">,</span>Tot2
<span class="token number">29673</span> T1image<span class="token punctuation">:</span> <span class="token function">IMAGE</span> DD.<span class="token number">4</span>D<span class="token punctuation">,</span>A<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span>A<span class="token punctuation">,</span>M3D.<span class="token number">3</span>D<span class="token punctuation">,</span>A<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span>A<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span>A<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span>A<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span>A<span class="token punctuation">,</span><span class="token number">3</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span>A<span class="token punctuation">,</span><span class="token number">3</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span>A<span class="token punctuation">,</span><span class="token number">3</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span>A<span class="token punctuation">,</span><span class="token number">3</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span>#
<span class="token number">29677</span>     <span class="token comment" spellcheck="true">! OUTPUT Db1port$(I) USING 29678;Nisttestno$,Ctype$,Freq(I),Numfiles,Numconnects,Avgs(I,1,1),Snist(I,1,1),Sc(I,1,1),Avgs(I,1,2),Snist(I,1,2),Sc(I,1,2)</span>
<span class="token number">29678</span>     <span class="token comment" spellcheck="true">! IMAGE #,6A,1X,6A,1X,DD.3D,1X,DD,1X,DD,1X,D.5D,1X,D.5D,1X,D.5D,1X,M3D.3D,1X,3D.3D,1X,3D.3D,1X,3D.3D</span>
<span class="token number">29679</span>     <span class="token keyword">NEXT</span> I
<span class="token number">29680</span>     SUBEXIT
<span class="token number">29681</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">29682</span>   !
<span class="token number">29683</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs  <span class="token comment" spellcheck="true">! Each freq</span>
<span class="token number">29684</span>     Numfiles<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! # of files input for this freq</span>
<span class="token number">29690</span>     Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">29700</span>     Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">29710</span>     Tot1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">29720</span>     Tot2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">29730</span>     <span class="token keyword">CALL</span> Outputtable<span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">,</span>S$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot2<span class="token punctuation">)</span>
<span class="token number">29731</span>     <span class="token keyword">CALL</span> Outputtablecom<span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">,</span>S1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot2<span class="token punctuation">)</span>
<span class="token number">29740</span>     <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">11</span>
<span class="token number">29750</span>       Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>S$<span class="token punctuation">(</span>J<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Add new line to table</span>
<span class="token number">29751</span>       Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>TRIM$<span class="token punctuation">(</span>S1$<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Add new line to table</span>
<span class="token number">29760</span>     <span class="token keyword">NEXT</span> J
<span class="token number">29770</span>     Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">29771</span>     <span class="token keyword">IF</span> I<span class="token operator">&lt;</span>Numfreqs <span class="token keyword">THEN</span> Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">29780</span>   <span class="token comment" spellcheck="true">!  OUTPUT Db1port$(I) USING 29790;Nisttestno$,Ctype$,Freq(I),Numfiles,Numconnects,Avgs(I,1,1),Snist(I,1,1),Sc(I,1,1),Avgs(I,1,2),Snist(I,1,2),Sc(I,1,2)</span>
<span class="token number">29790</span>     <span class="token function">IMAGE</span> #<span class="token punctuation">,</span><span class="token number">6</span>A<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">6</span>A<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>DD.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>DD<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>DD<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>M3D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.<span class="token number">3</span>D
<span class="token number">29800</span>   <span class="token keyword">NEXT</span> I
<span class="token number">29810</span> SUBEND     <span class="token comment" spellcheck="true">!............Storetable1..............</span>


<span class="token number">29820</span> Storetable2<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Storetable2<span class="token punctuation">(</span>Ctype$<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table2$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table3$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table2c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table3c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">29830</span> <span class="token comment" spellcheck="true">! Store final data in string arrays for 2-ports.</span>
<span class="token number">29840</span> !
<span class="token number">29850</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">29860</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$[<span class="token number">10</span>]<span class="token punctuation">,</span>Devicedescript$<span class="token punctuation">,</span>Oneportonly
<span class="token number">29870</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">29880</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">29890</span>   !
<span class="token number">29900</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">29910</span>     ALLOCATE S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>[<span class="token number">12</span>]<span class="token punctuation">,</span>S1$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>[<span class="token number">20</span>]
<span class="token number">29920</span>     ALLOCATE Db2port1$<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span>[<span class="token number">75</span>]<span class="token punctuation">,</span>Db2port2$<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span>[<span class="token number">50</span>]<span class="token punctuation">,</span>Db2port3$<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span>[<span class="token number">50</span>]
<span class="token number">29930</span>     <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs<span class="token comment" spellcheck="true">! Each freq    STORE S11 IN TABLES</span>
<span class="token number">29940</span>       Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">29950</span>       Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">29960</span>       Tot1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">29970</span>       Tot2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">29980</span>       <span class="token keyword">CALL</span> Outputtable<span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">,</span>S$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot2<span class="token punctuation">)</span>
<span class="token number">29981</span>       <span class="token keyword">CALL</span> Outputtablecom<span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">,</span>S1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot2<span class="token punctuation">)</span>
<span class="token number">29990</span>       <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">11</span>
<span class="token number">30000</span>         Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>S$<span class="token punctuation">(</span>J<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add new line to table</span>
<span class="token number">30001</span>         Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>TRIM$<span class="token punctuation">(</span>S1$<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add new line to table</span>
<span class="token number">30010</span>       <span class="token keyword">NEXT</span> J
<span class="token number">30011</span>       <span class="token keyword">IF</span> I<span class="token operator">&lt;</span>Numfreqs <span class="token keyword">THEN</span>
<span class="token number">30020</span>         Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">30021</span>         Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">30022</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">30030</span>     <span class="token keyword">NEXT</span> I
<span class="token number">30040</span>   !
<span class="token number">30050</span>     <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs<span class="token comment" spellcheck="true">! Each freq      STORE S22 IN TABLES</span>
<span class="token number">30060</span>       Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token number">30070</span>       Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">30080</span>       Tot1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token number">30090</span>       Tot2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">30100</span>       <span class="token keyword">CALL</span> Outputtable<span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">,</span>S$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot2<span class="token punctuation">)</span>
<span class="token number">30101</span>       <span class="token keyword">CALL</span> Outputtablecom<span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">,</span>S1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot2<span class="token punctuation">)</span>
<span class="token number">30110</span>       <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">11</span>
<span class="token number">30120</span>         Table2$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table2$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>S$<span class="token punctuation">(</span>J<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Add new line to table</span>
<span class="token number">30121</span>         Table2c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table2c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>TRIM$<span class="token punctuation">(</span>S1$<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Add new line to table</span>
<span class="token number">30130</span>       <span class="token keyword">NEXT</span> J
<span class="token number">30131</span>       <span class="token keyword">IF</span> I<span class="token operator">&lt;</span>Numfreqs <span class="token keyword">THEN</span>
<span class="token number">30140</span>         Table2$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table2$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">30141</span>         Table2c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table2c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">30142</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">30150</span>     <span class="token keyword">NEXT</span> I
<span class="token number">30160</span>   !
<span class="token number">30170</span>     <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"NR"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">30180</span> Gets12ors21<span class="token punctuation">:</span> <span class="token keyword">INPUT</span> <span class="token string">"Enter a 3 to store S12 data, a 5 to store S21 data"</span><span class="token punctuation">,</span>Svar
<span class="token number">30190</span>       <span class="token keyword">IF</span> Svar<span class="token operator">&lt;&gt;</span><span class="token number">3</span> <span class="token operator">AND</span> Svar<span class="token operator">&lt;&gt;</span><span class="token number">5</span> <span class="token keyword">THEN</span> <span class="token keyword">GOTO</span> Gets12ors21
<span class="token number">30200</span>       DISP <span class="token string">"... STORING DATA FOR ASCII FILES ..."</span>
<span class="token number">30210</span>     <span class="token keyword">ELSE</span>
<span class="token number">30220</span>       Svar<span class="token operator">=</span><span class="token number">3</span>             <span class="token comment" spellcheck="true">! Store S12 for reciprocal device</span>
<span class="token number">30230</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">30240</span>     <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs<span class="token comment" spellcheck="true">! Each freq    STORE S12 OR S21 IN TABLES</span>
<span class="token number">30250</span>       Numfiles<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! # of files input for this freq</span>
<span class="token number">30260</span>       Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token punctuation">)</span>
<span class="token number">30270</span>       Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">30280</span>       Tot1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token punctuation">)</span>
<span class="token number">30290</span>       Tot2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">30300</span>       Fr<span class="token operator">=</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span>
<span class="token number">30310</span>       <span class="token keyword">CALL</span> Outputtable3<span class="token punctuation">(</span>S$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Fr<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token punctuation">)</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token punctuation">)</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot2<span class="token punctuation">)</span>
<span class="token number">30311</span>       <span class="token keyword">CALL</span> Outputtable3com<span class="token punctuation">(</span>S1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Fr<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token punctuation">)</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token punctuation">)</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Svar<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot2<span class="token punctuation">)</span>
<span class="token number">30320</span>       <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">11</span>
<span class="token number">30330</span>         Table3$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table3$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>S$<span class="token punctuation">(</span>J<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Add new row to table</span>
<span class="token number">30331</span>         Table3c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table3c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>TRIM$<span class="token punctuation">(</span>S1$<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Add new row to table</span>
<span class="token number">30340</span>       <span class="token keyword">NEXT</span> J
<span class="token number">30341</span>       <span class="token keyword">IF</span> I<span class="token operator">&lt;</span>Numfreqs <span class="token keyword">THEN</span>
<span class="token number">30350</span>         Table3$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table3$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">30351</span>         Table3c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table3c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">30352</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">30360</span>     !
<span class="token number">30450</span>     <span class="token keyword">NEXT</span> I
<span class="token number">30460</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">30470</span>   !
<span class="token number">30480</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! Phase shifter or var atten</span>
<span class="token number">30490</span>   <span class="token comment" spellcheck="true">! DETERMINE IF DEVICE IS A VARIABLE ATTENUATOR, OR A PHASE SHIFTER.</span>
<span class="token number">30500</span>     ALLOCATE S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>[<span class="token number">20</span>]
<span class="token number">30510</span>     Row<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">30520</span>     <span class="token keyword">IF</span> Avgs<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Phaseshifter<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">30530</span>     <span class="token keyword">IF</span> Avgs<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Variableatten<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">30540</span>     <span class="token keyword">IF</span> Phaseshifter<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Vars12<span class="token operator">=</span><span class="token number">4</span><span class="token comment" spellcheck="true">! Store  4th variable, Arg(S12)</span>
<span class="token number">30550</span>     <span class="token keyword">IF</span> Variableatten<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Vars12<span class="token operator">=</span><span class="token number">3</span><span class="token comment" spellcheck="true">! Store 3rd variable, |S12|</span>
<span class="token number">30560</span>       <span class="token comment" spellcheck="true">!!! Db2port$ will be stored in data base file</span>
<span class="token number">30570</span>     <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs
<span class="token number">30580</span>       <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">TO</span> Numrepeats   <span class="token comment" spellcheck="true">! All but 0 reference</span>
<span class="token number">30590</span>         Row<span class="token operator">=</span>Row<span class="token operator">+</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! Row of results table for data</span>
<span class="token number">30600</span>         Index<span class="token operator">=</span><span class="token punctuation">(</span>Eafreq<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>Numrepeats<span class="token operator">+</span>Easet<span class="token operator">-</span><span class="token number">1</span>
<span class="token number">30610</span>         <span class="token keyword">IF</span> Easet<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3X,2D.3D"</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span>
<span class="token number">30611</span>         <span class="token keyword">IF</span> Easet<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2D.3D,A"</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">30620</span>         <span class="token keyword">IF</span> Easet<span class="token operator">&lt;&gt;</span><span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,K"</span><span class="token punctuation">;</span><span class="token string">"      -  "</span>
<span class="token number">30621</span>         <span class="token keyword">IF</span> Easet<span class="token operator">&lt;&gt;</span><span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,A,A"</span><span class="token punctuation">;</span><span class="token string">"-"</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">30622</span>         <span class="token keyword">IF</span> Mags<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">30630</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3X,3D.D,5X"</span><span class="token punctuation">;</span>Mags<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">!RAG</span>
<span class="token number">30631</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.D,A"</span><span class="token punctuation">;</span>Mags<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>    <span class="token comment" spellcheck="true">!RAG</span>
<span class="token number">30632</span>         <span class="token keyword">ELSE</span>
<span class="token number">30633</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,5X,3D,5X"</span><span class="token punctuation">;</span>Mags<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">!RAG</span>
<span class="token number">30634</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D,A"</span><span class="token punctuation">;</span>Mags<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>    <span class="token comment" spellcheck="true">!RAG</span>
<span class="token number">30635</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">30636</span>         <span class="token keyword">IF</span> Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">30637</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3X,Z.3D,6X"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span>
<span class="token number">30638</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D,A"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">30639</span>         <span class="token keyword">ELSE</span>
<span class="token number">30640</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,4D.3D,6X"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span>
<span class="token number">30641</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,4D.3D,A"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">30642</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">30650</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D,7X"</span><span class="token punctuation">;</span>Systuncert<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span>
<span class="token number">30651</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D,A"</span><span class="token punctuation">;</span>Systuncert<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">30660</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D,7X"</span><span class="token punctuation">;</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span>
<span class="token number">30661</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D,A"</span><span class="token punctuation">;</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">30670</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D,7X"</span><span class="token punctuation">;</span>Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span>
<span class="token number">30671</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D,A"</span><span class="token punctuation">;</span>Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">30680</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D"</span><span class="token punctuation">;</span>Totuncert<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span>
<span class="token number">30681</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D"</span><span class="token punctuation">;</span>Totuncert<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span>
<span class="token number">30690</span>         Totunc<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span>
<span class="token number">30700</span>         <span class="token keyword">System</span><span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span>
<span class="token number">30710</span>         Longa<span class="token operator">=</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Long term A (between cals)</span>
<span class="token number">30720</span>       <span class="token comment" spellcheck="true">!  OUTPUT Db2port$(Index) USING Phaseshft2;Nisttestno$,Ctype$,Freq(Eafreq),Mags(Easet),Avgs(Eafreq,Easet,Vars12),System,Longa,Sc(Eafreq,Easet,Vars12),Totunc</span>
<span class="token number">30730</span> Phaseshft2<span class="token punctuation">:</span> <span class="token function">IMAGE</span> #<span class="token punctuation">,</span><span class="token number">6</span>A<span class="token punctuation">,</span>X<span class="token punctuation">,</span><span class="token number">6</span>A<span class="token punctuation">,</span><span class="token number">2</span>D.D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span><span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">5</span>X<span class="token punctuation">,</span><span class="token number">4</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">6</span>X<span class="token punctuation">,</span>M3D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">7</span>X<span class="token punctuation">,</span>M3D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">7</span>X<span class="token punctuation">,</span>M3D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">5</span>X<span class="token punctuation">,</span>M3D.<span class="token number">3</span>D
<span class="token number">30740</span>         <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">7</span>
<span class="token number">30750</span>           Table1$<span class="token punctuation">(</span>Row<span class="token punctuation">)</span><span class="token operator">=</span>Table1$<span class="token punctuation">(</span>Row<span class="token punctuation">)</span><span class="token operator">&amp;</span>S$<span class="token punctuation">(</span>J<span class="token punctuation">)</span>
<span class="token number">30751</span>           Table1c$<span class="token punctuation">(</span>Row<span class="token punctuation">)</span><span class="token operator">=</span>Table1c$<span class="token punctuation">(</span>Row<span class="token punctuation">)</span><span class="token operator">&amp;</span>TRIM$<span class="token punctuation">(</span>S1$<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">30760</span>         <span class="token keyword">NEXT</span> J
<span class="token number">30770</span>         Table1$<span class="token punctuation">(</span>Row<span class="token punctuation">)</span><span class="token operator">=</span>Table1$<span class="token punctuation">(</span>Row<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Add CR,LF for DOS</span>
<span class="token number">30771</span>         <span class="token keyword">IF</span> Eafreq<span class="token operator">&lt;</span>Numfreqs <span class="token keyword">THEN</span> Table1c$<span class="token punctuation">(</span>Row<span class="token punctuation">)</span><span class="token operator">=</span>Table1c$<span class="token punctuation">(</span>Row<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Add CR,LF for DOS</span>
<span class="token number">30780</span>       <span class="token keyword">NEXT</span> Easet
<span class="token number">30790</span>       Row<span class="token operator">=</span>Row<span class="token operator">+</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! Increment by 1 before next freq to leave blank line</span>
<span class="token number">30800</span>     <span class="token keyword">NEXT</span> Eafreq
<span class="token number">30810</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">30820</span> SUBEND  <span class="token comment" spellcheck="true">!.........Storetable2........</span>


<span class="token number">30830</span> Storetablep<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Storetablep<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Newdircomp<span class="token punctuation">,</span>Ctype$<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table2$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table2c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">30840</span> <span class="token comment" spellcheck="true">! Store power results in string array for Power.</span>
<span class="token number">30850</span> !
<span class="token number">30860</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">30870</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$[<span class="token number">10</span>]<span class="token punctuation">,</span>Devicedescript$<span class="token punctuation">,</span>Oneportonly
<span class="token number">30880</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">30890</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">30900</span>!
<span class="token number">30910</span>   <span class="token keyword">DIM</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>[<span class="token number">20</span>]<span class="token punctuation">,</span>S1$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>[<span class="token number">20</span>]
<span class="token number">30920</span>   ALLOCATE Db2port1$<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span>[<span class="token number">75</span>]<span class="token punctuation">,</span>Db2port2$<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span>[<span class="token number">50</span>]
<span class="token number">30930</span>   !
<span class="token number">30940</span>   <span class="token comment" spellcheck="true">! If files came from BOTH direct comparison &amp; another system, need to</span>
<span class="token number">30950</span>   <span class="token comment" spellcheck="true">!  set # of connects to 3 for freqs &lt;1 GHz (direct comp system 1-18 GHz</span>
<span class="token number">30960</span>   <span class="token comment" spellcheck="true">!  has 6 connects)</span>
<span class="token number">30970</span>   <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token function">SIZE</span><span class="token punctuation">(</span>Filename$<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">30980</span>     <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"N"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Dircomp<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">30990</span>     <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"N"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Othersystem<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">31000</span>   <span class="token keyword">NEXT</span> Eafile
<span class="token number">31010</span>   !
<span class="token number">31020</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs   <span class="token comment" spellcheck="true">!Each frequency   ! Store Gamma mag &amp; phase</span>
<span class="token number">31030</span>     Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">31040</span>     Tot1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">31050</span>     Tot2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token number">31060</span>     <span class="token keyword">CALL</span> Outputtable<span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">,</span>S$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot2<span class="token punctuation">)</span>
<span class="token number">31061</span>     <span class="token keyword">CALL</span> Outputtablecom<span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">,</span>S1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot2<span class="token punctuation">)</span>
<span class="token number">31070</span>     <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">11</span>
<span class="token number">31080</span>       Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>S$<span class="token punctuation">(</span>J<span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">!Add new row to table</span>
<span class="token number">31081</span>       Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>S1$<span class="token punctuation">(</span>J<span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">!Add new row to table</span>
<span class="token number">31090</span>     <span class="token keyword">NEXT</span> J
<span class="token number">31091</span>     <span class="token keyword">IF</span> I<span class="token operator">&lt;</span>Numfreqs <span class="token keyword">THEN</span>
<span class="token number">31100</span>       Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">31101</span>       Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">31112</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">31114</span>   <span class="token keyword">NEXT</span> I
<span class="token number">31120</span>  !
<span class="token number">31121</span>  <span class="token comment" spellcheck="true">!  Store efficiency and cal factor</span>
<span class="token number">31122</span>  !
<span class="token number">31123</span>   ALLOCATE Buttons$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>[<span class="token number">60</span>]<span class="token punctuation">,</span>Mes$[<span class="token number">200</span>]
<span class="token number">31124</span>   Buttons$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"NO"</span>
<span class="token number">31125</span>   Buttons$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"YES"</span>
<span class="token number">31126</span>   Mes$<span class="token operator">=</span><span class="token string">"Will the current data be combined with data from the NEW DIRECT COMPARISON System?"</span>
<span class="token number">31128</span>   DIALOG <span class="token string">"QUESTION"</span><span class="token punctuation">,</span>Mes$<span class="token punctuation">,</span>Btn<span class="token punctuation">;</span><span class="token function">SET</span> <span class="token punctuation">(</span><span class="token string">"DIALOG BUTTONS"</span><span class="token punctuation">:</span>Buttons$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"PEN"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"X"</span><span class="token punctuation">:</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token string">"Y"</span><span class="token punctuation">:</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token number">31130</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs     <span class="token comment" spellcheck="true">! Each freq   STORE EFFICIENCY AND CAL FACTOR</span>
<span class="token number">31140</span>     Numfiles<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! # of files input for this freq</span>
<span class="token number">31150</span>     Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">31160</span>     Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">31170</span>     Tot1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">31180</span>     Tot2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">31181</span>     Newdircomp<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">31183</span>     <span class="token keyword">IF</span> Btn<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">31190</span>       <span class="token keyword">CALL</span> Outputtable<span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span>S$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot2<span class="token punctuation">)</span>
<span class="token number">31191</span>       <span class="token keyword">CALL</span> Outputtablecom<span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span>S1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot2<span class="token punctuation">)</span>
<span class="token number">31192</span>     <span class="token keyword">ELSE</span>
<span class="token number">31193</span>       <span class="token keyword">CALL</span> Outputtablene<span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span>S$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot1<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Tot2<span class="token punctuation">)</span>
<span class="token number">31194</span>       Newdircomp<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">31195</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">31200</span>     <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">11</span>
<span class="token number">31210</span>       Table2$<span class="token punctuation">(</span>Nrow<span class="token operator">+</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table2$<span class="token punctuation">(</span>Nrow<span class="token operator">+</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>S$<span class="token punctuation">(</span>J<span class="token punctuation">)</span>
<span class="token number">31211</span>       Table2c$<span class="token punctuation">(</span>Nrow<span class="token operator">+</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table2c$<span class="token punctuation">(</span>Nrow<span class="token operator">+</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>TRIM$<span class="token punctuation">(</span>S1$<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">31220</span>     <span class="token keyword">NEXT</span> J
<span class="token number">31221</span>     <span class="token keyword">IF</span> I<span class="token operator">&lt;</span>Numfreqs <span class="token keyword">THEN</span>
<span class="token number">31230</span>       Table2$<span class="token punctuation">(</span>Nrow<span class="token operator">+</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table2$<span class="token punctuation">(</span>Nrow<span class="token operator">+</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">31231</span>       Table2c$<span class="token punctuation">(</span>Nrow<span class="token operator">+</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table2c$<span class="token punctuation">(</span>Nrow<span class="token operator">+</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">31232</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">31240</span>     !
<span class="token number">31250</span>     <span class="token comment" spellcheck="true">! Store data in arrays for data base file output</span>
<span class="token number">31260</span>     !
<span class="token number">31270</span>     <span class="token keyword">IF</span> Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token operator">AND</span> Dircomp<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">AND</span> Othersystem<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">31280</span>       Allconns<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">31290</span>     <span class="token keyword">ELSE</span>
<span class="token number">31300</span>       Allconns<span class="token operator">=</span>Numconnects
<span class="token number">31310</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">31320</span>     !
<span class="token number">31330</span> <span class="token comment" spellcheck="true">!   OUTPUT Db2port1$(I) USING Gamma;Nisttestno$,Ctype$,Freq(I),Numfiles,Allconns,Avgs(I,1,1),Snist(I,1,1),Sc(I,1,1),Avgs(I,1,6),Snist(I,1,6),Sc(I,1,6)</span>
<span class="token number">31340</span> <span class="token comment" spellcheck="true">!   OUTPUT Db2port2$(I) USING Effic;Avgs(I,1,2),Snist(I,1,2),Sc(I,1,2),Avgs(I,1,3),Snist(I,1,3),Sc(I,1,3)</span>
<span class="token number">31350</span> Gamma<span class="token punctuation">:</span> <span class="token function">IMAGE</span> #<span class="token punctuation">,</span><span class="token number">6</span>A<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">6</span>A<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>DD.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>DD<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>DD<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>M3D.<span class="token number">2</span>D<span class="token punctuation">,</span>X<span class="token punctuation">,</span>M3D.<span class="token number">2</span>D<span class="token punctuation">,</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.<span class="token number">2</span>D<span class="token punctuation">,</span>X
<span class="token number">31360</span> Effic<span class="token punctuation">:</span> <span class="token function">IMAGE</span> #<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span>X<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span>X<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span>X<span class="token punctuation">,</span>D.<span class="token number">5</span>D<span class="token punctuation">,</span>X
<span class="token number">31370</span> <span class="token comment" spellcheck="true">!   Db2port$(I)=Db2port1$(I)&amp;Db2port2$(I)</span>
<span class="token number">31380</span>   <span class="token keyword">NEXT</span> I
<span class="token number">31390</span>   DEALLOCATE Db2port1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Db2port2$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">31400</span> SUBEND   <span class="token comment" spellcheck="true">!........Storetablep.....</span>


<span class="token number">31410</span> Outputtable<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Outputtable<span class="token punctuation">(</span>Mparm$<span class="token punctuation">,</span>S$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>F<span class="token punctuation">,</span>M<span class="token punctuation">,</span>Dm<span class="token punctuation">,</span>Rm<span class="token punctuation">,</span>Sm<span class="token punctuation">,</span>Tm<span class="token punctuation">,</span>P<span class="token punctuation">,</span>Dp<span class="token punctuation">,</span>Rp<span class="token punctuation">,</span>Sp<span class="token punctuation">,</span>Tp<span class="token punctuation">)</span>
<span class="token number">31420</span> <span class="token comment" spellcheck="true">! Put a row (for a frequency F) of data into S$(*).  Used to store</span>
<span class="token number">31430</span> <span class="token comment" spellcheck="true">!  S11 or S22 data for a 2-port, Gamma for a 1-port, and Power results.</span>
<span class="token number">31440</span> !
<span class="token number">31450</span> <span class="token comment" spellcheck="true">!  INPUT:  Mparm$=</span><span class="token string">"S"</span> <span class="token keyword">for</span> <span class="token number">1</span><span class="token operator">-</span> <span class="token operator">or</span> <span class="token number">2</span><span class="token operator">-</span>ports<span class="token punctuation">,</span> <span class="token operator">=</span><span class="token string">"P"</span> <span class="token keyword">for</span> power <span class="token punctuation">(</span><span class="token operator">NOT</span> USED <span class="token number">940124</span><span class="token punctuation">)</span>
<span class="token number">31460</span> <span class="token comment" spellcheck="true">!          F= frequency</span>
<span class="token number">31470</span> <span class="token comment" spellcheck="true">!          M= mean of a variable, Dm= systematic uncertainty of M,</span>
<span class="token number">31480</span> <span class="token comment" spellcheck="true">!            Rm= random uncertainty of M, Sm= connector nonrepeatability</span>
<span class="token number">31490</span> <span class="token comment" spellcheck="true">!            of M, Tm= total uncertainty of M.</span>
<span class="token number">31500</span> <span class="token comment" spellcheck="true">!          P= mean of another variable, and Dp, Rp, Sp, Tp have the</span>
<span class="token number">31510</span> <span class="token comment" spellcheck="true">!            same definition for P as Dm, Rm, Sm, Tm do for M.</span>
<span class="token number">31520</span> !
<span class="token number">31530</span> <span class="token comment" spellcheck="true">! OUTPUT: The variables are stored in the appropriate format in S$(*)</span>
<span class="token number">31540</span> <span class="token comment" spellcheck="true">!         (which will be one row of the final output array).</span>
<span class="token number">31550</span> !
<span class="token number">31560</span>   <span class="token keyword">IF</span> F<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">31570</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,Z.4D"</span><span class="token punctuation">;</span>F     <span class="token comment" spellcheck="true">! Frequency</span>
<span class="token number">31580</span>   <span class="token keyword">ELSE</span>
<span class="token number">31590</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2D.4D"</span><span class="token punctuation">;</span>F
<span class="token number">31600</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">31610</span>   <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">"S"</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>M       <span class="token comment" spellcheck="true">! Mean of a variable (Gamma or Sii magnitude)</span>
<span class="token number">31620</span>   <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">"P"</span> <span class="token operator">AND</span> <span class="token function">ABS</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>M       <span class="token comment" spellcheck="true">! Efficiency</span>
<span class="token number">31630</span>   <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">"P"</span> <span class="token operator">AND</span> <span class="token function">ABS</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,D.4D"</span><span class="token punctuation">;</span>M       <span class="token comment" spellcheck="true">! Efficiency sometimes comes out greater than 1</span>
<span class="token number">31640</span>   <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">"S"</span> <span class="token keyword">THEN</span>
<span class="token number">31650</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>Dm    <span class="token comment" spellcheck="true">! Syst uncert of M</span>
<span class="token number">31660</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>Rm    <span class="token comment" spellcheck="true">! Random uncert of M</span>
<span class="token number">31670</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>Sm    <span class="token comment" spellcheck="true">! Connector nonrepeatability</span>
<span class="token number">31680</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>Tm    <span class="token comment" spellcheck="true">! Total uncert of M</span>
<span class="token number">31690</span>   <span class="token keyword">ELSE</span>   <span class="token comment" spellcheck="true">! Power device</span>
<span class="token number">31700</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X,Z.4D,X"</span><span class="token punctuation">;</span>Dm    <span class="token comment" spellcheck="true">! Syst uncert of M</span>
<span class="token number">31710</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X,Z.4D,X"</span><span class="token punctuation">;</span>Rm    <span class="token comment" spellcheck="true">! Random uncert of M</span>
<span class="token number">31720</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X,Z.4D,X"</span><span class="token punctuation">;</span>Sm    <span class="token comment" spellcheck="true">! Connector nonrepeatability</span>
<span class="token number">31730</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X,Z.4D,X"</span><span class="token punctuation">;</span>Tm    <span class="token comment" spellcheck="true">! Total uncert of M</span>
<span class="token number">31740</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">31750</span>   !
<span class="token number">31751</span>   <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">"P"</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Power Device Cal Factor</span>
<span class="token number">31753</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,A,1X,MZ.4D"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">,</span>P     <span class="token comment" spellcheck="true">! Mean of a var: cal factor</span>
<span class="token number">31760</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,Z.4D"</span><span class="token punctuation">;</span>Dp      <span class="token comment" spellcheck="true">! Syst uncert of P</span>
<span class="token number">31765</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>Rp       <span class="token comment" spellcheck="true">! Random uncert of P</span>
<span class="token number">31770</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>Sp      <span class="token comment" spellcheck="true">! Connector nonrepeatability</span>
<span class="token number">31775</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>Tp      <span class="token comment" spellcheck="true">! Total uncert of P</span>
<span class="token number">31779</span>   <span class="token keyword">ELSE</span>     <span class="token comment" spellcheck="true">! S-Parameter Phase</span>
<span class="token number">31780</span>     <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">31782</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,A,3X,MZ.2D"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">,</span>P<span class="token comment" spellcheck="true">! Mean of a variable: arg of Gamma or Sii</span>
<span class="token number">31783</span>     <span class="token keyword">ELSE</span>
<span class="token number">31784</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,A,1X,M3D.2D"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">,</span>P<span class="token comment" spellcheck="true">! Mean of a variable: arg of Gamma or Sii</span>
<span class="token number">31786</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">31787</span>     <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Dp<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">31788</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3X,Z.2D"</span><span class="token punctuation">;</span>Dp    <span class="token comment" spellcheck="true">! Syst uncert of P</span>
<span class="token number">31789</span>     <span class="token keyword">ELSE</span>
<span class="token number">31790</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,3D.2D"</span><span class="token punctuation">;</span>Dp
<span class="token number">31791</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">31792</span>     <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Rp<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">31793</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,4X,Z.2D"</span><span class="token punctuation">;</span>Rp     <span class="token comment" spellcheck="true">! Random uncert of P</span>
<span class="token number">31794</span>     <span class="token keyword">ELSE</span>
<span class="token number">31795</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,3D.2D"</span><span class="token punctuation">;</span>Rp
<span class="token number">31796</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">31797</span>     <span class="token keyword">IF</span> Sp<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">31798</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,4X,Z.2D"</span><span class="token punctuation">;</span>Sp    <span class="token comment" spellcheck="true">! Connector nonrepeatability</span>
<span class="token number">31799</span>     <span class="token keyword">ELSE</span>
<span class="token number">31800</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,3D.2D"</span><span class="token punctuation">;</span>Sp
<span class="token number">31801</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">31802</span>     <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Tp<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">31803</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,4X,Z.2D"</span><span class="token punctuation">;</span>Tp    <span class="token comment" spellcheck="true">! Total uncert of P</span>
<span class="token number">31804</span>     <span class="token keyword">ELSE</span>
<span class="token number">31805</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,3D.2D"</span><span class="token punctuation">;</span>Tp
<span class="token number">31806</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">31807</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">32030</span> SUBEND   <span class="token comment" spellcheck="true">!........Outputtable..................</span>


<span class="token number">32040</span> Outputtable3<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Outputtable3<span class="token punctuation">(</span>S$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>F<span class="token punctuation">,</span>M<span class="token punctuation">,</span>Dm<span class="token punctuation">,</span>Rm<span class="token punctuation">,</span>Sm<span class="token punctuation">,</span>Tm<span class="token punctuation">,</span>P<span class="token punctuation">,</span>Dp<span class="token punctuation">,</span>Rp<span class="token punctuation">,</span>Sp<span class="token punctuation">,</span>Tp<span class="token punctuation">)</span>
<span class="token number">32050</span> <span class="token comment" spellcheck="true">! Output S12 data for freq F into S$(*)</span>
<span class="token number">32060</span> !
<span class="token number">32070</span> <span class="token comment" spellcheck="true">!  INPUT:  F= frequency</span>
<span class="token number">32080</span> <span class="token comment" spellcheck="true">!          M= mean of |S12|, Dm= systematic uncertainty of M,</span>
<span class="token number">32090</span> <span class="token comment" spellcheck="true">!            Rm= random uncertainty of M, Sm= connector nonrepeatability</span>
<span class="token number">32100</span> <span class="token comment" spellcheck="true">!            of M, Tm= total uncertainty of M.</span>
<span class="token number">32110</span> <span class="token comment" spellcheck="true">!          P= mean of Arg(S12), and Dp, Rp, Sp, Tp have the</span>
<span class="token number">32120</span> <span class="token comment" spellcheck="true">!            same definition for P as Dm, Rm, Sm, Tm do for M.</span>
<span class="token number">32130</span> !
<span class="token number">32140</span> <span class="token comment" spellcheck="true">! OUTPUT: The variables are stored in the appropriate format in S$(*)</span>
<span class="token number">32150</span> <span class="token comment" spellcheck="true">!         (which will be one row of the final output array).</span>
<span class="token number">32160</span> !
<span class="token number">32170</span>   <span class="token keyword">IF</span> F<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">32180</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,Z.3D"</span><span class="token punctuation">;</span>F
<span class="token number">32190</span>   <span class="token keyword">ELSE</span>
<span class="token number">32200</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2D.3D"</span><span class="token punctuation">;</span>F
<span class="token number">32210</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">32220</span>   <span class="token keyword">IF</span> M<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">32230</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3X,Z.3D"</span><span class="token punctuation">;</span>M
<span class="token number">32240</span>   <span class="token keyword">ELSE</span>
<span class="token number">32250</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,2D.3D"</span><span class="token punctuation">;</span>M
<span class="token number">32260</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">32270</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.3D"</span><span class="token punctuation">;</span>Dm
<span class="token number">32280</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3X,Z.3D"</span><span class="token punctuation">;</span>Rm
<span class="token number">32290</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3X,Z.3D"</span><span class="token punctuation">;</span>Sm
<span class="token number">32300</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,4X,Z.3D"</span><span class="token punctuation">;</span>Tm
<span class="token number">32310</span>   <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">32320</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,A,3X,MZ.2D"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">,</span>P
<span class="token number">32330</span>   <span class="token keyword">ELSE</span>
<span class="token number">32340</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,A,1X,M3D.2D"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">,</span>P
<span class="token number">32350</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">32360</span>   <span class="token keyword">IF</span> Dp<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">32370</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"# ,3X,Z.2D"</span><span class="token punctuation">;</span>Dp
<span class="token number">32380</span>   <span class="token keyword">ELSE</span>
<span class="token number">32390</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,3D.2D"</span><span class="token punctuation">;</span>Dp
<span class="token number">32400</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">32410</span>   <span class="token keyword">IF</span> Rp<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">32420</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,4X,Z.2D"</span><span class="token punctuation">;</span>Rp
<span class="token number">32430</span>   <span class="token keyword">ELSE</span>
<span class="token number">32440</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,3D.2D"</span><span class="token punctuation">;</span>Rp
<span class="token number">32450</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">32460</span>   <span class="token keyword">IF</span> Sp<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">32470</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,4X,Z.2D"</span><span class="token punctuation">;</span>Sp
<span class="token number">32480</span>   <span class="token keyword">ELSE</span>
<span class="token number">32490</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,3D.2D"</span><span class="token punctuation">;</span>Sp
<span class="token number">32500</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">32510</span>   <span class="token keyword">IF</span> Tp<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">32520</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,4X,Z.2D"</span><span class="token punctuation">;</span>Tp
<span class="token number">32530</span>   <span class="token keyword">ELSE</span>
<span class="token number">32540</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,3D.2D"</span><span class="token punctuation">;</span>Tp
<span class="token number">32550</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">32560</span> SUBEND <span class="token comment" spellcheck="true">!..........Outputtable3.......................</span>


<span class="token number">32570</span> Createandstore<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Createandstore<span class="token punctuation">(</span>Makeascii<span class="token punctuation">,</span>E8510<span class="token punctuation">,</span>Nisttestno$<span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Meastype$<span class="token punctuation">,</span>Newdircomp<span class="token punctuation">,</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table2$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table3$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table2c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table3c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">32580</span>   <span class="token comment" spellcheck="true">! Create ASCII files &amp; store data</span>
<span class="token number">32590</span>   <span class="token comment" spellcheck="true">!  INPUT: Device test #, # of freqs, Type of device,</span>
<span class="token number">32600</span>   <span class="token comment" spellcheck="true">!      and string arrays of results.</span>
<span class="token number">32610</span>   !
<span class="token number">32620</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">32630</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Table1$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"mm"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Slidshort<span class="token operator">=</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! Device is a sliding short</span>
<span class="token number">32640</span>   Pathout$<span class="token operator">=</span><span class="token string">"/ASCII.DUT"</span>
<span class="token number">32650</span>   <span class="token function">OUTPUT</span> KBD<span class="token punctuation">;</span>Pathout$<span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"H"</span><span class="token punctuation">;</span>
<span class="token number">32660</span>   LINPUT <span class="token string">"Enter DIRECTORY for the result ASCII files"</span><span class="token punctuation">,</span>Pathout$
<span class="token number">32670</span>   Driveout$<span class="token operator">=</span><span class="token string">"s:"</span>
<span class="token number">32680</span>   <span class="token function">OUTPUT</span> KBD<span class="token punctuation">;</span>Driveout$<span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"H"</span><span class="token punctuation">;</span>
<span class="token number">32690</span>   LINPUT <span class="token string">"Enter DISC DRIVE for the result ASCII files."</span><span class="token punctuation">,</span>Driveout$
<span class="token number">32730</span>   !
<span class="token number">32740</span>   <span class="token keyword">IF</span> Pathout$<span class="token operator">&lt;&gt;</span><span class="token string">""</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Add slash for directory path syntax</span>
<span class="token number">32750</span>     <span class="token keyword">IF</span> Pathout$[<span class="token function">LEN</span><span class="token punctuation">(</span>Pathout$<span class="token punctuation">)</span>]<span class="token operator">&lt;&gt;</span><span class="token string">"/"</span> <span class="token keyword">THEN</span> Pathout$<span class="token operator">=</span>Pathout$<span class="token operator">&amp;</span><span class="token string">"/"</span>
<span class="token number">32760</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">32770</span>   DISP <span class="token string">"..... CREATING OUTPUT FILES AND STORING DATA ....."</span>
<span class="token number">32780</span>   <span class="token keyword">CALL</span> Createfiles<span class="token punctuation">(</span>Makeascii<span class="token punctuation">,</span>Nisttestno$<span class="token punctuation">,</span>Meastype$<span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Pathout$<span class="token punctuation">,</span>Driveout$<span class="token punctuation">,</span>Slidshort<span class="token punctuation">,</span>Newdircomp<span class="token punctuation">)</span>
<span class="token number">32790</span>   !
<span class="token number">32800</span>   <span class="token keyword">IF</span> Meastype$<span class="token operator">=</span><span class="token string">"2-port"</span> <span class="token operator">OR</span> Meastype$<span class="token operator">=</span><span class="token string">"2-portNR"</span> <span class="token operator">OR</span> Meastype$<span class="token operator">=</span><span class="token string">"Thermistor"</span> <span class="token operator">OR</span> Meastype$<span class="token operator">=</span><span class="token string">"DryCal"</span> <span class="token keyword">THEN</span>
<span class="token number">32801</span>     <span class="token keyword">IF</span> Newdircomp<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">32802</span>       ASSIGN @Out1 <span class="token keyword">TO</span> Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"lowa"</span><span class="token punctuation">;</span>FORMAT <span class="token keyword">ON</span> <span class="token comment" spellcheck="true">! 2-port or power</span>
<span class="token number">32803</span>       ASSIGN @Out2 <span class="token keyword">TO</span> Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"lowb"</span><span class="token punctuation">;</span>FORMAT <span class="token keyword">ON</span> <span class="token comment" spellcheck="true">! 2-port or power</span>
<span class="token number">32804</span>     <span class="token keyword">ELSE</span>
<span class="token number">32810</span>       ASSIGN @Out1 <span class="token keyword">TO</span> Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"a.txt"</span><span class="token punctuation">;</span>FORMAT <span class="token keyword">ON</span> <span class="token comment" spellcheck="true">! 2-port or power</span>
<span class="token number">32811</span>       ASSIGN @Out2 <span class="token keyword">TO</span> Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"b.txt"</span><span class="token punctuation">;</span>FORMAT <span class="token keyword">ON</span> <span class="token comment" spellcheck="true">! 2-port or power</span>
<span class="token number">32821</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">32830</span>     <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"2-port"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> ASSIGN @Out3 <span class="token keyword">TO</span> Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"c.txt"</span><span class="token punctuation">;</span>FORMAT <span class="token keyword">ON</span>   <span class="token comment" spellcheck="true">!File for 2 port</span>
<span class="token number">32840</span>   <span class="token keyword">ELSE</span>
<span class="token number">32850</span>     <span class="token keyword">IF</span> <span class="token operator">NOT</span> Makeascii <span class="token keyword">THEN</span> ASSIGN @Outtable <span class="token keyword">TO</span> Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">".txt"</span><span class="token punctuation">;</span>FORMAT <span class="token keyword">ON</span>  <span class="token comment" spellcheck="true">! Report file</span>
<span class="token number">32860</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">32870</span>   !
<span class="token number">33010</span>   <span class="token comment" spellcheck="true">! Write to file used for report generation &amp; DATA FILE FOR CUSTOMER</span>
<span class="token number">33020</span>   !
<span class="token number">33021</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> Makeascii <span class="token keyword">THEN</span>
<span class="token number">33022</span>     <span class="token keyword">IF</span> Newdircomp<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">33023</span>       ASSIGN @Outcust <span class="token keyword">TO</span> Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"low.asc"</span><span class="token punctuation">;</span>FORMAT <span class="token keyword">ON</span>
<span class="token number">33024</span>     <span class="token keyword">ELSE</span>
<span class="token number">33030</span>       ASSIGN @Outcust <span class="token keyword">TO</span> Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">".asc"</span><span class="token punctuation">;</span>FORMAT <span class="token keyword">ON</span>
<span class="token number">33031</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">33040</span>     <span class="token function">SELECT</span> Meastype$
<span class="token number">33050</span>     <span class="token keyword">CASE</span> <span class="token string">"1-port"</span><span class="token punctuation">,</span><span class="token string">"1-portV"</span>
<span class="token number">33060</span>       <span class="token function">OUTPUT</span> @Outtable<span class="token punctuation">;</span>Table1c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
<span class="token number">33070</span>     !
<span class="token number">33080</span>       Tabsize<span class="token operator">=</span><span class="token function">SIZE</span><span class="token punctuation">(</span>Table1$<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">33090</span>       <span class="token keyword">FOR</span> <span class="token function">Line</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Tabsize
<span class="token number">33100</span>         Chrpos<span class="token operator">=</span><span class="token function">POS</span><span class="token punctuation">(</span>Table1$<span class="token punctuation">(</span><span class="token function">Line</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">33110</span>         <span class="token keyword">IF</span> Chrpos<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Table1$<span class="token punctuation">(</span><span class="token function">Line</span><span class="token punctuation">)</span>[Chrpos<span class="token punctuation">,</span>Chrpos]<span class="token operator">=</span><span class="token string">" "</span>
<span class="token number">33120</span>       <span class="token keyword">NEXT</span> <span class="token function">Line</span>
<span class="token number">33130</span>     !
<span class="token number">33140</span>       <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span>Nisttestno$<span class="token punctuation">,</span><span class="token function">DATE$</span><span class="token punctuation">(</span>TIMEDATE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
<span class="token number">33150</span>       <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span><span class="token string">"TABLE 1 : Freq GHz, Gamma"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
<span class="token number">33160</span>       <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
<span class="token number">33170</span>     <span class="token keyword">CASE</span> <span class="token string">"2-port"</span><span class="token punctuation">,</span><span class="token string">"2-portNR"</span><span class="token punctuation">,</span><span class="token string">"2-portV"</span><span class="token punctuation">,</span><span class="token string">"Thermistor"</span><span class="token punctuation">,</span><span class="token string">"DryCal"</span>
<span class="token number">33180</span>       <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">33190</span>         <span class="token function">OUTPUT</span> @Out1<span class="token punctuation">;</span>Table1c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! S11, OR GAMMA FOR POWER</span>
<span class="token number">33200</span>         <span class="token function">OUTPUT</span> @Out2<span class="token punctuation">;</span>Table2c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! S22, OR EFFIC &amp; CAL FACTOR FOR POWER</span>
<span class="token number">33210</span>         <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"2-port"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> @Out3<span class="token punctuation">;</span>Table3c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! S12 or S21</span>
<span class="token number">33220</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">33230</span>       <span class="token keyword">IF</span> Meastype$<span class="token operator">=</span><span class="token string">"2-portV"</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> @Outtable<span class="token punctuation">;</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
<span class="token number">33240</span>     !
<span class="token number">33250</span>       Tabsize<span class="token operator">=</span><span class="token function">SIZE</span><span class="token punctuation">(</span>Table1$<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">33260</span>       <span class="token keyword">FOR</span> <span class="token function">Line</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Tabsize
<span class="token number">33270</span>         Chrpos<span class="token operator">=</span><span class="token function">POS</span><span class="token punctuation">(</span>Table1$<span class="token punctuation">(</span><span class="token function">Line</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">33280</span>         <span class="token keyword">IF</span> Chrpos<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Table1$<span class="token punctuation">(</span><span class="token function">Line</span><span class="token punctuation">)</span>[Chrpos<span class="token punctuation">,</span>Chrpos]<span class="token operator">=</span><span class="token string">" "</span>
<span class="token number">33290</span>       <span class="token keyword">NEXT</span> <span class="token function">Line</span>
<span class="token number">33300</span>       Tabsize<span class="token operator">=</span><span class="token function">SIZE</span><span class="token punctuation">(</span>Table2$<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">33310</span>       <span class="token keyword">FOR</span> <span class="token function">Line</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Tabsize
<span class="token number">33320</span>         Chrpos<span class="token operator">=</span><span class="token function">POS</span><span class="token punctuation">(</span>Table2$<span class="token punctuation">(</span><span class="token function">Line</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">33330</span>         <span class="token keyword">IF</span> Chrpos<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Table2$<span class="token punctuation">(</span><span class="token function">Line</span><span class="token punctuation">)</span>[Chrpos<span class="token punctuation">,</span>Chrpos]<span class="token operator">=</span><span class="token string">" "</span>
<span class="token number">33340</span>       <span class="token keyword">NEXT</span> <span class="token function">Line</span>
<span class="token number">33350</span>       Tabsize<span class="token operator">=</span><span class="token function">SIZE</span><span class="token punctuation">(</span>Table3$<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">33360</span>       <span class="token keyword">FOR</span> <span class="token function">Line</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Tabsize
<span class="token number">33370</span>         Chrpos<span class="token operator">=</span><span class="token function">POS</span><span class="token punctuation">(</span>Table3$<span class="token punctuation">(</span><span class="token function">Line</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">33380</span>         <span class="token keyword">IF</span> Chrpos<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Table3$<span class="token punctuation">(</span><span class="token function">Line</span><span class="token punctuation">)</span>[Chrpos<span class="token punctuation">,</span>Chrpos]<span class="token operator">=</span><span class="token string">" "</span>
<span class="token number">33390</span>       <span class="token keyword">NEXT</span> <span class="token function">Line</span>
<span class="token number">33400</span>       <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">33410</span>         <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span>Nisttestno$<span class="token punctuation">,</span><span class="token function">DATE$</span><span class="token punctuation">(</span>TIMEDATE<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
<span class="token number">33420</span>         <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span><span class="token string">"TABLE 1 : Freq GHz,  S11"</span><span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token number">33430</span>         <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span><span class="token string">"TABLE 1 : Freq GHz,  Dial setting, Measured difference"</span><span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token number">33440</span>         <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
<span class="token number">33450</span>         <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">33460</span>           <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span><span class="token string">"TABLE 2 : Freq GHz,  S22"</span><span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token number">33470</span>           <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span>Table2$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
<span class="token number">33480</span>           <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span><span class="token string">"TABLE 3 : Freq GHz,  S12"</span><span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token number">33490</span>           <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span>Table3$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
<span class="token number">33500</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">33510</span>       <span class="token keyword">ELSE</span>
<span class="token number">33520</span>         <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span>Nisttestno$<span class="token punctuation">,</span><span class="token function">DATE$</span><span class="token punctuation">(</span>TIMEDATE<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
<span class="token number">33530</span>         <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span><span class="token string">" TABLE 1: Freq GHz, Gamma"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token number">33540</span>         <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
<span class="token number">33550</span>         <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span><span class="token string">" TABLE 2: Freq GHz, Efficiency, Cal Factor"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token number">33560</span>         <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span>Table2$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
<span class="token number">33570</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">33580</span>     <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">33581</span>   <span class="token keyword">ELSE</span>
<span class="token number">33582</span>     ASSIGN @Outcust <span class="token keyword">TO</span> Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">".dut"</span><span class="token punctuation">;</span>FORMAT <span class="token keyword">ON</span>
<span class="token number">33583</span>     <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span><span class="token string">"! "</span><span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"   "</span><span class="token operator">&amp;</span><span class="token function">DATE$</span><span class="token punctuation">(</span>TIMEDATE<span class="token punctuation">)</span><span class="token comment" spellcheck="true">!;CHR$(10);CHR$(13)</span>
<span class="token number">33584</span>     <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span>"<span class="token comment" spellcheck="true">! Freq, |Gamma|, Arg(Gamma), Ub|G|, Un|G|, Uc|G|, Utot|G|, UbA(G), UnA(G), UcA(G), UtotA(G)"!;CHR$(10);CHR$(13)</span>
<span class="token number">33585</span>     <span class="token function">OUTPUT</span> @Outcust<span class="token punctuation">;</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">!;CHR$(10);CHR$(13)</span>
<span class="token number">33586</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">33590</span>   ASSIGN @Outcust <span class="token keyword">TO</span> <span class="token operator">*</span>
<span class="token number">33600</span>   ASSIGN @Outtable <span class="token keyword">TO</span> <span class="token operator">*</span>
<span class="token number">33610</span>  <span class="token comment" spellcheck="true">! ASSIGN @Outdb TO *</span>
<span class="token number">33620</span>   ASSIGN @Out1 <span class="token keyword">TO</span> <span class="token operator">*</span>
<span class="token number">33630</span>   ASSIGN @Out2 <span class="token keyword">TO</span> <span class="token operator">*</span>
<span class="token number">33640</span>   ASSIGN @Out3 <span class="token keyword">TO</span> <span class="token operator">*</span>
<span class="token number">33650</span> SUBEND   <span class="token comment" spellcheck="true">!........Createandstore..............</span>


<span class="token number">33660</span> Createfiles<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Createfiles<span class="token punctuation">(</span>Makeascii<span class="token punctuation">,</span>Nisttestno$<span class="token punctuation">,</span>Meastype$<span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Pathout$<span class="token punctuation">,</span>Driveout$<span class="token punctuation">,</span>Slidshort<span class="token punctuation">,</span>Newdircomp<span class="token punctuation">)</span>
<span class="token number">33670</span>   <span class="token function">DEG</span>
<span class="token number">33680</span>   <span class="token comment" spellcheck="true">! Create HPUX files for report generation and to add to the data base</span>
<span class="token number">33690</span>   !
<span class="token number">33700</span>   <span class="token comment" spellcheck="true">! INPUT: Makeascii=1 if making a file to be read by the Direct</span>
<span class="token number">33710</span>   <span class="token comment" spellcheck="true">!             Comparison System:  needs to be an ASCII file instead</span>
<span class="token number">33720</span>   <span class="token comment" spellcheck="true">!              of a HP-UX file</span>
<span class="token number">33730</span>   <span class="token comment" spellcheck="true">!        Nisttestno$= device ID, used for file names.</span>
<span class="token number">33740</span>   <span class="token comment" spellcheck="true">!        Meastype$= type of device (e.g. </span><span class="token string">"1-port"</span><span class="token punctuation">)</span>.
<span class="token number">33750</span>   <span class="token comment" spellcheck="true">!        Numfreqs= total # of freqs measured.</span>
<span class="token number">33760</span>   <span class="token comment" spellcheck="true">!        Pathout$= directory path on disc to store files in.</span>
<span class="token number">33770</span>   <span class="token comment" spellcheck="true">!        Driveout$= disc drive to store files on.</span>
<span class="token number">33780</span>   <span class="token comment" spellcheck="true">!        Slidshort=1 if the device measured is a sliding short.</span>
<span class="token number">33790</span>   !
<span class="token number">33800</span>   <span class="token comment" spellcheck="true">! OUTPUT: 2 files are created, one called Nisttestno$ and the other</span>
<span class="token number">33810</span>   <span class="token comment" spellcheck="true">!         called P&amp;Nisttestno$ (P= </span><span class="token string">"1"</span> <span class="token keyword">for</span> a <span class="token number">1</span><span class="token operator">-</span>port<span class="token punctuation">,</span> <span class="token string">"2"</span> <span class="token keyword">for</span> a
<span class="token number">33820</span>   <span class="token comment" spellcheck="true">!         2-port, </span><span class="token string">"P"</span> <span class="token keyword">for</span> power<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">in</span> directory Pathout$ <span class="token keyword">on</span> disc
<span class="token number">33830</span>   <span class="token comment" spellcheck="true">!         Driveout$.</span>
<span class="token number">33840</span>   <span class="token comment" spellcheck="true">!        If a file already exists with the same name, the file is</span>
<span class="token number">33850</span>   <span class="token comment" spellcheck="true">!        purged before the new one is created.  Program will</span>
<span class="token number">33860</span>   <span class="token comment" spellcheck="true">!        prompt for another disc if current one is full.</span>
<span class="token number">33870</span>   !
<span class="token number">33880</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">33890</span>   <span class="token keyword">ON ERROR</span> <span class="token keyword">GOTO</span> Purge2
<span class="token number">33900</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> Makeascii <span class="token keyword">THEN</span>
<span class="token number">33901</span>     <span class="token keyword">IF</span> Newdircomp<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">33902</span>       CREATE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"low.asc"</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">100</span>
<span class="token number">33903</span>     <span class="token keyword">ELSE</span>
<span class="token number">33905</span>       CREATE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">".asc"</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">100</span>
<span class="token number">33906</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">33907</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">33910</span> Trycreate<span class="token punctuation">:</span> <span class="token function">SELECT</span> Meastype$
<span class="token number">33920</span>   <span class="token keyword">CASE</span> <span class="token string">"1-port"</span>
<span class="token number">33930</span>     <span class="token keyword">IF</span> <span class="token operator">NOT</span> Makeascii <span class="token keyword">THEN</span> CREATE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">".txt"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token operator">+</span><span class="token number">2</span>
<span class="token number">33940</span>     <span class="token keyword">IF</span> Makeascii <span class="token keyword">THEN</span> CREATE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">".dut"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token operator">+</span><span class="token number">2</span>  <span class="token comment" spellcheck="true">! Create file for gamma to dir comp system   8/28/00  !RAG</span>
<span class="token number">33950</span>   <span class="token keyword">CASE</span> <span class="token string">"2-port"</span><span class="token punctuation">,</span><span class="token string">"2-portNR"</span>
<span class="token number">33960</span>     CREATE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"a.txt"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token operator">+</span><span class="token number">2</span>
<span class="token number">33970</span>     CREATE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"b.txt"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token operator">+</span><span class="token number">2</span>
<span class="token number">33980</span>     CREATE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"c.txt"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token operator">+</span><span class="token number">2</span>
<span class="token number">33990</span>   <span class="token keyword">CASE</span> <span class="token string">"Thermistor"</span><span class="token punctuation">,</span><span class="token string">"DryCal"</span>
<span class="token number">33991</span>     <span class="token keyword">IF</span> Newdircomp<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">33993</span>       CREATE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"lowa"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token operator">+</span><span class="token number">2</span>
<span class="token number">33994</span>       CREATE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"lowb"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token operator">+</span><span class="token number">2</span>
<span class="token number">33995</span>     <span class="token keyword">ELSE</span>
<span class="token number">34000</span>       CREATE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"a.txt"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token operator">+</span><span class="token number">2</span>
<span class="token number">34001</span>       CREATE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"b.txt"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token operator">+</span><span class="token number">2</span>
<span class="token number">34011</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">34020</span>   <span class="token keyword">CASE</span> <span class="token string">"2-portV"</span><span class="token punctuation">,</span><span class="token string">"1-portV"</span>
<span class="token number">34030</span>     CREATE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">".txt"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">250</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token operator">+</span><span class="token number">2</span>
<span class="token number">34040</span>   <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">34050</span>   <span class="token keyword">GOTO</span> Continue1
<span class="token number">34060</span> !
<span class="token number">34070</span> Purge2<span class="token punctuation">:</span> <span class="token keyword">OFF</span> <span class="token keyword">ERROR</span>
<span class="token number">34071</span>   <span class="token keyword">DIM</span> Mes$[<span class="token number">200</span>]
<span class="token number">34072</span>   Mes$<span class="token operator">=</span><span class="token string">"'"</span><span class="token operator">&amp;</span>ERRM$<span class="token operator">&amp;</span><span class="token string">"' - if this is a Duplicate File error"</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">" Pressing 'OK' will PURGE the existing Files for this device  !!!"</span>
<span class="token number">34073</span>   DIALOG <span class="token string">"ERROR"</span><span class="token punctuation">,</span>Mes$<span class="token punctuation">;</span><span class="token function">SET</span> <span class="token punctuation">(</span><span class="token string">"PEN"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"X"</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">"Y"</span><span class="token punctuation">:</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token number">34080</span>   <span class="token function">SELECT</span> ERRN
<span class="token number">34081</span>     <span class="token keyword">IF</span> Newdircomp<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">34082</span>       PURGE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"low.asc"</span>
<span class="token number">34083</span>     <span class="token keyword">ELSE</span>
<span class="token number">34090</span>       PURGE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">".asc"</span>
<span class="token number">34091</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">34100</span>   <span class="token keyword">CASE</span> <span class="token number">54</span>   <span class="token comment" spellcheck="true">! Purge existing file of same name</span>
<span class="token number">34110</span>     <span class="token keyword">IF</span> Meastype$<span class="token operator">=</span><span class="token string">"2-port"</span> <span class="token operator">OR</span> Meastype$<span class="token operator">=</span><span class="token string">"2-portNR"</span> <span class="token operator">OR</span> Meastype$<span class="token operator">=</span><span class="token string">"Thermistor"</span> <span class="token operator">OR</span> Meastype$<span class="token operator">=</span><span class="token string">"DryCal"</span> <span class="token keyword">THEN</span>
<span class="token number">34111</span>       <span class="token keyword">IF</span> Newdircomp<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">34112</span>         PURGE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"lowa"</span>
<span class="token number">34113</span>         PURGE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"lowb"</span>
<span class="token number">34114</span>       <span class="token keyword">ELSE</span>
<span class="token number">34120</span>         PURGE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"a.txt"</span>
<span class="token number">34121</span>         PURGE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"b.txt"</span>
<span class="token number">34131</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">34140</span>       <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"2-port"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> PURGE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">"c"</span>
<span class="token number">34150</span>     <span class="token keyword">ELSE</span>
<span class="token number">34160</span>       <span class="token keyword">IF</span> <span class="token operator">NOT</span> Makeascii <span class="token keyword">THEN</span> PURGE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$
<span class="token number">34161</span>       <span class="token keyword">IF</span> Makeascii <span class="token keyword">THEN</span> PURGE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>Nisttestno$<span class="token operator">&amp;</span><span class="token string">".dut"</span>
<span class="token number">34170</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">34180</span>   <span class="token keyword">CASE</span> <span class="token number">64</span>
<span class="token number">34190</span>     <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"The disc for the output file is full.  Replace with another disc and CONTINUE."</span>
<span class="token number">34200</span>     <span class="token keyword">INPUT</span> <span class="token string">""</span><span class="token punctuation">,</span>Continue
<span class="token number">34210</span>   <span class="token keyword">CASE</span> <span class="token keyword">ELSE</span>
<span class="token number">34220</span>     <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"ERROR TRYING TO CREATE HP-UX FILES"</span>
<span class="token number">34230</span>     <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span>ERRM$
<span class="token number">34240</span>     <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"....PAUSED in SUB Createfiles"</span>
<span class="token number">34250</span>     PAUSE
<span class="token number">34260</span>   <span class="token keyword">END</span> <span class="token function">SELECT</span>
<span class="token number">34270</span>   <span class="token keyword">GOTO</span> Trycreate
<span class="token number">34280</span>   !
<span class="token number">34290</span> Continue1<span class="token punctuation">:</span> <span class="token keyword">ON ERROR</span> <span class="token keyword">GOTO</span> Purge3  <span class="token comment" spellcheck="true">! Create files to add to data base</span>
<span class="token number">34300</span> Tryagain<span class="token punctuation">:</span> <span class="token comment" spellcheck="true">! SELECT Meastype$</span>
<span class="token number">34310</span>  <span class="token comment" spellcheck="true">! CASE </span><span class="token string">"1-port"</span><span class="token punctuation">,</span><span class="token string">"2-port"</span><span class="token punctuation">,</span><span class="token string">"2-portNR"</span>
<span class="token number">34320</span>   <span class="token comment" spellcheck="true">!  IF NOT Makeascii THEN CREATE Driveout$&amp;Pathout$&amp;LWC$(Meastype$[1,1])&amp;Nisttestno$,(3*Numfreqs*80)/256+2</span>
<span class="token number">34330</span>   <span class="token comment" spellcheck="true">!  IF Makeascii THEN CREATE ASCII Driveout$&amp;Pathout$&amp;LWC$(Meastype$[1,1])&amp;Nisttestno$,(3*Numfreqs*80)/256+2</span>
<span class="token number">34340</span>  <span class="token comment" spellcheck="true">! CASE </span><span class="token string">"Thermistor"</span><span class="token punctuation">,</span><span class="token string">"DryCal"</span>
<span class="token number">34350</span>   <span class="token comment" spellcheck="true">!  CREATE Driveout$&amp;Pathout$&amp;LWC$(Meastype$[1,1])&amp;Nisttestno$,(3*Numfreqs*120)/256+2</span>
<span class="token number">34360</span>  <span class="token comment" spellcheck="true">! CASE </span><span class="token string">"2-portV"</span>
<span class="token number">34370</span>   <span class="token comment" spellcheck="true">!  CREATE Driveout$&amp;Pathout$&amp;</span><span class="token string">"v"</span><span class="token operator">&amp;</span>Nisttestno$<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token operator">+</span><span class="token number">2</span>
<span class="token number">34380</span>  <span class="token comment" spellcheck="true">! CASE </span><span class="token string">"1-portV"</span>
<span class="token number">34390</span>   <span class="token comment" spellcheck="true">!  IF NOT Slidshort THEN CREATE Driveout$&amp;Pathout$&amp;</span><span class="token string">"s"</span><span class="token operator">&amp;</span>Nisttestno$<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token operator">+</span><span class="token number">2</span>
<span class="token number">34400</span>   <span class="token comment" spellcheck="true">!  IF Slidshort THEN CREATE Driveout$&amp;Pathout$&amp;</span><span class="token string">"ss"</span><span class="token operator">&amp;</span>Nisttestno$<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>Numfreqs<span class="token operator">*</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token operator">+</span><span class="token number">2</span>
<span class="token number">34410</span>  <span class="token comment" spellcheck="true">! END SELECT</span>
<span class="token number">34420</span>   <span class="token keyword">GOTO</span> Done
<span class="token number">34430</span> !
<span class="token number">34440</span> Purge3<span class="token punctuation">:</span> <span class="token keyword">OFF</span> <span class="token keyword">ERROR</span>
<span class="token number">34450</span>   <span class="token keyword">IF</span> ERRN<span class="token operator">=</span><span class="token number">54</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Purge existing file of same name</span>
<span class="token number">34460</span>     <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> PURGE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span>LWC$<span class="token punctuation">(</span>Meastype$[<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span>]<span class="token punctuation">)</span><span class="token operator">&amp;</span>Nisttestno$
<span class="token number">34470</span>     <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> PURGE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span><span class="token string">"v"</span><span class="token operator">&amp;</span>Nisttestno$
<span class="token number">34480</span>     <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token operator">NOT</span> Slidshort <span class="token keyword">THEN</span> PURGE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span><span class="token string">"s"</span><span class="token operator">&amp;</span>Nisttestno$
<span class="token number">34490</span>     <span class="token keyword">IF</span> Slidshort <span class="token keyword">THEN</span> PURGE Driveout$<span class="token operator">&amp;</span>Pathout$<span class="token operator">&amp;</span><span class="token string">"ss"</span><span class="token operator">&amp;</span>Nisttestno$
<span class="token number">34500</span>     <span class="token keyword">GOTO</span> Tryagain
<span class="token number">34510</span>   <span class="token keyword">ELSE</span>
<span class="token number">34520</span>     <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"ERROR TRYING TO CREATE FILES"</span>
<span class="token number">34530</span>     <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span>ERRM$
<span class="token number">34540</span>     <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"... PAUSED in SUB Createfiles ..."</span>
<span class="token number">34550</span>     PAUSE
<span class="token number">34560</span>     <span class="token keyword">GOTO</span> Tryagain
<span class="token number">34570</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">34580</span> Done<span class="token punctuation">:</span> SUBEND <span class="token comment" spellcheck="true">!.....Createfiles............................</span>


<span class="token number">34590</span> Storeplotdata<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Storeplotdata<span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sijplot<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Uncertlim<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">34600</span>  <span class="token comment" spellcheck="true">! Store data for plots in arrays to send to plotting program.</span>
<span class="token number">34610</span>  !
<span class="token number">34620</span>  <span class="token comment" spellcheck="true">! INPUT: Meastype$= type of device, e.g. </span><span class="token string">"2-port"</span> <span class="token operator">or</span> <span class="token string">"1-port"</span>
<span class="token number">34630</span>  <span class="token comment" spellcheck="true">!        Numfreqs= # of freqs measured</span>
<span class="token number">34640</span>  <span class="token comment" spellcheck="true">!        Freq(*)= array of freqs measured</span>
<span class="token number">34650</span>  <span class="token comment" spellcheck="true">!        Avgs(*)= FINAL averages for each freq, each variable</span>
<span class="token number">34660</span>  <span class="token comment" spellcheck="true">!        Sc(*)= short term Sc uncert for each freq, each variable</span>
<span class="token number">34670</span>  <span class="token comment" spellcheck="true">!        Snist(*)= long term Snist(*) for each freq, each variable</span>
<span class="token number">34680</span>  <span class="token comment" spellcheck="true">!        Systuncert(*)= systematic uncert for each freq, each var.</span>
<span class="token number">34690</span>  <span class="token comment" spellcheck="true">!        Totuncert(*)= total uncert for each freq, each variable</span>
<span class="token number">34700</span>  <span class="token comment" spellcheck="true">! OUTPUT:</span>
<span class="token number">34710</span>   <span class="token comment" spellcheck="true">! Sijplot(*) = [Freq(GHz), S11, Sc(S11), S12, Sc(S12), S22, Sc(S22),</span>
<span class="token number">34720</span>   <span class="token comment" spellcheck="true">!               |S11n-S11r|, |S12n-S12r|, |S22n-S22r|, Arg(S12n)-</span>
<span class="token number">34730</span>   <span class="token comment" spellcheck="true">!               Arg(S12r) ]</span>
<span class="token number">34740</span>   <span class="token comment" spellcheck="true">!            for 2-ports (Sij=magnitude and phase, n=normal, r=reversed,</span>
<span class="token number">34750</span>   <span class="token comment" spellcheck="true">!            Sc(Sij)= Sc short term uncertainty for Sij).  S12 in dB.</span>
<span class="token number">34760</span>   <span class="token comment" spellcheck="true">! For 1-ports, = [Freq(GHz), Gamma, Sc(Gamma), Gamma1-Gamma2, 0]</span>
<span class="token number">34770</span>   <span class="token comment" spellcheck="true">!            (Gamma=magnitude and phase, 1 for port 1, 2 for port 2).</span>
<span class="token number">34780</span>   <span class="token comment" spellcheck="true">! For power, = [Freq(GHz), |Gamma|, Arg(Gamma), Sc(|Gamma|),</span>
<span class="token number">34790</span>   <span class="token comment" spellcheck="true">!               Sc(Arg(Gamma)), efficiency, Pdc, Sc(efficiency), |Gamma1|-</span>
<span class="token number">34800</span>   <span class="token comment" spellcheck="true">!               |Gamma2|, efficiency port 1- efficiency port 2 , Arg</span>
<span class="token number">34810</span>   <span class="token comment" spellcheck="true">!               Gamma port 1- Arg Gamma port 2 ]</span>
<span class="token number">34820</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">34830</span>   <span class="token function">DEG</span>
<span class="token number">34840</span>   !
<span class="token number">34850</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs   <span class="token comment" spellcheck="true">! Store final parameters means for plots</span>
<span class="token number">34860</span>     Uncertlim<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span>
<span class="token number">34870</span>     Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Frequency.</span>
<span class="token number">34880</span>     <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"2-port"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
<span class="token number">34890</span>       <span class="token keyword">IF</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">34900</span>         <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span><span class="token string">"NR"</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Store either S12 or S21</span>
<span class="token number">34910</span> Plots12ors21<span class="token punctuation">:</span> <span class="token keyword">INPUT</span> <span class="token string">"Enter a 1 to plot S12, a 0 to plot S21"</span><span class="token punctuation">,</span>Plots12
<span class="token number">34920</span>           <span class="token keyword">IF</span> Plots12<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token operator">AND</span> Plots12<span class="token operator">&lt;&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token keyword">GOTO</span> Plots12ors21
<span class="token number">34930</span>         <span class="token keyword">ELSE</span>
<span class="token number">34940</span>           Plots12<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">34950</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">34960</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">34970</span>       <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">TO</span> <span class="token number">8</span> <span class="token keyword">STEP</span> <span class="token number">2</span>
<span class="token number">34980</span>         <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">4</span> <span class="token operator">AND</span> <span class="token operator">NOT</span> Plots12 <span class="token keyword">THEN</span> <span class="token keyword">GOTO</span> Skips21 <span class="token comment" spellcheck="true">! For NONrecip, plot S21</span>
<span class="token number">34990</span>         <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">6</span> <span class="token operator">AND</span> Plots12 <span class="token keyword">THEN</span> <span class="token keyword">GOTO</span> Skips21 <span class="token comment" spellcheck="true">! For a recip 2-port, S12=S21</span>
<span class="token number">35000</span>         Storecol<span class="token operator">=</span>J
<span class="token number">35010</span>         <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">8</span> <span class="token operator">OR</span> J<span class="token operator">=</span><span class="token number">6</span> <span class="token keyword">THEN</span> Storecol<span class="token operator">=</span>J<span class="token operator">-</span><span class="token number">2</span>
<span class="token number">35020</span>         Uncertlim<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Storecol<span class="token punctuation">)</span><span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">35030</span>         Uncertlim<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Storecol<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token punctuation">)</span>
<span class="token number">35040</span>  <span class="token comment" spellcheck="true">! Locations 6 and 7 of Uncertlim are total random uncertainty * 2</span>
<span class="token number">35050</span>         Uncertlim<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Storecol<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">35060</span>         Uncertlim<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Storecol<span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token function">ABS</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">35070</span>         Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Storecol<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Sc's, magnitudes</span>
<span class="token number">35080</span>         Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Storecol<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Sc's, phases</span>
<span class="token number">35090</span> Skips21<span class="token punctuation">:</span> <span class="token keyword">NEXT</span> J
<span class="token number">35100</span>       <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">11</span> <span class="token keyword">STEP</span> <span class="token number">2</span>  <span class="token comment" spellcheck="true">! Store averages, and differences</span>
<span class="token number">35110</span>         <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">3</span> <span class="token operator">AND</span> <span class="token operator">NOT</span> Plots12 <span class="token keyword">THEN</span> <span class="token keyword">GOTO</span> Skips21again  <span class="token comment" spellcheck="true">! Want S21</span>
<span class="token number">35120</span>         <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">5</span> <span class="token operator">AND</span> Plots12 <span class="token keyword">THEN</span> <span class="token keyword">GOTO</span> Skips21again   <span class="token comment" spellcheck="true">! Want S12</span>
<span class="token number">35130</span>         <span class="token keyword">IF</span> J<span class="token operator">=</span><span class="token number">5</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Want S21 instead of S12</span>
<span class="token number">35140</span>           Z<span class="token operator">=</span><span class="token number">3</span>   <span class="token comment" spellcheck="true">! Put S21 data where S12 would be</span>
<span class="token number">35150</span>         <span class="token keyword">ELSE</span>
<span class="token number">35160</span>           Z<span class="token operator">=</span>J
<span class="token number">35170</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">35180</span>         Col<span class="token operator">=</span><span class="token punctuation">(</span>Z<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Z<span class="token operator">&lt;</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>Z<span class="token operator">*</span><span class="token number">2</span><span class="token number">-4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Z<span class="token operator">&gt;=</span><span class="token number">7</span> <span class="token operator">AND</span> Z<span class="token operator">&lt;</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">16</span><span class="token operator">*</span><span class="token punctuation">(</span>Z<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! = 2,6,10,14,16</span>
<span class="token number">35190</span>         Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Col<span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Sij, magnitude, or differences</span>
<span class="token number">35200</span>         Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Col<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! Sij, phase, or differences</span>
<span class="token number">35210</span> Skips21again<span class="token punctuation">:</span> <span class="token keyword">NEXT</span> J
<span class="token number">35220</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">35230</span>   !
<span class="token number">35240</span>     <span class="token keyword">IF</span> Meastype$<span class="token operator">=</span><span class="token string">"1-port"</span> <span class="token keyword">THEN</span>
<span class="token number">35250</span>       <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">2</span>
<span class="token number">35260</span>         Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Gamma</span>
<span class="token number">35270</span>         Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Sc, Gamma</span>
<span class="token number">35280</span>       <span class="token keyword">NEXT</span> J
<span class="token number">35290</span>       <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">TO</span> <span class="token number">4</span>
<span class="token number">35300</span>         Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token punctuation">)</span>      <span class="token comment" spellcheck="true">! Gamma1-Gamma2</span>
<span class="token number">35310</span>         Uncertlim<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">35320</span>         Uncertlim<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token function">ABS</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! Total random uncert * 2</span>
<span class="token number">35330</span>       <span class="token keyword">NEXT</span> J
<span class="token number">35340</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">35350</span>   !
<span class="token number">35360</span>     <span class="token keyword">IF</span> Meastype$<span class="token operator">=</span><span class="token string">"Thermistor"</span> <span class="token operator">OR</span> Meastype$<span class="token operator">=</span><span class="token string">"DryCal"</span> <span class="token keyword">THEN</span>
<span class="token number">35370</span>       Uncertlim<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! Tot uncert |Gamma|</span>
<span class="token number">35380</span>       Uncertlim<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">! Total random error * 2 |gamma|</span>
<span class="token number">35390</span>       Uncertlim<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! Tot uncert Arg</span>
<span class="token number">35400</span>       Uncertlim<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token function">ABS</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">! Total random error * 2 Arg</span>
<span class="token number">35410</span>       Uncertlim<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! Tot uncert efficiency</span>
<span class="token number">35420</span>       Uncertlim<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">! Total random error * 2 efficiency</span>
<span class="token number">35430</span>         !
<span class="token number">35440</span>       Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">! |Gamma|</span>
<span class="token number">35450</span>       Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">! Arg</span>
<span class="token number">35460</span>       Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">! efficiency</span>
<span class="token number">35470</span>       Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">! Pdc</span>
<span class="token number">35480</span>       Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">! Sc|Gamma|</span>
<span class="token number">35490</span>       Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">! ScArg</span>
<span class="token number">35500</span>       Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">! ScEfficiency</span>
<span class="token number">35510</span>       <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">TO</span> <span class="token number">3</span>
<span class="token number">35520</span>         Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>J<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Diffs port1-2 of |Gamma|, effic.</span>
<span class="token number">35530</span>       <span class="token keyword">NEXT</span> J
<span class="token number">35540</span>       Sijplot<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">! Diffs port 1-2 of ArgGamma</span>
<span class="token number">35550</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">35560</span>   <span class="token keyword">NEXT</span> I
<span class="token number">35570</span> SUBEND  <span class="token comment" spellcheck="true">!..........Storeplotdata..............</span>


<span class="token number">35580</span> Avgslidterm<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Avgslidterm<span class="token punctuation">(</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">35590</span> <span class="token comment" spellcheck="true">!  This routine handles 1-port sliding terminations.  The averages</span>
<span class="token number">35600</span> <span class="token comment" spellcheck="true">!  and deviations are found by using a circle-fit algorithm by Yang &amp;</span>
<span class="token number">35610</span> <span class="token comment" spellcheck="true">!  Groccia.    Sc short term uncert is calculated here.</span>
<span class="token number">35620</span> !
<span class="token number">35630</span> !
<span class="token number">35640</span> <span class="token comment" spellcheck="true">!  INPUT:  Sport(*)=Which port device was measured on, for each file.</span>
<span class="token number">35650</span> <span class="token comment" spellcheck="true">!          Datasp1(*), Datasp2(*) = raw data from ports 1 &amp; 2.</span>
<span class="token number">35660</span> <span class="token comment" spellcheck="true">! OUTPUT:  Avgs(*)=averages of raw data: Gamma, radius ratio, circle fit.</span>
<span class="token number">35670</span> <span class="token comment" spellcheck="true">!          Sc(*)= short term uncert Sc</span>
<span class="token number">35680</span> <span class="token comment" spellcheck="true">! NOTE: for a variable device, # of settings measured= Numrepeats (in COM)</span>
<span class="token number">35690</span> <span class="token comment" spellcheck="true">!       THIS ROUTINE ASSUMES ALL FILES HAVE DATA FOR ALL THE SETTINGS.</span>
<span class="token number">35700</span> !
<span class="token number">35710</span> !
<span class="token number">35720</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">35730</span>   <span class="token function">DEG</span>
<span class="token number">35740</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">35750</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">35760</span>   Numfiles<span class="token operator">=</span><span class="token function">SIZE</span><span class="token punctuation">(</span>Sport<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">35770</span>   !
<span class="token number">35780</span>   ALLOCATE Xval<span class="token punctuation">(</span>Numrepeats<span class="token punctuation">)</span><span class="token punctuation">,</span>Yval<span class="token punctuation">(</span>Numrepeats<span class="token punctuation">)</span><span class="token punctuation">,</span>Final1<span class="token punctuation">(</span>Numrepeats<span class="token punctuation">)</span><span class="token punctuation">,</span>Final2<span class="token punctuation">(</span>Numrepeats<span class="token punctuation">)</span><span class="token punctuation">,</span>Final3<span class="token punctuation">(</span>Numrepeats<span class="token punctuation">)</span>
<span class="token number">35790</span>   ALLOCATE Initialval<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Finalval<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Initinverse<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Solution<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Center<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">)</span><span class="token punctuation">,</span>Radius<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">)</span>
<span class="token number">35800</span>   ALLOCATE Centerfinal<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">)</span><span class="token punctuation">,</span>Radiusfinal<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">)</span>
<span class="token number">35810</span>   ALLOCATE D<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">)</span><span class="token punctuation">,</span>Xo<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">)</span><span class="token punctuation">,</span>Yo<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">)</span>
<span class="token number">35820</span>   ALLOCATE Xofinal<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">)</span><span class="token punctuation">,</span>Yofinal<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">)</span>
<span class="token number">35830</span>   ALLOCATE Differx<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">)</span>
<span class="token number">35840</span>   ALLOCATE Differy<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">)</span><span class="token punctuation">,</span>Magdif<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">)</span><span class="token punctuation">,</span>Res<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">)</span><span class="token punctuation">,</span>Vari<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">)</span>
<span class="token number">35850</span>   ALLOCATE <span class="token comment" spellcheck="true"><span class="token keyword">Rem</span>(Numfreqs),Difsqr(Numfreqs)</span>
<span class="token number">35860</span>   !
<span class="token number">35870</span>   <span class="token comment" spellcheck="true">!  Read in the raw data as normal, and then convert to polar</span>
<span class="token number">35880</span>   !
<span class="token number">35890</span>   <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs
<span class="token number">35900</span>     Firstfile<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">35910</span>     Filesthisfreq<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! # of files for freq # Eafreq</span>
<span class="token number">35920</span>     <span class="token keyword">IF</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">35930</span>       <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Sign<span class="token operator">=</span>Datasp1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Firstfile<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">35940</span>       <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Sign<span class="token operator">=</span>Datasp2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Firstfile<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">35950</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">35960</span>     <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">35970</span>       Filenum<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eafile<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">35980</span>       <span class="token keyword">FOR</span> Eaconnect<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numconnects   <span class="token comment" spellcheck="true">! Find solution for each connect</span>
<span class="token number">35990</span>         <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numrepeats   <span class="token comment" spellcheck="true">! Each variable setting measured</span>
<span class="token number">36000</span>           <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Filenum<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">36010</span>             Temprad<span class="token operator">=</span>Datasp1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">36020</span>             Tempang<span class="token operator">=</span>Datasp1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">36030</span>           <span class="token keyword">ELSE</span>
<span class="token number">36040</span>             Temprad<span class="token operator">=</span>Datasp2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">36050</span>             Tempang<span class="token operator">=</span>Datasp2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">36060</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">36070</span>           <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Sign<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">100</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Angle: Fix +-180 disagreements</span>
<span class="token number">36080</span>             <span class="token keyword">IF</span> <span class="token function">SGN</span><span class="token punctuation">(</span>Tempang<span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token function">SGN</span><span class="token punctuation">(</span>Sign<span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Tempang<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">100</span> <span class="token keyword">THEN</span> Tempang<span class="token operator">=</span>Tempang<span class="token operator">+</span><span class="token number">360</span><span class="token operator">*</span><span class="token function">SGN</span><span class="token punctuation">(</span>Sign<span class="token punctuation">)</span>
<span class="token number">36090</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">36100</span>           Xval<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token operator">=</span>Temprad<span class="token operator">*</span><span class="token function">COS</span><span class="token punctuation">(</span>Tempang<span class="token punctuation">)</span>
<span class="token number">36110</span>           Yval<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token operator">=</span>Temprad<span class="token operator">*</span><span class="token function">SIN</span><span class="token punctuation">(</span>Tempang<span class="token punctuation">)</span>
<span class="token number">36120</span>           !
<span class="token number">36130</span>           <span class="token comment" spellcheck="true">!  The Xval, Yval values are used to fill arrays that handle</span>
<span class="token number">36140</span>           <span class="token comment" spellcheck="true">!  the computations that determine the center and radius of the</span>
<span class="token number">36150</span>           <span class="token comment" spellcheck="true">!  circle.  This process is similar to the least squares fit.</span>
<span class="token number">36160</span>           !
<span class="token number">36170</span>           <span class="token comment" spellcheck="true">!  To see exactly how the matrices are filled and computed,</span>
<span class="token number">36180</span>           <span class="token comment" spellcheck="true">!  please see the paper by Yang and Groccia.  Bob Judish</span>
<span class="token number">36190</span>           <span class="token comment" spellcheck="true">!  should have this paper.</span>
<span class="token number">36200</span>           !
<span class="token number">36210</span>           <span class="token comment" spellcheck="true">!  Final computations give a center point &amp; radius of the circle</span>
<span class="token number">36220</span>           !
<span class="token number">36230</span>           Final1<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token operator">=</span>Xval<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Yval<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span>
<span class="token number">36240</span>           Final2<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token operator">=</span>Xval<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Final1<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">36250</span>           Final3<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token operator">=</span>Yval<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Final1<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">36260</span>         <span class="token keyword">NEXT</span> Easet
<span class="token number">36270</span>         <span class="token comment" spellcheck="true">! Initialval is the matrix of initial data</span>
<span class="token number">36280</span>         Initialval<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Numrepeats
<span class="token number">36290</span>         Initialval<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>SUM<span class="token punctuation">(</span>Xval<span class="token punctuation">)</span>
<span class="token number">36300</span>         Initialval<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>SUM<span class="token punctuation">(</span>Yval<span class="token punctuation">)</span>
<span class="token number">36310</span>         Initialval<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>SUM<span class="token punctuation">(</span>Xval<span class="token punctuation">)</span>
<span class="token number">36320</span>         Xvalsqr<span class="token operator">=</span><span class="token function">DOT</span><span class="token punctuation">(</span>Xval<span class="token punctuation">,</span>Xval<span class="token punctuation">)</span>
<span class="token number">36330</span>         Initialval<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>Xvalsqr
<span class="token number">36340</span>         Xvalyval<span class="token operator">=</span><span class="token function">DOT</span><span class="token punctuation">(</span>Xval<span class="token punctuation">,</span>Yval<span class="token punctuation">)</span>
<span class="token number">36350</span>         Initialval<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>Xvalyval
<span class="token number">36360</span>         Yvalsqr<span class="token operator">=</span><span class="token function">DOT</span><span class="token punctuation">(</span>Yval<span class="token punctuation">,</span>Yval<span class="token punctuation">)</span>
<span class="token number">36370</span>         Initialval<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>SUM<span class="token punctuation">(</span>Yval<span class="token punctuation">)</span>
<span class="token number">36380</span>         Initialval<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>Xvalyval
<span class="token number">36390</span>         Initialval<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>Yvalsqr
<span class="token number">36400</span>         Finalval<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>SUM<span class="token punctuation">(</span>Final1<span class="token punctuation">)</span>
<span class="token number">36410</span>         Finalval<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>SUM<span class="token punctuation">(</span>Final2<span class="token punctuation">)</span>
<span class="token number">36420</span>         Finalval<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>SUM<span class="token punctuation">(</span>Final3<span class="token punctuation">)</span>
<span class="token number">36430</span>         <span class="token function">MAT</span> Initinverse<span class="token operator">=</span>INV<span class="token punctuation">(</span>Initialval<span class="token punctuation">)</span>
<span class="token number">36440</span>         <span class="token function">MAT</span> Solution<span class="token operator">=</span>Initinverse<span class="token operator">*</span>Finalval
<span class="token number">36450</span>       !
<span class="token number">36460</span>       <span class="token comment" spellcheck="true">! The center value is the sum-of-squares of the last 2 </span><span class="token string">"solution"</span>
<span class="token number">36470</span>       <span class="token comment" spellcheck="true">! values.  The radius is the sum plus the distance from the origin,</span>
<span class="token number">36480</span>       <span class="token comment" spellcheck="true">! which is the first element in the solution array.</span>
<span class="token number">36490</span>       !
<span class="token number">36500</span>         Center<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Solution<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Solution<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">36510</span>         Radius<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Solution<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>Solution<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Solution<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">36520</span>         D<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">=</span>Solution<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">36530</span>         Xo<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">=</span>Solution<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">36540</span>         Yo<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">=</span>Solution<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">36550</span>       !
<span class="token number">36560</span>       <span class="token comment" spellcheck="true">! Find final center &amp; radius values by averaging the results of</span>
<span class="token number">36570</span>       <span class="token comment" spellcheck="true">!  each connect.</span>
<span class="token number">36580</span>       !
<span class="token number">36590</span>         Centerfinal<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">=</span>Centerfinal<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">+</span>Center<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">/</span>Numconnects
<span class="token number">36600</span>         Radiusfinal<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">=</span>Radiusfinal<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">+</span>Radius<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">/</span>Numconnects
<span class="token number">36610</span>         Xofinal<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">=</span>Xofinal<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">+</span>Xo<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">/</span>Numconnects
<span class="token number">36620</span>         Yofinal<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">=</span>Yofinal<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">+</span>Yo<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">/</span>Numconnects
<span class="token number">36630</span>       <span class="token keyword">NEXT</span> Eaconnect
<span class="token number">36640</span>       !
<span class="token number">36650</span>       <span class="token comment" spellcheck="true">!  Let the Avgs array be filled with the average of the centers</span>
<span class="token number">36660</span>       <span class="token comment" spellcheck="true">!  and radii of the circles.  D is the distance from the origin to</span>
<span class="token number">36670</span>       <span class="token comment" spellcheck="true">!  the center.  Xo is the real value of the center point and Yo is</span>
<span class="token number">36680</span>       <span class="token comment" spellcheck="true">!  the imaginary point of the center.</span>
<span class="token number">36690</span>       !
<span class="token number">36700</span>       Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>Centerfinal<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">/</span>Filesthisfreq
<span class="token number">36710</span>       Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span>Radiusfinal<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">/</span>Filesthisfreq
<span class="token number">36720</span>     <span class="token keyword">NEXT</span> Eafile
<span class="token number">36730</span>   !
<span class="token number">36740</span>     <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">36750</span>       Filenum<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Eafile<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">36760</span>       <span class="token keyword">FOR</span> Eaconnect<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numconnects
<span class="token number">36770</span>       <span class="token comment" spellcheck="true">!  Difsqr is the squared distance between each circle center and the</span>
<span class="token number">36780</span>       <span class="token comment" spellcheck="true">!  average of the circle centers.</span>
<span class="token number">36790</span>         Difsqr<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">=</span>Difsqr<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>Center<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">-</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span>
<span class="token number">36800</span>         !
<span class="token number">36810</span>         <span class="token comment" spellcheck="true">!  Differx and Differy is the squared distance between the center</span>
<span class="token number">36820</span>         <span class="token comment" spellcheck="true">!  coordinates and the raw data points for each connect</span>
<span class="token number">36830</span>         !
<span class="token number">36840</span>         <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numrepeats
<span class="token number">36850</span>           <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">36860</span>             Xpoint<span class="token operator">=</span>Datasp1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">COS</span><span class="token punctuation">(</span>Datasp1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">36870</span>             Ypoint<span class="token operator">=</span>Datasp1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">SIN</span><span class="token punctuation">(</span>Datasp1<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">36880</span>           <span class="token keyword">ELSE</span>
<span class="token number">36890</span>             Xpoint<span class="token operator">=</span>Datasp2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">COS</span><span class="token punctuation">(</span>Datasp2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">36900</span>             Ypoint<span class="token operator">=</span>Datasp2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">SIN</span><span class="token punctuation">(</span>Datasp2<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">36910</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">36920</span>           Differx<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span>Xo<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">-</span>Xpoint<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span>
<span class="token number">36930</span>           Differy<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span>Yo<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">-</span>Ypoint<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span>
<span class="token number">36940</span>         !
<span class="token number">36950</span>         <span class="token comment" spellcheck="true">!  Magdif is the square root of the sum of Differx and Differy.</span>
<span class="token number">36960</span>         <span class="token comment" spellcheck="true">!  I.E. a radius for every point measured.</span>
<span class="token number">36970</span>         <span class="token comment" spellcheck="true">!  The reason for doing all of this can be found in the paper</span>
<span class="token number">36980</span>         <span class="token comment" spellcheck="true">!  referred to previously.</span>
<span class="token number">36990</span>         !
<span class="token number">37000</span>           Magdif<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Differx<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">+</span>Differy<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">37010</span>         !
<span class="token number">37020</span>         <span class="token comment" spellcheck="true">!  Res is the squared distance between Magdif and the fit radius of</span>
<span class="token number">37030</span>         <span class="token comment" spellcheck="true">!  each circle:  sum these for every setting measured.</span>
<span class="token number">37040</span>           Res<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">=</span>Res<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>Magdif<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token operator">-</span>Radius<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span>
<span class="token number">37050</span>         <span class="token keyword">NEXT</span> Easet
<span class="token number">37060</span>         !
<span class="token number">37070</span>         <span class="token comment" spellcheck="true">!  Vari is the first variance found.  It is the sum of all Res</span>
<span class="token number">37080</span>         <span class="token comment" spellcheck="true">!  Divided by the number of measurements (Numconnects)*(# settings less 3)</span>
<span class="token number">37090</span>         <span class="token comment" spellcheck="true">!  This first variance is then summed and used to determine</span>
<span class="token number">37100</span>         <span class="token comment" spellcheck="true">!  the standard deviation of the circle fit, called Sr.</span>
<span class="token number">37110</span>         !
<span class="token number">37120</span>         Vari<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">=</span>Vari<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">+</span>Res<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">,</span>Eaconnect<span class="token punctuation">)</span>
<span class="token number">37130</span>       <span class="token keyword">NEXT</span> Eaconnect
<span class="token number">37140</span>       Vari<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Vari<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Filenum<span class="token punctuation">)</span><span class="token operator">/</span>Numconnects<span class="token operator">*</span><span class="token punctuation">(</span>Numrepeats<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">37150</span>       <span class="token comment" spellcheck="true"><span class="token keyword">Rem</span>(Eafreq)=Rem(Eafreq)+(Vari(Eafreq,Filenum))^2</span>
<span class="token number">37160</span>     <span class="token keyword">NEXT</span> Eafile
<span class="token number">37170</span>     !
<span class="token number">37180</span>     <span class="token comment" spellcheck="true">!  Sr is the deviation of the circle fit and Sc is the deviation of</span>
<span class="token number">37190</span>     <span class="token comment" spellcheck="true">!   the points.  Vswr is the mean ratio of the gamma magnitude.</span>
<span class="token number">37200</span>     !
<span class="token number">37210</span>     Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span><span class="token comment" spellcheck="true"><span class="token keyword">Rem</span>(Eafreq)/Filesthisfreq)   ! Sr</span>
<span class="token number">37220</span>     Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Difsqr<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Numconnects<span class="token operator">*</span>Filesthisfreq<span class="token punctuation">)</span><span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Short term uncert</span>
<span class="token number">37230</span>     Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Vswr</span>
<span class="token number">37240</span>   <span class="token keyword">NEXT</span> Eafreq
<span class="token number">37250</span> SUBEND   <span class="token comment" spellcheck="true">!...........Avgslidterm.........................</span>


<span class="token number">37260</span> Keyques<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Keyques<span class="token punctuation">(</span>Crt$<span class="token punctuation">,</span>Ans<span class="token punctuation">,</span>A1$<span class="token punctuation">,</span>R$<span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">37270</span><span class="token comment" spellcheck="true">! This SUB pauses the program to allow the operator to answer a question,</span>
<span class="token number">37280</span><span class="token comment" spellcheck="true">! usually contained in Crt$, with softkeys.  The softkeys are set with</span>
<span class="token number">37290</span><span class="token comment" spellcheck="true">! information contained in A1$.  A </span><span class="token string">"Quit"</span> <span class="token keyword">key</span> <span class="token function">is</span> programed <span class="token keyword">to</span> enable the
<span class="token number">37300</span><span class="token comment" spellcheck="true">! operator to stop the program if the last softkey is not requested.</span>
<span class="token number">37310</span>!
<span class="token number">37320</span><span class="token comment" spellcheck="true">! Inputs:</span>
<span class="token number">37330</span><span class="token comment" spellcheck="true">!  Crt$  -  question to be answered</span>
<span class="token number">37340</span><span class="token comment" spellcheck="true">!  A1$   -  choice of answers to appear on softkeys formated as: 2 digit</span>
<span class="token number">37350</span><span class="token comment" spellcheck="true">!           softkey number, softkey label, semicolon, next softkey number</span>
<span class="token number">37360</span><span class="token comment" spellcheck="true">!           etc. (end with a semicolon).  A shifted key's label is to be</span>
<span class="token number">37370</span><span class="token comment" spellcheck="true">!           at the end of the associated non-shifted key.  Elements of</span>
<span class="token number">37380</span><span class="token comment" spellcheck="true">!           softkey number and softkey labels need not be in order.</span>
<span class="token number">37390</span><span class="token comment" spellcheck="true">!             eg:   Labels:    Dot      Intcpt    NxtKey</span>
<span class="token number">37400</span><span class="token comment" spellcheck="true">!                   Key #       0         10         5</span>
<span class="token number">37410</span><span class="token comment" spellcheck="true">!                   A1$=    </span><span class="token string">"00Dot   /Intcpt;10;05NxtKey;"</span>
<span class="token number">37420</span><span class="token comment" spellcheck="true">!  R$    - </span><span class="token string">"R"</span>  reverse <span class="token number">0</span> <span class="token operator">and</span> <span class="token number">1</span> <span class="token function">in</span> Ans
<span class="token number">37430</span><span class="token comment" spellcheck="true">!        - NOT </span><span class="token string">"R"</span>  adds value <span class="token function">of</span> R$ <span class="token keyword">to</span> Ans
<span class="token number">37440</span><span class="token comment" spellcheck="true">!  Ud    - non-zero allows normal function of up and down arrows.</span>
<span class="token number">37450</span>!
<span class="token number">37460</span><span class="token comment" spellcheck="true">! Outputs:</span>
<span class="token number">37470</span><span class="token comment" spellcheck="true">!   Ans   -  0 to 19 as per requested softkeys 0 to 19 respectively, except</span>
<span class="token number">37480</span><span class="token comment" spellcheck="true">!            as modified by R$.</span>
<span class="token number">37490</span>!
<span class="token number">37500</span>   ALLOCATE B<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">19</span><span class="token punctuation">)</span>
<span class="token number">37510</span>   <span class="token keyword">IF</span> Crt$<span class="token operator">&lt;&gt;</span><span class="token string">""</span> <span class="token keyword">THEN</span> DISP Crt$
<span class="token number">37520</span>   <span class="token keyword">SYSTEM</span> PRIORITY <span class="token number">0</span>
<span class="token number">37530</span>   <span class="token function">STATUS</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">;</span>Stat12
<span class="token number">37540</span>   CONTROL <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">;</span><span class="token number">2</span>
<span class="token number">37550</span>   Ans<span class="token operator">=</span><span class="token number">-1</span>
<span class="token number">37560</span>   <span class="token function">REPEAT</span>
<span class="token number">37570</span>     B<span class="token punctuation">(</span><span class="token function">VAL</span><span class="token punctuation">(</span>A1$[L<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token number">2</span>]<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>      <span class="token comment" spellcheck="true">! checklist array</span>
<span class="token number">37580</span>     <span class="token keyword">ON KEY</span> <span class="token function">VAL</span><span class="token punctuation">(</span>A1$[L<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token number">2</span>]<span class="token punctuation">)</span> LABEL A1$[L<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">;</span><span class="token function">POS</span><span class="token punctuation">(</span>A1$[L<span class="token operator">+</span><span class="token number">1</span>]<span class="token punctuation">,</span><span class="token string">";"</span><span class="token punctuation">)</span><span class="token number">-3</span>] <span class="token keyword">GOSUB</span> K2
<span class="token number">37590</span>     L<span class="token operator">=</span><span class="token function">POS</span><span class="token punctuation">(</span>A1$[L<span class="token operator">+</span><span class="token number">1</span>]<span class="token punctuation">,</span><span class="token string">";"</span><span class="token punctuation">)</span><span class="token operator">+</span>L
<span class="token number">37600</span>   <span class="token keyword">UNTIL</span> <span class="token function">POS</span><span class="token punctuation">(</span>A1$[L<span class="token operator">+</span><span class="token number">1</span>]<span class="token punctuation">,</span><span class="token string">";"</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token number">37610</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">TO</span> <span class="token number">19</span>
<span class="token number">37620</span>     <span class="token keyword">IF</span> B<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token keyword">ON KEY</span> I <span class="token keyword">GOSUB</span> K2
<span class="token number">37630</span>   <span class="token keyword">NEXT</span> I
<span class="token number">37640</span>   <span class="token keyword">IF</span> B<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token keyword">ON KEY</span> <span class="token number">9</span> LABEL <span class="token string">" Quit"</span> <span class="token keyword">GOSUB</span> K2
<span class="token number">37650</span>   <span class="token keyword">ON</span> KBD ALL <span class="token keyword">GOSUB</span> K2
<span class="token number">37660</span>   <span class="token function">REPEAT</span>
<span class="token number">37670</span>   <span class="token keyword">UNTIL</span> Ans<span class="token operator">&gt;</span><span class="token number">-1</span>
<span class="token number">37680</span>   <span class="token keyword">OFF</span> KBD
<span class="token number">37690</span>   <span class="token keyword">IF</span> Crt$<span class="token operator">&lt;&gt;</span><span class="token string">""</span> <span class="token keyword">THEN</span> DISP
<span class="token number">37700</span>   <span class="token keyword">IF</span> R$<span class="token operator">=</span><span class="token string">"R"</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! Reverse 0 and 1 in Ans</span>
<span class="token number">37710</span>     Ans<span class="token operator">=</span>Ans<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">37720</span>     <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Ans<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">37730</span>   <span class="token keyword">ELSE</span>
<span class="token number">37740</span>     Ans<span class="token operator">=</span>Ans<span class="token operator">+</span><span class="token function">VAL</span><span class="token punctuation">(</span>R$<span class="token punctuation">)</span>
<span class="token number">37750</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">37760</span>   CONTROL <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">;</span>Stat12
<span class="token number">37770</span>   SUBEXIT
<span class="token number">37780</span> K2<span class="token punctuation">:</span> Kbd$<span class="token operator">=</span>KBD$
<span class="token number">37790</span>   <span class="token keyword">IF</span> <span class="token function">LEN</span><span class="token punctuation">(</span>Kbd$<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">37800</span>     Kbd$<span class="token operator">=</span>Kbd$[<span class="token number">2</span><span class="token punctuation">;</span><span class="token number">1</span>]
<span class="token number">37810</span>     <span class="token keyword">IF</span> Kbd$<span class="token operator">=</span><span class="token string">"P"</span> <span class="token keyword">THEN</span>
<span class="token number">37820</span>       <span class="token keyword">OFF</span> KBD
<span class="token number">37830</span>       DISP <span class="token string">"... PAUSED ..."</span>
<span class="token number">37840</span>       PAUSE
<span class="token number">37850</span>       DISP
<span class="token number">37860</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span> <span class="token comment" spellcheck="true">! Kbd$=</span><span class="token string">"P"</span>
<span class="token number">37870</span>     <span class="token keyword">IF</span> NUM<span class="token punctuation">(</span>Kbd$<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">58</span> <span class="token operator">AND</span> NUM<span class="token punctuation">(</span>Kbd$<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">47</span> <span class="token keyword">THEN</span>
<span class="token number">37880</span>       Ans<span class="token operator">=</span><span class="token function">VAL</span><span class="token punctuation">(</span>Kbd$<span class="token punctuation">)</span>
<span class="token number">37890</span>       <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">9</span> <span class="token operator">AND</span> B<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token keyword">STOP</span>  <span class="token comment" spellcheck="true">! Quit</span>
<span class="token number">37900</span>       <span class="token keyword">IF</span> B<span class="token punctuation">(</span>Ans<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> Ans<span class="token operator">=</span><span class="token number">-1</span>   <span class="token comment" spellcheck="true">! Do not exit for blank softkey</span>
<span class="token number">37910</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">37920</span>     <span class="token keyword">IF</span> NUM<span class="token punctuation">(</span>Kbd$<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">107</span> <span class="token operator">AND</span> NUM<span class="token punctuation">(</span>Kbd$<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">96</span> <span class="token keyword">THEN</span>
<span class="token number">37930</span>       Ans<span class="token operator">=</span>NUM<span class="token punctuation">(</span>Kbd$<span class="token punctuation">)</span><span class="token number">-87</span>
<span class="token number">37940</span>       <span class="token keyword">IF</span> B<span class="token punctuation">(</span>Ans<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> Ans<span class="token operator">=</span><span class="token number">-1</span>   <span class="token comment" spellcheck="true">! Do not exit for blank softkey</span>
<span class="token number">37950</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">37960</span>     <span class="token keyword">IF</span> Ud <span class="token operator">AND</span> Kbd$<span class="token operator">=</span><span class="token string">"V"</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> <span class="token number">2</span><span class="token punctuation">;</span>"ÿV"<span class="token punctuation">;</span>
<span class="token number">37970</span>     <span class="token keyword">IF</span> Ud <span class="token operator">AND</span> Kbd$<span class="token operator">=</span><span class="token string">"^"</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> <span class="token number">2</span><span class="token punctuation">;</span>"ÿ<span class="token operator">^</span>"<span class="token punctuation">;</span>
<span class="token number">37980</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span> <span class="token comment" spellcheck="true">! LEN(Kbd$)&gt;1</span>
<span class="token number">37990</span>   <span class="token keyword">ON</span> KBD ALL <span class="token keyword">GOSUB</span> K2
<span class="token number">38000</span>   <span class="token keyword">RETURN</span>
<span class="token number">38010</span> SUBEND <span class="token comment" spellcheck="true">!................... Keyques ....................................</span>


<span class="token number">38020</span> Magofsettings<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Magofsettings<span class="token punctuation">(</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Magofsetting<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">38030</span> <span class="token comment" spellcheck="true">! Convert the string descriptions of variable device settings measured</span>
<span class="token number">38040</span> <span class="token comment" spellcheck="true">!  to an actual number.  The actual number will be used to determine</span>
<span class="token number">38050</span> <span class="token comment" spellcheck="true">!  uncertainties.</span>
<span class="token number">38060</span> <span class="token comment" spellcheck="true">! INPUT: Setting$(*)= summary array of all settings measured, sorted</span>
<span class="token number">38070</span> <span class="token comment" spellcheck="true">!             so that hopefully they are in correct increasing order</span>
<span class="token number">38080</span> <span class="token comment" spellcheck="true">! OUTPUT: Magofsetting(*)= numerical value for each setting in</span>
<span class="token number">38090</span> <span class="token comment" spellcheck="true">!             Setting$(*), e.g. </span><span class="token string">"10 dB"</span> converted <span class="token keyword">to</span> <span class="token number">10.</span>
<span class="token number">38100</span> !
<span class="token number">38110</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">38120</span>   Numsettings<span class="token operator">=</span><span class="token function">SIZE</span><span class="token punctuation">(</span>Magofsetting<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">38130</span>   <span class="token keyword">ON ERROR</span> <span class="token keyword">GOTO</span> Cantconvert
<span class="token number">38140</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numsettings
<span class="token number">38150</span>     <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Setting$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magofsetting<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">VAL</span><span class="token punctuation">(</span>Setting$<span class="token punctuation">(</span>I<span class="token punctuation">)</span>[<span class="token number">1</span><span class="token punctuation">,</span><span class="token function">POS</span><span class="token punctuation">(</span>Setting$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">)</span>]<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Strip off descriptors such as </span><span class="token string">"dB"</span> <span class="token operator">or</span> <span class="token string">"deg"</span>
<span class="token number">38160</span>     <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token function">POS</span><span class="token punctuation">(</span>Setting$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Magofsetting<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">VAL</span><span class="token punctuation">(</span>Setting$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">38170</span>   <span class="token keyword">NEXT</span> I
<span class="token number">38180</span>   <span class="token keyword">GOTO</span> Allok
<span class="token number">38190</span>   !
<span class="token number">38200</span> Cantconvert<span class="token punctuation">:</span> <span class="token keyword">OFF</span> <span class="token keyword">ERROR</span>
<span class="token number">38210</span>   <span class="token keyword">CLEAR</span> SCREEN
<span class="token number">38220</span>   <span class="token function">PRINT</span> <span class="token string">"... ERROR OCCURRED TRYING TO CONVERT SETTING DESCRIPTIONS TO ACTUAL NUMERICAL"</span>
<span class="token number">38230</span>   <span class="token function">PRINT</span> <span class="token string">"VALUES ..."</span>
<span class="token number">38240</span>   <span class="token function">PRINT</span>
<span class="token number">38250</span>   <span class="token function">PRINT</span> <span class="token string">"Please input the correct setting VALUE for the given setting description"</span>
<span class="token number">38260</span>   <span class="token function">PRINT</span> <span class="token string">"   (e.g., if setting description is ""10 dB"", input 10)"</span>
<span class="token number">38270</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numrepeats
<span class="token number">38280</span>     DISP <span class="token string">"Enter the value for a setting of "</span><span class="token punctuation">;</span>Setting$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">38290</span>     <span class="token keyword">INPUT</span> Magofsetting<span class="token punctuation">(</span>I<span class="token punctuation">)</span>
<span class="token number">38300</span>   <span class="token keyword">NEXT</span> I
<span class="token number">38310</span> Allok<span class="token punctuation">:</span> SUBEND   <span class="token comment" spellcheck="true">!.......Magofsettings......................</span>


<span class="token number">38320</span> Printtablesijv<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Printtablesijv<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">38330</span> <span class="token comment" spellcheck="true">! Print variable 2-port results</span>
<span class="token number">38340</span> !
<span class="token number">38350</span> <span class="token comment" spellcheck="true">! INPUT: Avgs(*) has average values for each freq, setting, &amp; variable</span>
<span class="token number">38360</span> <span class="token comment" spellcheck="true">!           If device is a phase shifter, only Arg(S12) is non-zero</span>
<span class="token number">38370</span> <span class="token comment" spellcheck="true">!           If device is a variable attenuator, only |S12| is non-zero</span>
<span class="token number">38380</span> <span class="token comment" spellcheck="true">!        Syst(*) has systematic uncertainties for each freq, setting, var</span>
<span class="token number">38390</span> <span class="token comment" spellcheck="true">!        Totuncert(*) has total uncerts for each freq, setting, var</span>
<span class="token number">38400</span> <span class="token comment" spellcheck="true">!         @Prt= I/O path to system printer</span>
<span class="token number">38410</span> <span class="token comment" spellcheck="true">!  FOR A VARIABLE DEVICE, Numrepeats= TOTAL # OF SETTINGS MEASURED.</span>
<span class="token number">38420</span> !
<span class="token number">38430</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">38440</span>   <span class="token function">DEG</span>
<span class="token number">38450</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">38460</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">38470</span>   !
<span class="token number">38480</span>   <span class="token comment" spellcheck="true">! DETERMINE IF DEVICE IS A VARIABLE ATTENUATOR, OR A PHASE SHIFTER.</span>
<span class="token number">38490</span>   !
<span class="token number">38500</span>   <span class="token keyword">IF</span> Numfreqs<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! See if operator would like to skip some printing.</span>
<span class="token number">38510</span>     <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token function">VAL$</span><span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"freqs --  Do you want to SKIP PRINTING some freqs?"</span><span class="token punctuation">,</span>Skpprt<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">38520</span>     <span class="token keyword">IF</span> Skpprt <span class="token keyword">THEN</span>
<span class="token number">38530</span>       <span class="token keyword">INPUT</span> <span class="token string">"Enter # to skip (e.g. Enter 5 to print freqs # 1, 7, 13, ...)"</span><span class="token punctuation">,</span>Skipnum
<span class="token number">38540</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" SKIPPING "</span><span class="token punctuation">;</span>Skipnum<span class="token punctuation">;</span><span class="token string">" FREQUENCIES..."</span>
<span class="token number">38550</span>       Skipnum<span class="token operator">=</span>Skipnum<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">38560</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">38570</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">38580</span>   Skipit<span class="token operator">=</span><span class="token number">0</span>    <span class="token comment" spellcheck="true">! Flag to print or not</span>
<span class="token number">38590</span>   !
<span class="token number">38600</span>   <span class="token keyword">IF</span> Avgs<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Phaseshifter<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">38610</span>   <span class="token keyword">IF</span> Avgs<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Variableatten<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">38620</span>   <span class="token keyword">IF</span> Phaseshifter<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Vars12<span class="token operator">=</span><span class="token number">4</span> <span class="token comment" spellcheck="true">! Store &amp; print 4th variable, Arg(S12)</span>
<span class="token number">38630</span>   <span class="token keyword">IF</span> Variableatten<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Vars12<span class="token operator">=</span><span class="token number">3</span> <span class="token comment" spellcheck="true">! Store &amp; print 3rd variable, |S12|</span>
<span class="token number">38640</span>   !
<span class="token number">38650</span>   <span class="token function">OUTPUT</span> @Prt
<span class="token number">38660</span>   <span class="token keyword">IF</span> Smoothed <span class="token keyword">THEN</span>
<span class="token number">38670</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"S12 (S21) DATA SMOOTHED FOR 8510/360:  average of "</span><span class="token punctuation">;</span>Smoothed<span class="token punctuation">;</span><span class="token string">" points."</span>
<span class="token number">38680</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">38690</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">38700</span>   <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs
<span class="token number">38710</span>     <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">38720</span>       <span class="token keyword">IF</span> Phaseshifter <span class="token keyword">THEN</span>
<span class="token number">38730</span>         <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> <span class="token string">"K,2D.2D,K,Z.3D,K,/,/"</span><span class="token punctuation">;</span><span class="token string">"Frequency= "</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">" GHz.  Dial repeatibility at 0 deg= "</span><span class="token punctuation">;</span>Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">" deg."</span>
<span class="token number">38740</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">38750</span>       !
<span class="token number">38760</span>       <span class="token keyword">IF</span> Variableatten <span class="token keyword">THEN</span>
<span class="token number">38770</span>         <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> <span class="token string">"K,2D.2D,K,Z.3D,K,/,/"</span><span class="token punctuation">;</span><span class="token string">"Frequency= "</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">" GHz.  Dial repeatibility at 0 dB= "</span><span class="token punctuation">;</span>Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">" dB."</span>
<span class="token number">38780</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">38790</span>       !
<span class="token number">38800</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                                 TABLE 1 "</span>
<span class="token number">38810</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"--------------------------------------------------------------------------------"</span>
<span class="token number">38820</span>       <span class="token function">OUTPUT</span> @Prt
<span class="token number">38830</span>     !
<span class="token number">38840</span>       <span class="token keyword">IF</span> Variableatten <span class="token keyword">THEN</span>
<span class="token number">38850</span>         <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"  Dial     Measured        Type B        Type A       Type A      Total"</span>
<span class="token number">38860</span>         <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"Setting   Attenuation    Uncertainty   Uncertainty  Uncertainty  Uncertainty"</span>
<span class="token number">38870</span>         <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"   dB         dB             dB          dB (Snist)   dB (Sc)       dB"</span>
<span class="token number">38880</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">38890</span>   !
<span class="token number">38900</span>       <span class="token keyword">IF</span> Phaseshifter <span class="token keyword">THEN</span>
<span class="token number">38910</span>         <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"  Dial      Phase         Type B       Type A        Type A      Total"</span>
<span class="token number">38920</span>         <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" Setting   Difference   Uncertainty   Uncertainty  Uncertainty Uncertainty"</span>
<span class="token number">38930</span>         <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"(degrees)  (degrees)    (degrees)     (deg) (Snist)  (deg) (Sc) (degrees)"</span>
<span class="token number">38940</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">38950</span>     !
<span class="token number">38960</span>       <span class="token function">OUTPUT</span> @Prt
<span class="token number">38970</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"--------------------------------------------------------------------------------"</span>
<span class="token number">38980</span>       <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">TO</span> Numrepeats   <span class="token comment" spellcheck="true">! ALL BUT 0 deg reference.</span>
<span class="token number">38990</span>       !
<span class="token number">39000</span>       <span class="token comment" spellcheck="true">! Print out the data into the table</span>
<span class="token number">39010</span>       !
<span class="token number">39020</span>         Shorta<span class="token operator">=</span>Sc<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Short-term Type A (connector)</span>
<span class="token number">39030</span>         Longa<span class="token operator">=</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Long term A (between cals)</span>
<span class="token number">39040</span>         <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> Phaseshft<span class="token punctuation">;</span>Mags<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span><span class="token punctuation">,</span>Longa<span class="token punctuation">,</span>Shorta<span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span>Vars12<span class="token punctuation">)</span>
<span class="token number">39050</span> Phaseshft<span class="token punctuation">:</span> <span class="token function">IMAGE</span> <span class="token number">2</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">3</span>X<span class="token punctuation">,</span><span class="token number">4</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">10</span>X<span class="token punctuation">,</span>Z.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">9</span>X<span class="token punctuation">,</span>Z.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">7</span>X<span class="token punctuation">,</span>Z.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">9</span>X<span class="token punctuation">,</span>Z.<span class="token number">3</span>D
<span class="token number">39060</span>       <span class="token keyword">NEXT</span> Easet
<span class="token number">39070</span>       <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> <span class="token string">"4/"</span>
<span class="token number">39080</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">39090</span>     <span class="token keyword">ELSE</span>
<span class="token number">39100</span>       <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">39110</span>         Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">39120</span>         <span class="token keyword">IF</span> Skipit<span class="token operator">=</span>Skipnum <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span><span class="token comment" spellcheck="true">! Reset flag to print next one</span>
<span class="token number">39130</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">39140</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">39150</span>   <span class="token keyword">NEXT</span> Eafreq
<span class="token number">39160</span>   <span class="token function">OUTPUT</span> @Prt
<span class="token number">39170</span>   PRINTER <span class="token function">IS</span> CRT
<span class="token number">39180</span> SUBEND   <span class="token comment" spellcheck="true">!.....Printtablesijv.............................</span>


<span class="token number">39190</span> Printtableslid<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Printtableslid<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">)</span>
<span class="token number">39200</span>   <span class="token function">DEG</span>
<span class="token number">39210</span>   <span class="token comment" spellcheck="true">! Print final results for 1-port sliding termination devices</span>
<span class="token number">39220</span>   <span class="token comment" spellcheck="true">! INPUT: Avgs(*)= average Gamma, circle fit, radius ratio for each freq</span>
<span class="token number">39230</span>   <span class="token comment" spellcheck="true">!      Sc(*)= connector uncert for Gamma ea freq,</span>
<span class="token number">39240</span>   <span class="token comment" spellcheck="true">!      Snist= calibration std dev ea freq, Systuncert(*)=</span>
<span class="token number">39250</span>   <span class="token comment" spellcheck="true">!      systematic uncert ea freq, Totuncert(*)= total uncert ea freq</span>
<span class="token number">39260</span>   <span class="token comment" spellcheck="true">!      @Prt= I/O path to system printer.</span>
<span class="token number">39270</span>   !
<span class="token number">39280</span>   <span class="token comment" spellcheck="true">! OUTPUT: Table of final results is printed.  This is same table that</span>
<span class="token number">39290</span>   <span class="token comment" spellcheck="true">!         will be stored in the HP-UX file used for customer reports.</span>
<span class="token number">39300</span>   !
<span class="token number">39310</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">39320</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">39330</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$[<span class="token number">10</span>]<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">39340</span>!
<span class="token number">39350</span>   <span class="token keyword">IF</span> Numfreqs<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token keyword">THEN</span>  <span class="token comment" spellcheck="true">! See if operator would like to skip some printing.</span>
<span class="token number">39360</span>     <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token function">VAL$</span><span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"freqs --  Do you want to SKIP PRINTING some freqs?"</span><span class="token punctuation">,</span>Skpprt<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">39370</span>     <span class="token keyword">IF</span> Skpprt <span class="token keyword">THEN</span>
<span class="token number">39380</span>       <span class="token keyword">INPUT</span> <span class="token string">"Enter # to skip (e.g. Enter 5 to print freqs # 1, 7, 13, ...)"</span><span class="token punctuation">,</span>Skipnum
<span class="token number">39390</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" SKIPPING "</span><span class="token punctuation">;</span>Skipnum<span class="token punctuation">;</span><span class="token string">" FREQUENCIES..."</span>
<span class="token number">39400</span>       Skipnum<span class="token operator">=</span>Skipnum<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">39410</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">39420</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">39430</span>   Skipit<span class="token operator">=</span><span class="token number">0</span>    <span class="token comment" spellcheck="true">! Flag to print or not</span>
<span class="token number">39440</span>   !
<span class="token number">39450</span>   <span class="token keyword">IF</span> PROUND<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">-5</span><span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token operator">AND</span> PROUND<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">-5</span><span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">39460</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>      <span class="token comment" spellcheck="true">! SLIDING LOAD</span>
<span class="token number">39470</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"         SLIDING LOAD               TABLE 1 "</span>
<span class="token number">39480</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"--------------------------------------------------------------------------------"</span>
<span class="token number">39490</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">39500</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"            S11 - MAGNITUDE                           SL - MAGNITUDE"</span>
<span class="token number">39510</span> <span class="token comment" spellcheck="true">! Print table column titles</span>
<span class="token number">39520</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">39530</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"FREQ.    MEAN   TYPE   TYPE A   TYPE A     U       MEAN    MEAN      S"</span>
<span class="token number">39540</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" GHz     VALUE    B    (Snist)   (Sc)       T       VALUE   VALUE     R"</span>
<span class="token number">39550</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                                                            (VSWR)"</span>
<span class="token number">39560</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">39570</span>   !
<span class="token number">39580</span>     <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs<span class="token comment" spellcheck="true">! Each freq</span>
<span class="token number">39590</span>       <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">39600</span>         <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> <span class="token number">39610</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">39610</span>         <span class="token function">IMAGE</span> <span class="token number">2</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span>X<span class="token punctuation">,</span>MD.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">3</span>X<span class="token punctuation">,</span><span class="token number">4</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span>D.<span class="token number">5</span>D
<span class="token number">39620</span>         <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">39630</span>       <span class="token keyword">ELSE</span>
<span class="token number">39640</span>         <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">39650</span>           Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">39660</span>           <span class="token keyword">IF</span> Skipit<span class="token operator">=</span>Skipnum <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span><span class="token comment" spellcheck="true">! Reset flag to print next one</span>
<span class="token number">39670</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">39680</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">39690</span>     <span class="token keyword">NEXT</span> I
<span class="token number">39700</span>   !
<span class="token number">39710</span>   <span class="token keyword">ELSE</span>                              <span class="token comment" spellcheck="true">! SLIDING SHORT</span>
<span class="token number">39720</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">39730</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"        SLIDING SHORT            TABLE 1 - GAMMA"</span>
<span class="token number">39740</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"--------------------------------------------------------------------------------"</span>
<span class="token number">39750</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">39760</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                MAGNITUDE                                   PHASE"</span>
<span class="token number">39770</span> <span class="token comment" spellcheck="true">! Print table column titles</span>
<span class="token number">39780</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">39790</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"FREQ  POSITION MEAN  TYPE   TYPE A  TYPE A  U      MEAN   TYPE TYPE A TYPE A  U"</span>
<span class="token number">39800</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" GHz           VALUE   B   (Snist)   (Sc)   T      VALUE   B  (Snist)  (Sc)   T"</span>
<span class="token number">39810</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">39820</span>   !
<span class="token number">39830</span>     Skipit<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">39840</span>     <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs<span class="token comment" spellcheck="true">! Each freq</span>
<span class="token number">39850</span>       <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">39860</span>         <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token function">SIZE</span><span class="token punctuation">(</span>Avgs<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">39870</span>           Avg1<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">39880</span>           Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">39890</span>           Snist1<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">39900</span>           Sc1<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">39910</span>           Total1<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">39920</span>           Avg2<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">39930</span>           Syst2<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">39940</span>           Snist2<span class="token operator">=</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">39950</span>           Sc2<span class="token operator">=</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">39960</span>           Total2<span class="token operator">=</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">39970</span>         <span class="token comment" spellcheck="true">! Print Freq in table for first setting only</span>
<span class="token number">39980</span>           <span class="token keyword">IF</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> A<span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token punctuation">,</span>Avg1<span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist1<span class="token punctuation">,</span>Sc1<span class="token punctuation">,</span>Total1<span class="token punctuation">,</span>Avg2<span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist2<span class="token punctuation">,</span>Sc2<span class="token punctuation">,</span>Total2
<span class="token number">39990</span> A<span class="token punctuation">:</span>        <span class="token function">IMAGE</span> <span class="token number">2</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span><span class="token number">6</span>A<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span>M3D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D
<span class="token number">40000</span>           <span class="token keyword">IF</span> Easet<span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> B<span class="token punctuation">;</span>Setting$<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token punctuation">,</span>Avg1<span class="token punctuation">,</span>Syst1<span class="token punctuation">,</span>Snist1<span class="token punctuation">,</span>Sc1<span class="token punctuation">,</span>Total1<span class="token punctuation">,</span>Avg2<span class="token punctuation">,</span>Syst2<span class="token punctuation">,</span>Snist2<span class="token punctuation">,</span>Sc2<span class="token punctuation">,</span>Total2
<span class="token number">40010</span> B<span class="token punctuation">:</span>        <span class="token function">IMAGE</span> <span class="token number">8</span>X<span class="token punctuation">,</span><span class="token number">6</span>A<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span>Z.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span>M3D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D<span class="token punctuation">,</span><span class="token number">1</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D
<span class="token number">40020</span>         <span class="token keyword">NEXT</span> Easet
<span class="token number">40030</span>         <span class="token function">OUTPUT</span> @Prt  <span class="token comment" spellcheck="true">! Blank line between freqs</span>
<span class="token number">40040</span>         <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">40050</span>       <span class="token keyword">ELSE</span>
<span class="token number">40060</span>         <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">40070</span>           Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">40080</span>           <span class="token keyword">IF</span> Skipit<span class="token operator">=</span>Skipnum <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span><span class="token comment" spellcheck="true">! Reset flag to print next one</span>
<span class="token number">40090</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">40100</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">40110</span>     <span class="token keyword">NEXT</span> I
<span class="token number">40120</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">40130</span> SUBEND  <span class="token comment" spellcheck="true">!...............Printtableslid..........</span>


<span class="token number">40140</span> Storetabslid<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Storetabslid<span class="token punctuation">(</span>Ctype$<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Systuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Totuncert<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Table1c$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">40150</span>   <span class="token comment" spellcheck="true">! Store final data in string arrays for sliding termination</span>
<span class="token number">40160</span>   !
<span class="token number">40170</span>   <span class="token comment" spellcheck="true">! INPUT: Ctype$= shortened version of Connector type used</span>
<span class="token number">40180</span>   <span class="token comment" spellcheck="true">!        Avgs(*)= final average of variables for each freq: Gamma,</span>
<span class="token number">40190</span>   <span class="token comment" spellcheck="true">!        circle fit, radius ratio.  Sc(*)= connector deviation for</span>
<span class="token number">40200</span>   <span class="token comment" spellcheck="true">!        each freq.</span>
<span class="token number">40210</span>   <span class="token comment" spellcheck="true">!        Snist(*)= between cals deviation for each freq, Systuncert(*)=</span>
<span class="token number">40220</span>   <span class="token comment" spellcheck="true">!        systematic uncert for each freq, Totuncert(*)= total uncert</span>
<span class="token number">40230</span>   <span class="token comment" spellcheck="true">!        for each freq.</span>
<span class="token number">40240</span>   !
<span class="token number">40250</span>   <span class="token comment" spellcheck="true">! OUTPUT: Table1$(*)= data in table form for use in reports.</span>
<span class="token number">40260</span>   <span class="token comment" spellcheck="true">!         Db1port$(*)= data for use in data bases.</span>
<span class="token number">40270</span>   !
<span class="token number">40280</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">40290</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$<span class="token punctuation">,</span>Devicedescript$<span class="token punctuation">,</span>Oneportonly
<span class="token number">40300</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">40310</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">40320</span>   <span class="token keyword">DIM</span> S$<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>[<span class="token number">12</span>]<span class="token punctuation">,</span>Buttons$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>[<span class="token number">3</span>]<span class="token punctuation">,</span>S1$<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>[<span class="token number">12</span>]
<span class="token number">40330</span>   !
<span class="token number">40340</span>   <span class="token keyword">IF</span> PROUND<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">-5</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">AND</span> PROUND<span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">-5</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">40350</span>     Slidload<span class="token operator">=</span><span class="token number">1</span>     <span class="token comment" spellcheck="true">! SLIDING LOAD</span>
<span class="token number">40360</span>   <span class="token keyword">ELSE</span>
<span class="token number">40370</span>     Slidshort<span class="token operator">=</span><span class="token number">1</span>    <span class="token comment" spellcheck="true">! SLIDING SHORT</span>
<span class="token number">40380</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">40381</span>   Buttons$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"NO"</span>
<span class="token number">40382</span>   Buttons$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"YES"</span>
<span class="token number">40383</span>   <span class="token keyword">IF</span> Slidload<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> DIALOG <span class="token string">"QUESTION"</span><span class="token punctuation">,</span><span class="token string">"Is this a sliding short being CALREPed as a sliding load ?"</span><span class="token punctuation">,</span>Btn<span class="token punctuation">;</span><span class="token function">SET</span> <span class="token punctuation">(</span><span class="token string">"DIALOG BUTTONS"</span><span class="token punctuation">:</span>Buttons$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"PEN"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"X"</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">"Y"</span><span class="token punctuation">:</span><span class="token number">250</span><span class="token punctuation">)</span>
<span class="token number">40390</span>   !
<span class="token number">40400</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs  <span class="token comment" spellcheck="true">! Each freq</span>
<span class="token number">40410</span>     Numfiles<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! # of files input for this freq</span>
<span class="token number">40420</span>     <span class="token keyword">IF</span> Slidload <span class="token keyword">THEN</span>
<span class="token number">40430</span>       Syst1<span class="token operator">=</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">40440</span>       <span class="token keyword">IF</span> Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">40450</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,Z.3D"</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Frequency</span>
<span class="token number">40451</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D,A"</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span> <span class="token comment" spellcheck="true">! Frequency</span>
<span class="token number">40460</span>       <span class="token keyword">ELSE</span>
<span class="token number">40470</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2D.3D"</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span>
<span class="token number">40471</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2D.3D,A"</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">40480</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">40490</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Gamma mag</span>
<span class="token number">40491</span>       <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>   <span class="token comment" spellcheck="true">! Gamma mag</span>
<span class="token number">40500</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>Syst1<span class="token comment" spellcheck="true">! Syst uncert of Gammma mag</span>
<span class="token number">40501</span>       <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Syst1<span class="token punctuation">,</span><span class="token string">","</span>         <span class="token comment" spellcheck="true">! Syst uncert of Gammma mag</span>
<span class="token number">40510</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Snist of Gamma mag</span>
<span class="token number">40511</span>       <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>  <span class="token comment" spellcheck="true">! Snist of Gamma mag</span>
<span class="token number">40520</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Connector uncert Gamma</span>
<span class="token number">40521</span>       <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>     <span class="token comment" spellcheck="true">! Connector uncert Gamma</span>
<span class="token number">40530</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,Z.4D"</span><span class="token punctuation">;</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Total uncert</span>
<span class="token number">40531</span>       <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>   <span class="token comment" spellcheck="true">! Total uncert</span>
<span class="token number">40540</span>       <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Gamma phase</span>
<span class="token number">40550</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,A,2X,MZ.4D"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">40551</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,MZ.4D,A"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">40560</span>       <span class="token keyword">ELSE</span>
<span class="token number">40570</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,A,1X,M2D.4D"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">40571</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,M2D.4D,A"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">40580</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">40590</span>       <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Vswr</span>
<span class="token number">40600</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"# ,4X,ZD.4D"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">40601</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,ZD.4D,A"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">40610</span>       <span class="token keyword">ELSE</span>
<span class="token number">40611</span>         <span class="token keyword">IF</span> Btn<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span>
<span class="token number">40620</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,D.4D"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">40621</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,D.4D,A"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">40622</span>         <span class="token keyword">ELSE</span>
<span class="token number">40623</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,3D.2D"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">40624</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.2D,A"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">40625</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">40630</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">40640</span>       <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Circle ratio</span>
<span class="token number">40650</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,4X,Z.5D"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">40651</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.5D"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">40660</span>       <span class="token keyword">ELSE</span>
<span class="token number">40670</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,D.5D"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">40671</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,D.5D"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">40680</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">40690</span>       <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">11</span>
<span class="token number">40700</span>         Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>S$<span class="token punctuation">(</span>J<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add new line to table</span>
<span class="token number">40701</span>         Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span>TRIM$<span class="token punctuation">(</span>S1$<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add new line to table</span>
<span class="token number">40710</span>       <span class="token keyword">NEXT</span> J
<span class="token number">40720</span>       Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">40721</span>       <span class="token keyword">IF</span> I<span class="token operator">&lt;</span>Numfreqs <span class="token keyword">THEN</span> Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span>Table1c$<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Add CR &amp; LF for DOS</span>
<span class="token number">40730</span>   !
<span class="token number">40740</span>     <span class="token keyword">ELSE</span>   <span class="token comment" spellcheck="true">! SLIDING SHORT</span>
<span class="token number">40750</span>       <span class="token keyword">FOR</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numrepeats
<span class="token number">40760</span>         <span class="token keyword">IF</span> Easet<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Print freq for first setting only</span>
<span class="token number">40770</span>           <span class="token keyword">IF</span> Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">40780</span>             <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,1X,Z.3D"</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Frequency</span>
<span class="token number">40781</span>             <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D,A"</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span><span class="token comment" spellcheck="true">! Frequency</span>
<span class="token number">40790</span>           <span class="token keyword">ELSE</span>
<span class="token number">40800</span>             <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2D.3D"</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span>
<span class="token number">40801</span>             <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2D.3D,A"</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">40810</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">40820</span>         <span class="token keyword">ELSE</span>
<span class="token number">40830</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,6X"</span>
<span class="token number">40831</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,A,A"</span><span class="token punctuation">;</span><span class="token string">"-"</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">40840</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">40850</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,5A"</span><span class="token punctuation">;</span>Setting$<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span>
<span class="token number">40851</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,5A,A"</span><span class="token punctuation">;</span>Setting$<span class="token punctuation">(</span>Easet<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">40860</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X,Z.4D"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Gamma mag</span>
<span class="token number">40861</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>       <span class="token comment" spellcheck="true">! Gamma mag</span>
<span class="token number">40870</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X,Z.4D"</span><span class="token punctuation">;</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Syst uncert of Gammma mag</span>
<span class="token number">40871</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>  <span class="token comment" spellcheck="true">! Syst uncert of Gammma mag</span>
<span class="token number">40880</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X,Z.4D"</span><span class="token punctuation">;</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Snist of Gamma mag</span>
<span class="token number">40881</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span><span class="token comment" spellcheck="true">! Snist of Gamma mag</span>
<span class="token number">40890</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X,Z.4D"</span><span class="token punctuation">;</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Connector uncert Gamma</span>
<span class="token number">40891</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>         <span class="token comment" spellcheck="true">! Connector uncert Gamma</span>
<span class="token number">40900</span>         <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X,Z.4D"</span><span class="token punctuation">;</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Total uncert</span>
<span class="token number">40901</span>         <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>   <span class="token comment" spellcheck="true">! Total uncert</span>
<span class="token number">40910</span>         !
<span class="token number">40920</span>         <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Gamma phase</span>
<span class="token number">40930</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,4X,MZ.D"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">40931</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,MZ.D,A"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">40940</span>         <span class="token keyword">ELSE</span>
<span class="token number">40950</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2X,M3D.D"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">40951</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,M3D.D,A"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">40960</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">40970</span>         <span class="token keyword">IF</span> Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">40980</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X,3D.D"</span><span class="token punctuation">;</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Syst uncert of Gammma arg</span>
<span class="token number">40981</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.D,A"</span><span class="token punctuation">;</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>   <span class="token comment" spellcheck="true">! Syst uncert of Gammma arg</span>
<span class="token number">40990</span>         <span class="token keyword">ELSE</span>
<span class="token number">41000</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3X,Z.D"</span><span class="token punctuation">;</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Syst uncert of Gammma arg</span>
<span class="token number">41001</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.D,A"</span><span class="token punctuation">;</span>Systuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span><span class="token comment" spellcheck="true">! Syst uncert of Gammma arg</span>
<span class="token number">41010</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">41020</span>         <span class="token keyword">IF</span> Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">41030</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X,3D.D"</span><span class="token punctuation">;</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Snist of Gamma mag</span>
<span class="token number">41031</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.D,A"</span><span class="token punctuation">;</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span><span class="token comment" spellcheck="true">! Snist of Gamma mag</span>
<span class="token number">41040</span>         <span class="token keyword">ELSE</span>
<span class="token number">41050</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3X,Z.D"</span><span class="token punctuation">;</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Snist of Gamma mag</span>
<span class="token number">41051</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.D,A"</span><span class="token punctuation">;</span>Snist<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>   <span class="token comment" spellcheck="true">! Snist of Gamma mag</span>
<span class="token number">41060</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">41070</span>         <span class="token keyword">IF</span> Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">41080</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X,3D.D"</span><span class="token punctuation">;</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Connector uncert Gamma</span>
<span class="token number">41081</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.D,A"</span><span class="token punctuation">;</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>     <span class="token comment" spellcheck="true">! Connector uncert Gamma</span>
<span class="token number">41090</span>         <span class="token keyword">ELSE</span>
<span class="token number">41100</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3X,Z.D"</span><span class="token punctuation">;</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Connector uncert Gamma</span>
<span class="token number">41101</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.D"</span><span class="token punctuation">;</span>Sc<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">","</span>        <span class="token comment" spellcheck="true">! Connector uncert Gamma</span>
<span class="token number">41110</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">41120</span>         <span class="token keyword">IF</span> Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">41130</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X,3D.D"</span><span class="token punctuation">;</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Total uncert</span>
<span class="token number">41131</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.D"</span><span class="token punctuation">;</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Total uncert</span>
<span class="token number">41140</span>         <span class="token keyword">ELSE</span>
<span class="token number">41150</span>           <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3X,Z.D"</span><span class="token punctuation">;</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Total uncert</span>
<span class="token number">41151</span>           <span class="token function">OUTPUT</span> S1$<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.D"</span><span class="token punctuation">;</span>Totuncert<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Easet<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Total uncert</span>
<span class="token number">41160</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">41170</span>         !
<span class="token number">41180</span>         Index<span class="token operator">=</span><span class="token punctuation">(</span>I<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>Numrepeats<span class="token operator">+</span>Easet
<span class="token number">41190</span>         <span class="token keyword">FOR</span> J<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">12</span>
<span class="token number">41200</span>           Table1$<span class="token punctuation">(</span>Index<span class="token punctuation">)</span><span class="token operator">=</span>Table1$<span class="token punctuation">(</span>Index<span class="token punctuation">)</span><span class="token operator">&amp;</span>S$<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Add new line to table</span>
<span class="token number">41201</span>           Table1c$<span class="token punctuation">(</span>Index<span class="token punctuation">)</span><span class="token operator">=</span>Table1c$<span class="token punctuation">(</span>Index<span class="token punctuation">)</span><span class="token operator">&amp;</span>TRIM$<span class="token punctuation">(</span>S1$<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Add new line to table</span>
<span class="token number">41210</span>         <span class="token keyword">NEXT</span> J
<span class="token number">41220</span>         Table1$<span class="token punctuation">(</span>Index<span class="token punctuation">)</span><span class="token operator">=</span>Table1$<span class="token punctuation">(</span>Index<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">!  CR,LF for DOS</span>
<span class="token number">41221</span>         <span class="token keyword">IF</span> I<span class="token operator">&lt;</span>Numfreqs <span class="token keyword">THEN</span> Table1c$<span class="token punctuation">(</span>Index<span class="token punctuation">)</span><span class="token operator">=</span>Table1c$<span class="token punctuation">(</span>Index<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">!  CR,LF for DOS</span>
<span class="token number">41230</span>       <span class="token keyword">NEXT</span> Easet
<span class="token number">41240</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">41250</span>     !
<span class="token number">41260</span>    <span class="token comment" spellcheck="true">! IF Slidload THEN</span>
<span class="token number">41270</span>    <span class="token comment" spellcheck="true">!   Magg=Avgs(I,1,1)</span>
<span class="token number">41280</span>    <span class="token comment" spellcheck="true">!   Argg=Avgs(I,1,2)</span>
<span class="token number">41290</span>    <span class="token comment" spellcheck="true">!   Vswr=Avgs(I,1,3)</span>
<span class="token number">41300</span>    <span class="token comment" spellcheck="true">!   Sr=Avgs(I,1,4)</span>
<span class="token number">41301</span>     <span class="token comment" spellcheck="true">!  IF Btn=0 THEN</span>
<span class="token number">41310</span>     <span class="token comment" spellcheck="true">!    OUTPUT Db1port$(I) USING 41320;Nisttestno$,Ctype$,Freq(I),Numfiles,Numrepeats,Magg,Syst1,Snist(I,1,1),Sc(I,1,1),Totuncert(I,1,1),Argg,Vswr,Sr</span>
<span class="token number">41311</span>     <span class="token comment" spellcheck="true">!  ELSE</span>
<span class="token number">41312</span>     <span class="token comment" spellcheck="true">!    OUTPUT Db1port$(I) USING 41321;Nisttestno$,Ctype$,Freq(I),Numfiles,Numrepeats,Magg,Syst1,Snist(I,1,1),Sc(I,1,1),Totuncert(I,1,1),Argg,Vswr,Sr</span>
<span class="token number">41313</span>     <span class="token comment" spellcheck="true">!  END IF</span>
<span class="token number">41320</span>     <span class="token comment" spellcheck="true">!  IMAGE #,6A,1X,6A,1X,DD.3D,1X,DD,1X,DD,1X,D.5D,1X,D.5D,1X,D.5D,1X,D.5D,1X,D.5D,1X,D.5D,1X,D.5D,1X,D.5D</span>
<span class="token number">41321</span>     <span class="token comment" spellcheck="true">!  IMAGE #,6A,1X,6A,1X,DD.3D,1X,DD,1X,DD,1X,D.5D,1X,D.5D,1X,D.5D,1X,D.5D,1X,D.5D,1X,D.5D,1X,3D.2D,1X,D.5D</span>
<span class="token number">41330</span>     !
<span class="token number">41340</span>   <span class="token comment" spellcheck="true">!  ELSE   ! SLID SHORT</span>
<span class="token number">41350</span>   <span class="token comment" spellcheck="true">!    FOR Easet=1 TO Numrepeats</span>
<span class="token number">41360</span>   <span class="token comment" spellcheck="true">!      Index=(I-1)*Numrepeats+Easet</span>
<span class="token number">41370</span>   <span class="token comment" spellcheck="true">!      Magg=Avgs(I,Easet,1)</span>
<span class="token number">41380</span>   <span class="token comment" spellcheck="true">!      Argg=Avgs(I,Easet,2)</span>
<span class="token number">41390</span>       <span class="token comment" spellcheck="true">!  OUTPUT Db1port$(Index) USING Slshort;Nisttestno$,Ctype$,Freq(I),Setting$(Easet),Numconnects,Magg,Sc(I,Easet,1),Argg,Sc(I,Easet,2)</span>
<span class="token number">41400</span> Slshort<span class="token punctuation">:</span> <span class="token function">IMAGE</span> #<span class="token punctuation">,</span><span class="token number">6</span>A<span class="token punctuation">,</span>X<span class="token punctuation">,</span><span class="token number">6</span>A<span class="token punctuation">,</span>X<span class="token punctuation">,</span>DD.<span class="token number">3</span>D<span class="token punctuation">,</span>X<span class="token punctuation">,</span><span class="token number">5</span>A<span class="token punctuation">,</span>X<span class="token punctuation">,</span>DD<span class="token punctuation">,</span>X<span class="token punctuation">,</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span>X<span class="token punctuation">,</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span>X<span class="token punctuation">,</span>M3D.D<span class="token punctuation">,</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.D
<span class="token number">41410</span>   <span class="token comment" spellcheck="true">!    NEXT Easet</span>
<span class="token number">41420</span>   <span class="token comment" spellcheck="true">!  END IF</span>
<span class="token number">41430</span>   <span class="token keyword">NEXT</span> I
<span class="token number">41440</span> SUBEND     <span class="token comment" spellcheck="true">!............Storetabslid.............</span>


<span class="token number">41450</span> Freqlist<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Freqlist<span class="token punctuation">(</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">)</span>
<span class="token number">41460</span> <span class="token comment" spellcheck="true">! Enter freqs to be measured or remeasured one at a time.</span>
<span class="token number">41470</span> !
<span class="token number">41480</span> <span class="token comment" spellcheck="true">! OUTPUT: Freq(Numfreqs)= array of frequencies to be measured in GHz.</span>
<span class="token number">41490</span> <span class="token comment" spellcheck="true">!         Numfreqs= number of frequencies in Freq(*).</span>
<span class="token number">41500</span> !
<span class="token number">41510</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">41520</span>   <span class="token keyword">REDIM</span> Freq<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! In case freqs still in COM from previous run.</span>
<span class="token number">41530</span>   <span class="token keyword">CLEAR</span> SCREEN
<span class="token number">41540</span>   !
<span class="token number">41550</span>   <span class="token keyword">IF</span> <span class="token operator">NOT</span> Remeasure <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"Input frequencies in "</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">135</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">" GHz "</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">" (at most 106); terminate list with a zero."</span>
<span class="token number">41560</span>   !
<span class="token number">41570</span>   I<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">41580</span>   CONTROL <span class="token number">1</span><span class="token punctuation">;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span>
<span class="token number">41590</span>   <span class="token function">REPEAT</span>   <span class="token comment" spellcheck="true">! Until fill list or operator enters a 0, or all remeas chosen</span>
<span class="token number">41600</span>     I<span class="token operator">=</span>I<span class="token operator">+</span><span class="token number">1</span>
<span class="token number">41610</span>     <span class="token function">OUTPUT</span> KBD <span class="token keyword">USING</span> <span class="token string">"#,K"</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"H"</span> <span class="token comment" spellcheck="true">! Current Freq(I)</span>
<span class="token number">41620</span>     DISP <span class="token keyword">USING</span> <span class="token string">"#,2(K)"</span><span class="token punctuation">;</span><span class="token string">"Frequency #"</span><span class="token punctuation">,</span>I
<span class="token number">41630</span>     <span class="token keyword">INPUT</span> <span class="token string">"  ?"</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Get freq to add to list</span>
<span class="token number">41640</span>     <span class="token keyword">IF</span> Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> <span class="token number">1</span> <span class="token keyword">USING</span> <span class="token string">"10X,K,K,X,A,X,K"</span><span class="token punctuation">;</span><span class="token string">"Frequency #"</span><span class="token punctuation">,</span>I<span class="token punctuation">,</span><span class="token string">"="</span><span class="token punctuation">,</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span>
<span class="token number">41650</span>   <span class="token comment" spellcheck="true">! Until list full, 0 entered</span>
<span class="token number">41660</span>   <span class="token keyword">UNTIL</span> <span class="token punctuation">(</span>I<span class="token operator">&gt;</span><span class="token number">300</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token punctuation">(</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token number">41670</span>   !
<span class="token number">41680</span>   Numfreqs<span class="token operator">=</span>I<span class="token operator">-</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! New number of freqs</span>
<span class="token number">41690</span>   <span class="token keyword">FOR</span> I<span class="token operator">=</span>Numfreqs<span class="token operator">+</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">300</span>    <span class="token comment" spellcheck="true">! Clear unused elements of Freq(*)</span>
<span class="token number">41700</span>     Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token number">41710</span>   <span class="token keyword">NEXT</span> I
<span class="token number">41720</span>   <span class="token keyword">REDIM</span> Freq<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span>
<span class="token number">41730</span>   <span class="token function">MAT</span> SORT Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">! Sort in order in case operator added a freq</span>
<span class="token number">41740</span> SUBEND <span class="token comment" spellcheck="true">!................... Freqlist ...................................</span>


<span class="token number">41750</span> Freqsteps<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Freqsteps<span class="token punctuation">(</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">)</span>
<span class="token number">41760</span>  <span class="token comment" spellcheck="true">! Enter a start, stop, step freq and calculate the freq list from them.</span>
<span class="token number">41770</span>  <span class="token comment" spellcheck="true">! OUTPUT:  Freq(Numfreqs)= array of freqs to be measured in GHz,</span>
<span class="token number">41780</span>  <span class="token comment" spellcheck="true">!          Numfreqs= number of frequencies in Freq(*).</span>
<span class="token number">41790</span>  !
<span class="token number">41800</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">41810</span>   <span class="token keyword">REDIM</span> Freq<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! Start at original size in case Freq(*) still defined</span>
<span class="token number">41820</span>                   <span class="token comment" spellcheck="true">! in COM from the previous run.</span>
<span class="token number">41830</span>  !
<span class="token number">41840</span>   <span class="token keyword">LOOP</span> <span class="token comment" spellcheck="true">! Until have valid number of freqs in list</span>
<span class="token number">41850</span>     <span class="token keyword">IF</span> Numfreqs<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Output current start, stop, step for operator</span>
<span class="token number">41860</span>       <span class="token function">OUTPUT</span> KBD<span class="token punctuation">;</span><span class="token function">VAL$</span><span class="token punctuation">(</span>Freq<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">","</span><span class="token punctuation">;</span><span class="token function">VAL$</span><span class="token punctuation">(</span>Freq<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">","</span><span class="token punctuation">;</span><span class="token function">VAL$</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Freq<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span><span class="token operator">-</span>Freq<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>Numfreqs<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"H"</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">! Defaults</span>
<span class="token number">41870</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">41880</span>     DISP <span class="token string">"Start, Stop &amp; Step frequencies (in "</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">135</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"GHz"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">")?"</span><span class="token punctuation">;</span>
<span class="token number">41890</span>     <span class="token keyword">KEY</span> LABELS <span class="token keyword">OFF</span>
<span class="token number">41900</span>     <span class="token keyword">INPUT</span> Fstart<span class="token punctuation">,</span>Fstop<span class="token punctuation">,</span>Fstep
<span class="token number">41910</span>     Numfreqs<span class="token operator">=</span><span class="token function">INT</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Fstop<span class="token operator">-</span>Fstart<span class="token punctuation">)</span><span class="token operator">/</span>Fstep<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Number of freqs in list</span>
<span class="token number">41920</span>   <span class="token keyword">EXIT</span> <span class="token keyword">IF</span> Numfreqs<span class="token operator">&lt;=</span><span class="token number">300</span>    <span class="token comment" spellcheck="true">! Have valid number in the list</span>
<span class="token number">41930</span>     <span class="token function">OUTPUT</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token string">"ACHTUNG... Number of freqs must be &lt;= 300 ... try again!"</span>
<span class="token number">41940</span>   <span class="token keyword">END</span> <span class="token keyword">LOOP</span>   <span class="token comment" spellcheck="true">! Continue until have a valid list</span>
<span class="token number">41950</span>   !
<span class="token number">41960</span>   <span class="token keyword">FOR</span> Q<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs    <span class="token comment" spellcheck="true">! Convert start,stop,step into frequency list</span>
<span class="token number">41970</span>     Freq<span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token operator">=</span>PROUND<span class="token punctuation">(</span>Fstart<span class="token operator">+</span><span class="token punctuation">(</span>Q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>Fstep<span class="token punctuation">,</span><span class="token number">-5</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">! PROUND to avoid machine error</span>
<span class="token number">41980</span>   <span class="token keyword">NEXT</span> Q
<span class="token number">41990</span>   <span class="token keyword">REDIM</span> Freq<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span>
<span class="token number">42000</span> SUBEND <span class="token comment" spellcheck="true">!................... Freqsteps ..................................</span>


<span class="token number">42010</span> Uncertcalconly<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Uncertcalconly
<span class="token number">42020</span>  <span class="token comment" spellcheck="true">! Routine asks operator which variable to calculate Type A (Snist) and</span>
<span class="token number">42030</span>  <span class="token comment" spellcheck="true">!   Type B uncerts for:  Gamma (or S11, S22), S12, or efficiency.  Also</span>
<span class="token number">42040</span>  <span class="token comment" spellcheck="true">!   input are freq list &amp; connector type for the calcs, and, if variable</span>
<span class="token number">42050</span>  <span class="token comment" spellcheck="true">!   is efficiency, and device is to be </span><span class="token string">"measured"</span> <span class="token keyword">on</span> Direct comparison
<span class="token number">42060</span>  <span class="token comment" spellcheck="true">!   system, the mismatch uncert term is needed.   Magnitude &amp; phase info</span>
<span class="token number">42070</span>  <span class="token comment" spellcheck="true">!   for the variable is also input.</span>
<span class="token number">42080</span>  <span class="token comment" spellcheck="true">! OUTPUT: Freq(*)= the freq list used, Numfreqs= the # of freqs,</span>
<span class="token number">42090</span>  <span class="token comment" spellcheck="true">!    Numconnects=1, and Numrepeats=1, &amp; Meastype$= type of device</span>
<span class="token number">42100</span>  !
<span class="token number">42110</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">42120</span>   <span class="token function">DEG</span>
<span class="token number">42130</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">42140</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">42150</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Printer<span class="token operator">/</span>@Prt<span class="token punctuation">,</span>Prt
<span class="token number">42160</span>   Numconnects<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">42170</span>   Numrepeats<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">42180</span>   !
<span class="token number">42190</span>   <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to make an ASCII file of the uncertainties?"</span><span class="token punctuation">,</span>Makefile<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">42200</span> Again<span class="token punctuation">:</span> <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"For what variable do you want to calculate uncertainties?"</span><span class="token punctuation">,</span>Ans<span class="token punctuation">,</span><span class="token string">"01Gamma;02S12;03Efficiency;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">42210</span>   <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">42220</span>     Meastype$<span class="token operator">=</span><span class="token string">"1-port"</span>
<span class="token number">42230</span>     Numvars<span class="token operator">=</span><span class="token number">10</span>  <span class="token comment" spellcheck="true">! To flag in subs that uncert calcs done for Gamma only</span>
<span class="token number">42240</span>     Var<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">42250</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">42260</span>   <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span>
<span class="token number">42270</span>     Meastype$<span class="token operator">=</span><span class="token string">"2-port"</span>
<span class="token number">42280</span>     Numvars<span class="token operator">=</span><span class="token number">30</span>  <span class="token comment" spellcheck="true">! To flag in subs that uncert calcs done for S12 only</span>
<span class="token number">42290</span>     Var<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">42300</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">42310</span>   <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">THEN</span>
<span class="token number">42320</span>     Meastype$<span class="token operator">=</span><span class="token string">"Thermistor"</span>
<span class="token number">42330</span>     Numvars<span class="token operator">=</span><span class="token number">20</span>  <span class="token comment" spellcheck="true">! To flag in subs that uncert calcs done for Effic only</span>
<span class="token number">42340</span>     Var<span class="token operator">=</span><span class="token number">2</span>
<span class="token number">42350</span>     <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to calc uncertainties for the Direct Comparison System?"</span><span class="token punctuation">,</span>Dircomp<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">42360</span>     <span class="token keyword">IF</span> Dircomp <span class="token keyword">THEN</span> <span class="token keyword">INPUT</span> <span class="token string">"Enter the mismatch term uncertainty to use"</span><span class="token punctuation">,</span>Mismatch
<span class="token number">42370</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">42380</span>   !
<span class="token number">42390</span>   <span class="token keyword">INPUT</span> <span class="token string">"Enter MAGNITUDE of the variable"</span><span class="token punctuation">,</span>Magvar
<span class="token number">42400</span>   <span class="token keyword">IF</span> Ans<span class="token operator">&lt;&gt;</span><span class="token number">3</span> <span class="token keyword">THEN</span> <span class="token keyword">INPUT</span> <span class="token string">"Enter PHASE in degrees of the variable"</span><span class="token punctuation">,</span>Phasevar
<span class="token number">42410</span>   <span class="token function">OUTPUT</span> KBD<span class="token punctuation">;</span>Connector$<span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"H"</span><span class="token punctuation">;</span>
<span class="token number">42420</span>   LINPUT <span class="token string">"Enter a short description of the connector type (e.g. WR90 or 7 mm)"</span><span class="token punctuation">,</span>Connector$
<span class="token number">42430</span>   !
<span class="token number">42440</span>   <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Are you using Fstart Fstop Fstep?"</span><span class="token punctuation">,</span>Fsfsfsp<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">42450</span>   <span class="token keyword">IF</span> Fsfsfsp <span class="token keyword">THEN</span>
<span class="token number">42460</span>     <span class="token keyword">CALL</span> Freqsteps<span class="token punctuation">(</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">)</span>
<span class="token number">42470</span>   <span class="token keyword">ELSE</span>
<span class="token number">42480</span>     <span class="token keyword">CALL</span> Freqlist<span class="token punctuation">(</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">)</span>
<span class="token number">42490</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">42500</span>   ALLOCATE Avgs<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">42510</span>   ALLOCATE Fileavg<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">42520</span>   <span class="token keyword">IF</span> Makefile <span class="token keyword">THEN</span>
<span class="token number">42530</span>     ALLOCATE Disc$[<span class="token number">30</span>]<span class="token punctuation">,</span>Dir$[<span class="token number">30</span>]<span class="token punctuation">,</span>Filename$[<span class="token number">30</span>]
<span class="token number">42540</span>     <span class="token function">OUTPUT</span> KBD<span class="token punctuation">;</span><span class="token string">"G:"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"H"</span><span class="token punctuation">;</span>
<span class="token number">42550</span>     LINPUT <span class="token string">"ENTER DISC WHERE FILE IS TO BE CREATED"</span><span class="token punctuation">,</span>Disc$
<span class="token number">42560</span>     LINPUT <span class="token string">"ENTER DIRECTORY (if any) WHERE FILE IS TO BE CREATED"</span><span class="token punctuation">,</span>Dir$
<span class="token number">42570</span>     LINPUT <span class="token string">"ENTER A NAME for the file"</span><span class="token punctuation">,</span>Filename$
<span class="token number">42580</span>     CREATE Disc$<span class="token operator">&amp;</span>Dir$<span class="token operator">&amp;</span>Filename$<span class="token punctuation">,</span>Numfreqs
<span class="token number">42590</span>     ALLOCATE Strarr$<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span>[<span class="token number">120</span>]
<span class="token number">42600</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">42610</span>   Sport<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token number">42620</span>  !
<span class="token number">42630</span>   DISP <span class="token string">"... CALCULATING TYPE A Snist AND TYPE B UNCERTAINTIES ..."</span>
<span class="token number">42640</span>   <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs
<span class="token number">42650</span>     Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token punctuation">)</span><span class="token operator">=</span>Magvar
<span class="token number">42660</span>     Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Phasevar
<span class="token number">42670</span>     <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">THEN</span>
<span class="token number">42680</span>       Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token number">42690</span>       Filesperfreq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token number">42700</span>       <span class="token keyword">IF</span> <span class="token operator">NOT</span> Dircomp <span class="token keyword">THEN</span> Fileavg<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token number">42710</span>       <span class="token keyword">IF</span> Dircomp <span class="token keyword">THEN</span> Pwrstd<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>Eafreq<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">=</span>Mismatch
<span class="token number">42720</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">42730</span>   <span class="token keyword">NEXT</span> Eafreq
<span class="token number">42740</span>  !
<span class="token number">42750</span>   <span class="token keyword">CALL</span> Snist<span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span>Numsets<span class="token punctuation">,</span>Connector$<span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numvars<span class="token punctuation">,</span>Ps<span class="token punctuation">,</span>Va<span class="token punctuation">,</span>Sl<span class="token punctuation">,</span>Ss<span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">42760</span>  !
<span class="token number">42770</span>   <span class="token keyword">IF</span> Meastype$<span class="token operator">=</span><span class="token string">"1-port"</span> <span class="token operator">OR</span> Meastype$<span class="token operator">=</span><span class="token string">"2-port"</span> <span class="token keyword">THEN</span> <span class="token keyword">CALL</span> Syst1or2port<span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span>Connector$<span class="token punctuation">,</span>Numvars<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Ps<span class="token punctuation">,</span>Va<span class="token punctuation">,</span>Sl<span class="token punctuation">,</span>Ss<span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">42780</span>   <span class="token keyword">IF</span> Meastype$<span class="token operator">=</span><span class="token string">"Thermistor"</span> <span class="token keyword">THEN</span> <span class="token keyword">CALL</span> Systpower<span class="token punctuation">(</span>Meastype$<span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connector$<span class="token punctuation">,</span>Numvars<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Fileavg<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">42790</span>   !
<span class="token number">42800</span>   PRINTER <span class="token function">IS</span> Prt
<span class="token number">42810</span>   <span class="token function">PRINT</span> <span class="token string">"CALREP7.1     "</span><span class="token punctuation">;</span><span class="token function">DATE$</span><span class="token punctuation">(</span>TIMEDATE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"    Type A (Snist) and Type B calculations"</span>
<span class="token number">42820</span>   <span class="token function">PRINT</span>
<span class="token number">42830</span>   <span class="token function">PRINT</span> <span class="token string">"CONNECTOR TYPE = "</span><span class="token punctuation">;</span>Connector$<span class="token punctuation">;</span><span class="token string">"    VARIABLE = "</span><span class="token punctuation">;</span>
<span class="token number">42840</span>   <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">PRINT</span> <span class="token string">"Gamma"</span>
<span class="token number">42850</span>   <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token function">PRINT</span> <span class="token string">"S12"</span>
<span class="token number">42860</span>   <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">THEN</span> <span class="token function">PRINT</span> <span class="token string">"Efficiency"</span>
<span class="token number">42870</span>   <span class="token keyword">IF</span> Dircomp <span class="token keyword">THEN</span> <span class="token function">PRINT</span> <span class="token string">"MISMATCH TERM UNCERTAINTY = "</span><span class="token punctuation">;</span>Mismatch
<span class="token number">42880</span>   <span class="token function">PRINT</span>
<span class="token number">42890</span>   <span class="token function">PRINT</span> <span class="token string">" Freq     Mag     TypeA   TypeB   Uc      Phase    TypeA   TypeB    Uc"</span>
<span class="token number">42900</span>   <span class="token keyword">FOR</span> Eafreq<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfreqs
<span class="token number">42910</span>     Utmag<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">42920</span>     <span class="token function">PRINT</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.3D,X,2D.4D,X,2D.4D,X,2D.4D,X,2D.4D"</span><span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token punctuation">)</span><span class="token punctuation">,</span>Utmag
<span class="token number">42930</span>     Utphas<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">SQR</span><span class="token punctuation">(</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">42940</span>     <span class="token keyword">IF</span> Ans<span class="token operator">&lt;&gt;</span><span class="token number">3</span> <span class="token keyword">THEN</span> <span class="token function">PRINT</span> <span class="token keyword">USING</span> <span class="token string">"2X,M3D.2D,X,3D.3D,X,3D.2D,X,3D.2D"</span><span class="token punctuation">;</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Utphas
<span class="token number">42950</span>     <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">THEN</span> <span class="token function">PRINT</span>
<span class="token number">42960</span>     <span class="token keyword">IF</span> Makefile <span class="token keyword">THEN</span>
<span class="token number">42970</span> Fileimg<span class="token punctuation">:</span> <span class="token function">IMAGE</span> #<span class="token punctuation">,</span><span class="token number">4</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">12</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">5</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">4</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">3</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">8</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">9</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">5</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">4</span>X<span class="token punctuation">,</span><span class="token number">3</span>D.<span class="token number">2</span>D<span class="token punctuation">,</span>K<span class="token punctuation">,</span>K
<span class="token number">42980</span> Fileimg2<span class="token punctuation">:</span> <span class="token function">IMAGE</span> #<span class="token punctuation">,</span><span class="token number">4</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">12</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">5</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">4</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span><span class="token number">3</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span>K<span class="token punctuation">,</span>K
<span class="token number">42990</span>       <span class="token keyword">IF</span> Ans<span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> Strarr$<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span> <span class="token keyword">USING</span> Fileimg2<span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">,</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token punctuation">)</span><span class="token punctuation">,</span>Utmag<span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token number">43000</span>       <span class="token keyword">IF</span> Ans<span class="token operator">&lt;&gt;</span><span class="token number">3</span> <span class="token keyword">THEN</span>
<span class="token number">43010</span>         A1<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token punctuation">)</span>
<span class="token number">43020</span>         A2<span class="token operator">=</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token punctuation">)</span>
<span class="token number">43030</span>         A3<span class="token operator">=</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token punctuation">)</span>
<span class="token number">43040</span>         A4<span class="token operator">=</span>Avgs<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">43050</span>         A5<span class="token operator">=</span>Snist<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">43060</span>         A6<span class="token operator">=</span>Syst<span class="token punctuation">(</span>Eafreq<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>Var<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">43070</span>         <span class="token function">OUTPUT</span> Strarr$<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span> <span class="token keyword">USING</span> Fileimg<span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>Eafreq<span class="token punctuation">)</span><span class="token punctuation">,</span>A1<span class="token punctuation">,</span>A2<span class="token punctuation">,</span>A3<span class="token punctuation">,</span>Utmag<span class="token punctuation">,</span>A4<span class="token punctuation">,</span>A5<span class="token punctuation">,</span>A6<span class="token punctuation">,</span>Utphas<span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token number">43080</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">43090</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">43100</span>   <span class="token keyword">NEXT</span> Eafreq
<span class="token number">43110</span>   <span class="token function">PRINT</span>
<span class="token number">43120</span>   PRINTER <span class="token function">IS</span> CRT
<span class="token number">43130</span>   <span class="token keyword">IF</span> Makefile <span class="token keyword">THEN</span>
<span class="token number">43140</span>     ASSIGN @<span class="token keyword">Out</span> <span class="token keyword">TO</span> Dir$<span class="token operator">&amp;</span>Filename$<span class="token operator">&amp;</span>Disc$
<span class="token number">43150</span>     <span class="token function">OUTPUT</span> @<span class="token keyword">Out</span><span class="token punctuation">;</span>Strarr$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">43160</span>     ASSIGN @<span class="token keyword">Out</span> <span class="token keyword">TO</span> <span class="token operator">*</span>
<span class="token number">43170</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">43180</span>   DEALLOCATE Avgs<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Snist<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Syst<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">43190</span>   DEALLOCATE Fileavg<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pwrstd<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">43200</span>   <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to calculate more uncertainties?"</span><span class="token punctuation">,</span>Calcmounc<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">43210</span>   <span class="token keyword">IF</span> Calcmounc <span class="token keyword">THEN</span> <span class="token keyword">GOTO</span> Again
<span class="token number">43220</span>   <span class="token function">PRINT</span> TABXY<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"THIS RUN IS DONE"</span>
<span class="token number">43230</span> SUBEND  <span class="token comment" spellcheck="true">!..............Uncertcalconly..............</span>


<span class="token number">43240</span> Print2nrrawdata<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Print2nrrawdata<span class="token punctuation">(</span>Filename$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>D1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Timea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datea$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cfile$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Cdate$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Connectors$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>@Prt<span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">43250</span>   <span class="token function">DEG</span>
<span class="token number">43260</span>   <span class="token comment" spellcheck="true">! PRINTS FIXED, NON-RECIPROCAL 2-PORT DEVICE'S RAW DATA</span>
<span class="token number">43270</span>   !
<span class="token number">43280</span>   <span class="token comment" spellcheck="true">! NOTE: THIS VERSION ASSUMES 1 REPEAT PER CONNECT</span>
<span class="token number">43290</span>   !
<span class="token number">43300</span>   <span class="token comment" spellcheck="true">! Print data from the Numfiles in Filename$(*).  D1(*) contains</span>
<span class="token number">43310</span>   <span class="token comment" spellcheck="true">!   data for forward direction; D2(*) for reverse, for each freq,</span>
<span class="token number">43320</span>   <span class="token comment" spellcheck="true">!   file, connect, repeat, variable.  Sport(*) contains the port # for</span>
<span class="token number">43330</span>   <span class="token comment" spellcheck="true">!   each file.  Timea$(*), Datea$(*) have time &amp; date of each file,</span>
<span class="token number">43340</span>   <span class="token comment" spellcheck="true">!   Cfile$(*),Cdate$(*)= cal file names &amp; dates,</span>
<span class="token number">43350</span>   <span class="token comment" spellcheck="true">!   Connectors$(*) has connectors used for each file.</span>
<span class="token number">43360</span>   <span class="token comment" spellcheck="true">!   Smoothed is non-zero if S12, S21 data was smoothed (8510/360 ANAs)</span>
<span class="token number">43370</span>   <span class="token comment" spellcheck="true">!  IN COM:  Freq(*)= all Numfreqs freqs measured.  Filesperfreq(*)</span>
<span class="token number">43380</span>   <span class="token comment" spellcheck="true">!     has info on each freq (rows) for how many files had the freq</span>
<span class="token number">43390</span>   <span class="token comment" spellcheck="true">!     (col 1) and which files they were in the order the files</span>
<span class="token number">43400</span>   <span class="token comment" spellcheck="true">!     were read in (col 2.. Numfiles+1)</span>
<span class="token number">43410</span>   !
<span class="token number">43420</span>   <span class="token comment" spellcheck="true">! OUTPUT: A list of all raw data from each file is listed.</span>
<span class="token number">43430</span>   !
<span class="token number">43440</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">43450</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">43460</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">43470</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Qcplotinfo<span class="token operator">/</span>Nisttestno$<span class="token punctuation">,</span>Devicedescript$<span class="token punctuation">,</span>Oneportonly
<span class="token number">43471</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Version<span class="token operator">/</span>Vers$
<span class="token number">43480</span>   !
<span class="token number">43490</span>   <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to print device and file names?"</span><span class="token punctuation">,</span>Prdfns<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">43500</span>   <span class="token keyword">IF</span> Prdfns <span class="token keyword">THEN</span>
<span class="token number">43510</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"Program Version:  "</span><span class="token operator">&amp;</span>Vers$
<span class="token number">43511</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" "</span>
<span class="token number">43512</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"DEVICE DESCRIPTION: "</span><span class="token punctuation">;</span>Devicedescript$
<span class="token number">43520</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                    "</span><span class="token punctuation">;</span>Nisttestno$
<span class="token number">43530</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">43540</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"DATA LISTING FOR"</span><span class="token punctuation">;</span>Numfiles<span class="token punctuation">;</span><span class="token string">" FILES"</span><span class="token operator">&amp;</span><span class="token string">" AND"</span><span class="token punctuation">;</span>Numconnects<span class="token punctuation">;</span><span class="token string">" CONNECTIONS  ....  "</span><span class="token punctuation">;</span><span class="token function">DATE$</span><span class="token punctuation">(</span>TIMEDATE<span class="token punctuation">)</span>
<span class="token number">43550</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"Device was reversed between files: listing shows correct S11-S22 and S12-S21"</span>
<span class="token number">43560</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">43570</span>     <span class="token keyword">IF</span> Smoothed <span class="token keyword">THEN</span>
<span class="token number">43580</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"8510/360 DATA WAS SMOOTHED:  S12, S21 = average of "</span><span class="token punctuation">;</span>Smoothed<span class="token punctuation">;</span><span class="token string">" points"</span>
<span class="token number">43590</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">43600</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">43610</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"FILES :"</span>
<span class="token number">43620</span>     <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numfiles  <span class="token comment" spellcheck="true">! All files</span>
<span class="token number">43630</span>       <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span>Filename$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"  "</span><span class="token punctuation">;</span>Timea$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"   "</span><span class="token punctuation">;</span>Datea$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"    "</span><span class="token punctuation">;</span>Connectors$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">"  2-portNR"</span>
<span class="token number">43640</span>       <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"          ("</span><span class="token punctuation">;</span>Cfile$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">", "</span><span class="token punctuation">;</span>Cdate$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">")   : reversed connection"</span>
<span class="token number">43650</span>       <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"         ("</span><span class="token punctuation">;</span>Cfile$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">", "</span><span class="token punctuation">;</span>Cdate$<span class="token punctuation">(</span>Eafile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string">")   : normal connection"</span>
<span class="token number">43660</span>     <span class="token keyword">NEXT</span> Eafile
<span class="token number">43670</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">43680</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">43690</span>   !
<span class="token number">43700</span>   <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to print the raw data?"</span><span class="token punctuation">,</span>Prrawd<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">43710</span>   <span class="token keyword">IF</span> Prrawd <span class="token keyword">THEN</span>
<span class="token number">43720</span>     <span class="token keyword">IF</span> Numfreqs<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token keyword">THEN</span>
<span class="token number">43730</span>       <span class="token keyword">CALL</span> Keyques<span class="token punctuation">(</span><span class="token string">"Do you want to SKIP PRINTING some of the "</span><span class="token operator">&amp;</span><span class="token function">VAL$</span><span class="token punctuation">(</span>Numfreqs<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">" freqs?"</span><span class="token punctuation">,</span>Skpsome<span class="token punctuation">,</span><span class="token string">"00No;01Yes;09;"</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">,</span>Ud<span class="token punctuation">)</span>
<span class="token number">43740</span>       <span class="token keyword">IF</span> Skpsome <span class="token keyword">THEN</span>
<span class="token number">43750</span>         <span class="token keyword">INPUT</span> <span class="token string">"Enter how many freqs you want to skip (e.g. 5= print freqs 1,7,13 ...)"</span><span class="token punctuation">,</span>Skipnum
<span class="token number">43760</span>         <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" SKIPPING "</span><span class="token punctuation">;</span>Skipnum<span class="token punctuation">;</span><span class="token string">" FREQUENCIES..."</span>
<span class="token number">43770</span>         Skipnum<span class="token operator">=</span>Skipnum<span class="token operator">+</span><span class="token number">1</span>  <span class="token comment" spellcheck="true">! First freq printed: skip Skipnum after it</span>
<span class="token number">43780</span>         Howmany<span class="token operator">=</span>Numfreqs
<span class="token number">43790</span>       <span class="token keyword">ELSE</span>
<span class="token number">43800</span>         DISP <span class="token string">"You measured "</span><span class="token punctuation">;</span>Numfreqs<span class="token punctuation">;</span><span class="token string">" freqs -- for how many freqs do you want raw data?"</span><span class="token punctuation">;</span>
<span class="token number">43810</span>         <span class="token keyword">INPUT</span> Howmany
<span class="token number">43820</span>         <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">" PRINTING RESULTS FOR FIRST "</span><span class="token punctuation">;</span>Howmany<span class="token punctuation">;</span><span class="token string">" FREQS..."</span>
<span class="token number">43830</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">43840</span>     <span class="token keyword">ELSE</span>
<span class="token number">43850</span>       Howmany<span class="token operator">=</span>Numfreqs
<span class="token number">43860</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">43870</span>     Skipit<span class="token operator">=</span><span class="token number">0</span>   <span class="token comment" spellcheck="true">! Flag to skip printing some freqs if operator chose to</span>
<span class="token number">43880</span>     !
<span class="token number">43890</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">43900</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"FREQ  FILE CON        S11               S12             S21          S22      "</span>
<span class="token number">43910</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">"                   MAG   PHASE       MAG   PHASE     MAG   PHASE   MAG   PHASE"</span>
<span class="token number">43920</span>       !
<span class="token number">43930</span>     <span class="token keyword">FOR</span> I<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Howmany   <span class="token comment" spellcheck="true">! Each frequency</span>
<span class="token number">43940</span>       <span class="token keyword">IF</span> Skipit<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">! Print this freq</span>
<span class="token number">43950</span>         Allfiles<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Files with this frequency on the SRM</span>
<span class="token number">43960</span>         <span class="token keyword">FOR</span> Eafile<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Allfiles<span class="token comment" spellcheck="true">! Each file with frequency #I</span>
<span class="token number">43970</span>           J<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>I<span class="token punctuation">,</span>Eafile<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Which file has freq #I</span>
<span class="token number">43980</span>           <span class="token keyword">FOR</span> K<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numconnects<span class="token comment" spellcheck="true">! Each connect</span>
<span class="token number">43990</span>             <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>     <span class="token comment" spellcheck="true">! Data in D1(*) (=Datasp1(*))</span>
<span class="token number">44000</span>               S11<span class="token operator">=</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">44010</span>               <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> B<span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span>S11<span class="token punctuation">,</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D1<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">44020</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">44030</span>             <span class="token keyword">IF</span> Sport<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span>     <span class="token comment" spellcheck="true">! Data in D2(*) (=Datasp2(*))</span>
<span class="token number">44040</span>               S11<span class="token operator">=</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">44050</span>               <span class="token function">OUTPUT</span> @Prt <span class="token keyword">USING</span> B<span class="token punctuation">;</span>Freq<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span>S11<span class="token punctuation">,</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>D2<span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">,</span>K<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token number">44060</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">44070</span> B<span class="token punctuation">:</span>          <span class="token function">IMAGE</span> <span class="token number">2</span>D.<span class="token number">3</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span><span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">2</span>X<span class="token punctuation">,</span>D<span class="token punctuation">,</span><span class="token number">3</span>X<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span>M3D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">5</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span>M3D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">5</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span>M3D.<span class="token number">2</span>D<span class="token punctuation">,</span><span class="token number">2</span>D.<span class="token number">4</span>D<span class="token punctuation">,</span>M3D.<span class="token number">2</span>D
<span class="token number">44080</span>           <span class="token keyword">NEXT</span> K
<span class="token number">44090</span>         <span class="token keyword">NEXT</span> Eafile
<span class="token number">44100</span>         <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token string">""</span>
<span class="token number">44110</span>         <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! Increment for next freq</span>
<span class="token number">44120</span>       <span class="token keyword">ELSE</span>
<span class="token number">44130</span>         <span class="token keyword">IF</span> Skipnum<span class="token operator">&lt;&gt;</span><span class="token number">0</span> <span class="token keyword">THEN</span>     <span class="token comment" spellcheck="true">! Operator wants to skip some freqs</span>
<span class="token number">44140</span>           Skipit<span class="token operator">=</span>Skipit<span class="token operator">+</span><span class="token number">1</span>      <span class="token comment" spellcheck="true">! Increment flag for next freq</span>
<span class="token number">44150</span>           <span class="token keyword">IF</span> Skipit<span class="token operator">=</span>Skipnum <span class="token keyword">THEN</span> Skipit<span class="token operator">=</span><span class="token number">0</span>   <span class="token comment" spellcheck="true">! if this freq is to be printed, reset the flag</span>
<span class="token number">44160</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">44170</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">44180</span>     <span class="token keyword">NEXT</span> I
<span class="token number">44190</span>     <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">! Page feed</span>
<span class="token number">44200</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">44210</span> SUBEND   <span class="token comment" spellcheck="true">!.......Print2NRrawdata.........................</span>


<span class="token number">44220</span> Smooth<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Smooth<span class="token punctuation">(</span>Whichport<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>File8510<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp1<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Datasp2<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Smoothed<span class="token punctuation">)</span>
<span class="token number">44230</span> <span class="token comment" spellcheck="true">! Smooth S12, S21 data from the 8510 or 360 ANA by averaging points .</span>
<span class="token number">44240</span> !
<span class="token number">44250</span> <span class="token comment" spellcheck="true">! INPUT: Whichport(i)=1 or 2 for each file, which direction device was</span>
<span class="token number">44260</span> <span class="token comment" spellcheck="true">!             measured in.</span>
<span class="token number">44270</span> <span class="token comment" spellcheck="true">!        Numfiles= # of files read in</span>
<span class="token number">44280</span> <span class="token comment" spellcheck="true">!        File8510(n)=1 if nth file has data from 8510 or 360.</span>
<span class="token number">44290</span> <span class="token comment" spellcheck="true">!        Datasp1(*)= data for files measured in forward direction (1)</span>
<span class="token number">44300</span> <span class="token comment" spellcheck="true">!        Datasp2(*)= data for files measured in reverse direction (2)</span>
<span class="token number">44310</span> <span class="token comment" spellcheck="true">! OUTPUT: Datasp1(*) &amp; Datasp2(*) have smoothed data for S12, S21.</span>
<span class="token number">44320</span> <span class="token comment" spellcheck="true">!        Smoothed= # of points averaged to smooth data for each point.</span>
<span class="token number">44330</span> !
<span class="token number">44340</span>   <span class="token keyword">OPTION BASE</span> <span class="token number">1</span>
<span class="token number">44350</span>   <span class="token function">DEG</span>
<span class="token number">44360</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Measinfo<span class="token operator">/</span>Freq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Numfreqs<span class="token punctuation">,</span>Filesperfreq<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Setting$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Filesperset<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">44370</span>   <span class="token keyword">COM</span> <span class="token operator">/</span>Deviceinfo<span class="token operator">/</span>Meastype$<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span>Mags<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token number">44380</span>   ALLOCATE One<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Two<span class="token punctuation">(</span>Numfreqs<span class="token punctuation">,</span>Numfiles<span class="token punctuation">,</span>Numconnects<span class="token punctuation">,</span>Numrepeats<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">44390</span> !
<span class="token number">44400</span> Smuno<span class="token punctuation">:</span> <span class="token keyword">INPUT</span> <span class="token string">"Enter # of points to average for smoothing (ODD number)"</span><span class="token punctuation">,</span>Smoothed
<span class="token number">44410</span>   <span class="token keyword">IF</span> Smoothed <span class="token function">MOD</span> <span class="token number">2</span><span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token keyword">GOTO</span> Smuno
<span class="token number">44420</span>   DISP <span class="token string">"... SMOOTHING ..."</span>
<span class="token number">44430</span>   <span class="token keyword">FOR</span> C<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numconnects
<span class="token number">44440</span>     <span class="token keyword">FOR</span> R<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numrepeats
<span class="token number">44450</span>       <span class="token keyword">FOR</span> F<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">TO</span> Numfreqs<span class="token operator">-</span><span class="token number">1</span>
<span class="token number">44460</span>         Start<span class="token operator">=</span>F<span class="token operator">-</span><span class="token punctuation">(</span>Smoothed<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>
<span class="token number">44470</span>         <span class="token keyword">Stop</span><span class="token operator">=</span>F<span class="token operator">+</span><span class="token punctuation">(</span>Smoothed<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>
<span class="token number">44480</span>         <span class="token keyword">IF</span> Start<span class="token operator">&lt;=</span><span class="token number">0</span> <span class="token keyword">THEN</span> Start<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">44490</span>         <span class="token keyword">IF</span> <span class="token keyword">Stop</span><span class="token operator">&gt;</span>Numfreqs <span class="token keyword">THEN</span> <span class="token keyword">Stop</span><span class="token operator">=</span>Numfreqs
<span class="token number">44500</span>         <span class="token keyword">IF</span> F<span class="token operator">-</span>Start<span class="token operator">&lt;&gt;</span><span class="token keyword">Stop</span><span class="token operator">-</span>F <span class="token keyword">THEN</span> <span class="token comment" spellcheck="true">!NEED =# of points on either side of F</span>
<span class="token number">44510</span>           <span class="token keyword">IF</span> F<span class="token operator">-</span>Start<span class="token operator">&lt;</span><span class="token keyword">Stop</span><span class="token operator">-</span>F <span class="token keyword">THEN</span> <span class="token keyword">Stop</span><span class="token operator">=</span>F<span class="token operator">+</span><span class="token punctuation">(</span>F<span class="token operator">-</span>Start<span class="token punctuation">)</span>
<span class="token number">44520</span>           <span class="token keyword">IF</span> <span class="token keyword">Stop</span><span class="token operator">-</span>F<span class="token operator">&lt;</span>F<span class="token operator">-</span>Start <span class="token keyword">THEN</span> Start<span class="token operator">=</span>F<span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">Stop</span><span class="token operator">-</span>F<span class="token punctuation">)</span>
<span class="token number">44530</span>         <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">44540</span>         Divby<span class="token operator">=</span><span class="token function">ABS</span><span class="token punctuation">(</span><span class="token keyword">Stop</span><span class="token operator">-</span>Start<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token comment" spellcheck="true">!# of points being averaged</span>
<span class="token number">44550</span>   !
<span class="token number">44560</span>         <span class="token keyword">FOR</span> File<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Filesperfreq<span class="token punctuation">(</span>F<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">! Ea file this freq</span>
<span class="token number">44570</span>           Fileno<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>F<span class="token punctuation">,</span>File<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">44580</span>           Port<span class="token operator">=</span>Whichport<span class="token punctuation">(</span>Fileno<span class="token punctuation">)</span>
<span class="token number">44590</span>           <span class="token keyword">IF</span> File8510<span class="token punctuation">(</span>Fileno<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">44600</span>             <span class="token keyword">FOR</span> Sij<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">3</span> <span class="token keyword">STEP</span> <span class="token number">2</span> <span class="token comment" spellcheck="true">! S12 AND S21</span>
<span class="token number">44610</span>               <span class="token keyword">IF</span> Sij<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> S<span class="token operator">=</span><span class="token number">3</span>  <span class="token comment" spellcheck="true">!column location for Sij in Dataspi(*)</span>
<span class="token number">44620</span>               <span class="token keyword">IF</span> Sij<span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">THEN</span> S<span class="token operator">=</span><span class="token number">5</span>
<span class="token number">44630</span>               <span class="token comment" spellcheck="true">! Store point's phase to adjust other points phases if ref</span>
<span class="token number">44640</span>               <span class="token comment" spellcheck="true">!  point is at or near a +-180 degree crossover</span>
<span class="token number">44650</span>               <span class="token keyword">IF</span> Port<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> Refarg<span class="token operator">=</span>Datasp1<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>S<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">44660</span>               <span class="token keyword">IF</span> Port<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> Refarg<span class="token operator">=</span>Datasp2<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>S<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">44670</span>               <span class="token keyword">FOR</span> Avg<span class="token operator">=</span>Start <span class="token keyword">TO</span> <span class="token keyword">Stop</span>
<span class="token number">44680</span>                 <span class="token keyword">IF</span> Port<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">44690</span>                   Aarg<span class="token operator">=</span>Datasp1<span class="token punctuation">(</span>Avg<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>S<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">44700</span>                   <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Refarg<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">100</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Check for +-180 deg diff</span>
<span class="token number">44710</span>                     <span class="token keyword">IF</span> <span class="token function">SGN</span><span class="token punctuation">(</span>Refarg<span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token function">SGN</span><span class="token punctuation">(</span>Aarg<span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Aarg<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">100</span> <span class="token keyword">THEN</span> Aarg<span class="token operator">=</span>Aarg<span class="token operator">+</span><span class="token number">360</span><span class="token operator">*</span><span class="token function">SGN</span><span class="token punctuation">(</span>Refarg<span class="token punctuation">)</span>
<span class="token number">44720</span>                   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">44730</span>                   Snn<span class="token operator">=</span>Datasp1<span class="token punctuation">(</span>Avg<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>S<span class="token punctuation">)</span>
<span class="token number">44740</span>                   One<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>Sij<span class="token punctuation">)</span><span class="token operator">=</span>One<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>Sij<span class="token punctuation">)</span><span class="token operator">+</span>Snn<span class="token operator">/</span>Divby
<span class="token number">44750</span>                   One<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>Sij<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>One<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>Sij<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>Aarg<span class="token operator">/</span>Divby
<span class="token number">44760</span>                 <span class="token keyword">ELSE</span>
<span class="token number">44770</span>                   Aarg<span class="token operator">=</span>Datasp2<span class="token punctuation">(</span>Avg<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>S<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">44780</span>                   <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Refarg<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">100</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Check for +-180 deg diff</span>
<span class="token number">44790</span>                     <span class="token keyword">IF</span> <span class="token function">SGN</span><span class="token punctuation">(</span>Refarg<span class="token punctuation">)</span><span class="token operator">&lt;&gt;</span><span class="token function">SGN</span><span class="token punctuation">(</span>Aarg<span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Aarg<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">100</span> <span class="token keyword">THEN</span> Aarg<span class="token operator">=</span>Aarg<span class="token operator">+</span><span class="token number">360</span><span class="token operator">*</span><span class="token function">SGN</span><span class="token punctuation">(</span>Refarg<span class="token punctuation">)</span>
<span class="token number">44800</span>                   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">44810</span>                   Snn<span class="token operator">=</span>Datasp2<span class="token punctuation">(</span>Avg<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>S<span class="token punctuation">)</span>
<span class="token number">44820</span>                   Two<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>Sij<span class="token punctuation">)</span><span class="token operator">=</span>Two<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>Sij<span class="token punctuation">)</span><span class="token operator">+</span>Snn<span class="token operator">/</span>Divby
<span class="token number">44830</span>                   Two<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>Sij<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>Two<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span>Sij<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>Aarg<span class="token operator">/</span>Divby
<span class="token number">44840</span>                 <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">44850</span>               <span class="token keyword">NEXT</span> Avg
<span class="token number">44860</span>             <span class="token keyword">NEXT</span> Sij
<span class="token number">44870</span>           <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">44880</span>         <span class="token keyword">NEXT</span> File
<span class="token number">44890</span>       <span class="token keyword">NEXT</span> F  <span class="token comment" spellcheck="true">! Freq</span>
<span class="token number">44900</span>     <span class="token keyword">NEXT</span> R    <span class="token comment" spellcheck="true">! Repeat</span>
<span class="token number">44910</span>   <span class="token keyword">NEXT</span> C      <span class="token comment" spellcheck="true">! Connect</span>
<span class="token number">44920</span>     !
<span class="token number">44930</span>   <span class="token keyword">FOR</span> F<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">TO</span> Numfreqs<span class="token operator">-</span><span class="token number">1</span>   <span class="token comment" spellcheck="true">! Store smoothed S12, S21 data into Dataspi(*)</span>
<span class="token number">44940</span>     <span class="token keyword">FOR</span> File<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Filesperfreq<span class="token punctuation">(</span>F<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">! Ea file this freq</span>
<span class="token number">44950</span>       Fileno<span class="token operator">=</span>Filesperfreq<span class="token punctuation">(</span>F<span class="token punctuation">,</span>File<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">44960</span>       Port<span class="token operator">=</span>Whichport<span class="token punctuation">(</span>Fileno<span class="token punctuation">)</span>
<span class="token number">44970</span>       <span class="token keyword">IF</span> File8510<span class="token punctuation">(</span>Fileno<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">44980</span>         <span class="token keyword">FOR</span> C<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numconnects
<span class="token number">44990</span>           <span class="token keyword">FOR</span> R<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> Numrepeats
<span class="token number">45000</span>             <span class="token keyword">IF</span> Port<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">45010</span>               Datasp1<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span>One<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">45020</span>               Datasp1<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span>One<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">45030</span>               Datasp1<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span>One<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">45040</span>               Datasp1<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span>One<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">45050</span>             <span class="token keyword">ELSE</span>
<span class="token number">45060</span>               Datasp2<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span>Two<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">45070</span>               Datasp2<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span>Two<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">45080</span>               Datasp2<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span>Two<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">45090</span>               Datasp2<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span>Two<span class="token punctuation">(</span>F<span class="token punctuation">,</span>Fileno<span class="token punctuation">,</span>C<span class="token punctuation">,</span>R<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">45100</span>             <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">45110</span>           <span class="token keyword">NEXT</span> R
<span class="token number">45120</span>         <span class="token keyword">NEXT</span> C
<span class="token number">45130</span>       <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">45140</span>     <span class="token keyword">NEXT</span> File
<span class="token number">45150</span>   <span class="token keyword">NEXT</span> F
<span class="token number">45160</span>   DISP
<span class="token number">45170</span> SUBEND     <span class="token comment" spellcheck="true">!.............Smooth..................</span>


<span class="token number">45180</span> Nineprinter<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Nineprinter<span class="token punctuation">(</span>@Prt<span class="token punctuation">,</span>Prt<span class="token punctuation">)</span>
<span class="token number">45190</span>   <span class="token keyword">DIM</span> Spid$[<span class="token number">20</span>]
<span class="token number">45200</span>   Prt<span class="token operator">=</span><span class="token number">10</span>
<span class="token number">45210</span>   ASSIGN @Prt <span class="token keyword">TO</span> <span class="token number">10</span>
<span class="token number">45220</span>   <span class="token keyword">ON ERROR</span> <span class="token keyword">GOTO</span> Skipit
<span class="token number">45230</span>   ASSIGN @Sysin <span class="token keyword">TO</span> <span class="token string">"/6PORT/SYSINFO"</span><span class="token punctuation">;</span>FORMAT MSB FIRST
<span class="token number">45240</span>   ENTER @Sysin<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span>Spid$
<span class="token number">45250</span>   <span class="token keyword">IF</span> <span class="token function">POS</span><span class="token punctuation">(</span>Spid$<span class="token punctuation">,</span><span class="token string">"HP"</span><span class="token punctuation">)</span> <span class="token operator">OR</span> Spid$<span class="token operator">=</span><span class="token string">"System 2,7"</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> @Prt<span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"&amp;k4S"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">"&amp;l8D"</span><span class="token punctuation">;</span>
<span class="token number">45260</span> Skipit<span class="token punctuation">:</span> <span class="token keyword">OFF</span> <span class="token keyword">ERROR</span>
<span class="token number">45270</span> SUBEND <span class="token comment" spellcheck="true">!................... Nineprinter ................................</span>


<span class="token number">45280</span> Outputtablene<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Outputtablene<span class="token punctuation">(</span>Mparm$<span class="token punctuation">,</span>S$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>F<span class="token punctuation">,</span>M<span class="token punctuation">,</span>Dm<span class="token punctuation">,</span>Rm<span class="token punctuation">,</span>Sm<span class="token punctuation">,</span>Tm<span class="token punctuation">,</span>P<span class="token punctuation">,</span>Dp<span class="token punctuation">,</span>Rp<span class="token punctuation">,</span>Sp<span class="token punctuation">,</span>Tp<span class="token punctuation">)</span>
<span class="token number">45290</span> <span class="token comment" spellcheck="true">! Put a row (for a frequency F) of data into S$(*).  Used to store</span>
<span class="token number">45300</span> <span class="token comment" spellcheck="true">!  S11 or S22 data for a 2-port, Gamma for a 1-port, and Power results.</span>
<span class="token number">45310</span> !
<span class="token number">45320</span> <span class="token comment" spellcheck="true">!  INPUT:  Mparm$=</span><span class="token string">"S"</span> <span class="token keyword">for</span> <span class="token number">1</span><span class="token operator">-</span> <span class="token operator">or</span> <span class="token number">2</span><span class="token operator">-</span>ports<span class="token punctuation">,</span> <span class="token operator">=</span><span class="token string">"P"</span> <span class="token keyword">for</span> power <span class="token punctuation">(</span><span class="token operator">NOT</span> USED <span class="token number">940124</span><span class="token punctuation">)</span>
<span class="token number">45330</span> <span class="token comment" spellcheck="true">!          F= frequency</span>
<span class="token number">45340</span> <span class="token comment" spellcheck="true">!          M= mean of a variable, Dm= systematic uncertainty of M,</span>
<span class="token number">45350</span> <span class="token comment" spellcheck="true">!            Rm= random uncertainty of M, Sm= connector nonrepeatability</span>
<span class="token number">45360</span> <span class="token comment" spellcheck="true">!            of M, Tm= total uncertainty of M.</span>
<span class="token number">45370</span> <span class="token comment" spellcheck="true">!          P= mean of another variable, and Dp, Rp, Sp, Tp have the</span>
<span class="token number">45380</span> <span class="token comment" spellcheck="true">!            same definition for P as Dm, Rm, Sm, Tm do for M.</span>
<span class="token number">45390</span> !
<span class="token number">45400</span> <span class="token comment" spellcheck="true">! OUTPUT: The variables are stored in the appropriate format in S$(*)</span>
<span class="token number">45410</span> <span class="token comment" spellcheck="true">!         (which will be one row of the final output array).</span>
<span class="token number">45420</span> !
<span class="token number">45421</span>   <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">"P"</span> <span class="token keyword">THEN</span>
<span class="token number">45422</span>     Usne<span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Dm<span class="token operator">*</span>Dm<span class="token operator">+</span>Rm<span class="token operator">*</span>Rm<span class="token punctuation">)</span>
<span class="token number">45423</span>     Uscf<span class="token operator">=</span><span class="token function">SQR</span><span class="token punctuation">(</span>Dp<span class="token operator">*</span>Dp<span class="token operator">+</span>Rp<span class="token operator">*</span>Rp<span class="token punctuation">)</span>
<span class="token number">45424</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">45430</span>   <span class="token keyword">IF</span> F<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">45440</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,4X,Z.3D,3X"</span><span class="token punctuation">;</span>F     <span class="token comment" spellcheck="true">! Frequency</span>
<span class="token number">45450</span>   <span class="token keyword">ELSE</span>
<span class="token number">45460</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3X,2D.3D,3X"</span><span class="token punctuation">;</span>F
<span class="token number">45470</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">45490</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,3X"</span><span class="token punctuation">;</span>M        <span class="token comment" spellcheck="true">! Efficiency</span>
<span class="token number">45570</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,3X"</span><span class="token punctuation">;</span>Usne     <span class="token comment" spellcheck="true">! Syst uncert of M and Snist</span>
<span class="token number">45580</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,2X"</span><span class="token punctuation">;</span>Sm       <span class="token comment" spellcheck="true">! Connector nonrepeatability of M</span>
<span class="token number">45590</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X"</span>                <span class="token comment" spellcheck="true">! Space saver</span>
<span class="token number">45600</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,2X"</span><span class="token punctuation">;</span>Tm       <span class="token comment" spellcheck="true">! Total uncert of M</span>
<span class="token number">45620</span>   !
<span class="token number">45640</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,A,3X,Z.4D,3X"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">,</span>P     <span class="token comment" spellcheck="true">! Mean of a var: cal factor</span>
<span class="token number">45710</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,3X"</span><span class="token punctuation">;</span>Uscf     <span class="token comment" spellcheck="true">! Syst uncert of P and Snist</span>
<span class="token number">45760</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,2X"</span><span class="token punctuation">;</span>Sp       <span class="token comment" spellcheck="true">! Connector nonrepeatability of P</span>
<span class="token number">45810</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,X"</span>               <span class="token comment" spellcheck="true">! Space saver</span>
<span class="token number">45860</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D"</span><span class="token punctuation">;</span>Tp         <span class="token comment" spellcheck="true">! Total uncert of P</span>
<span class="token number">45900</span> SUBEND   <span class="token comment" spellcheck="true">!........Outputtablene..................</span>


<span class="token number">45910</span> Outputtablecom<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Outputtablecom<span class="token punctuation">(</span>Mparm$<span class="token punctuation">,</span>S$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>F<span class="token punctuation">,</span>M<span class="token punctuation">,</span>Dm<span class="token punctuation">,</span>Rm<span class="token punctuation">,</span>Sm<span class="token punctuation">,</span>Tm<span class="token punctuation">,</span>P<span class="token punctuation">,</span>Dp<span class="token punctuation">,</span>Rp<span class="token punctuation">,</span>Sp<span class="token punctuation">,</span>Tp<span class="token punctuation">)</span>
<span class="token number">45920</span> <span class="token comment" spellcheck="true">! Put a row (for a frequency F) of data into S$(*).  Used to store</span>
<span class="token number">45930</span> <span class="token comment" spellcheck="true">!  S11 or S22 data for a 2-port, Gamma for a 1-port, and Power results.</span>
<span class="token number">45940</span> !
<span class="token number">45950</span> <span class="token comment" spellcheck="true">!  INPUT:  Mparm$=</span><span class="token string">"S"</span> <span class="token keyword">for</span> <span class="token number">1</span><span class="token operator">-</span> <span class="token operator">or</span> <span class="token number">2</span><span class="token operator">-</span>ports<span class="token punctuation">,</span> <span class="token operator">=</span><span class="token string">"P"</span> <span class="token keyword">for</span> power <span class="token punctuation">(</span><span class="token operator">NOT</span> USED <span class="token number">940124</span><span class="token punctuation">)</span>
<span class="token number">45960</span> <span class="token comment" spellcheck="true">!          F= frequency</span>
<span class="token number">45970</span> <span class="token comment" spellcheck="true">!          M= mean of a variable, Dm= systematic uncertainty of M,</span>
<span class="token number">45980</span> <span class="token comment" spellcheck="true">!            Rm= random uncertainty of M, Sm= connector nonrepeatability</span>
<span class="token number">45990</span> <span class="token comment" spellcheck="true">!            of M, Tm= total uncertainty of M.</span>
<span class="token number">46000</span> <span class="token comment" spellcheck="true">!          P= mean of another variable, and Dp, Rp, Sp, Tp have the</span>
<span class="token number">46010</span> <span class="token comment" spellcheck="true">!            same definition for P as Dm, Rm, Sm, Tm do for M.</span>
<span class="token number">46020</span> !
<span class="token number">46030</span> <span class="token comment" spellcheck="true">! OUTPUT: The variables are stored in the appropriate format in S$(*)</span>
<span class="token number">46040</span> <span class="token comment" spellcheck="true">!         (which will be one row of the final output array).</span>
<span class="token number">46050</span> !
<span class="token number">46051</span>   <span class="token keyword">DIM</span> St$[<span class="token number">20</span>]
<span class="token number">46052</span>   !
<span class="token number">46060</span>   <span class="token keyword">IF</span> F<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">46070</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>F<span class="token punctuation">,</span><span class="token string">","</span>     <span class="token comment" spellcheck="true">! Frequency</span>
<span class="token number">46080</span>   <span class="token keyword">ELSE</span>
<span class="token number">46090</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2D.4D,A"</span><span class="token punctuation">;</span>F<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46100</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">46110</span>   <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">"S"</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>M<span class="token punctuation">,</span><span class="token string">","</span>       <span class="token comment" spellcheck="true">! Mean of a variable (Gamma or Sii magnitude)</span>
<span class="token number">46120</span>   <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">"P"</span> <span class="token operator">AND</span> <span class="token function">ABS</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>M<span class="token punctuation">,</span><span class="token string">","</span>       <span class="token comment" spellcheck="true">! Efficiency</span>
<span class="token number">46130</span>   <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">"P"</span> <span class="token operator">AND</span> <span class="token function">ABS</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,D.4D,A"</span><span class="token punctuation">;</span>M<span class="token punctuation">,</span><span class="token string">","</span>       <span class="token comment" spellcheck="true">! Efficiency sometimes comes out greater than 1</span>
<span class="token number">46140</span>   <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">"S"</span> <span class="token keyword">THEN</span>
<span class="token number">46150</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Dm<span class="token punctuation">,</span><span class="token string">","</span>    <span class="token comment" spellcheck="true">! Syst uncert of M</span>
<span class="token number">46160</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Rm<span class="token punctuation">,</span><span class="token string">","</span>    <span class="token comment" spellcheck="true">! Random uncert of M</span>
<span class="token number">46170</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Sm<span class="token punctuation">,</span><span class="token string">","</span>    <span class="token comment" spellcheck="true">! Connector nonrepeatability</span>
<span class="token number">46180</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Tm<span class="token punctuation">,</span><span class="token string">","</span>    <span class="token comment" spellcheck="true">! Total uncert of M</span>
<span class="token number">46190</span>   <span class="token keyword">ELSE</span>   <span class="token comment" spellcheck="true">! Power device</span>
<span class="token number">46200</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Dm<span class="token punctuation">,</span><span class="token string">","</span>    <span class="token comment" spellcheck="true">! Syst uncert of M</span>
<span class="token number">46210</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Rm<span class="token punctuation">,</span><span class="token string">","</span>    <span class="token comment" spellcheck="true">! Random uncert of M</span>
<span class="token number">46220</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Sm<span class="token punctuation">,</span><span class="token string">","</span>    <span class="token comment" spellcheck="true">! Connector nonrepeatability</span>
<span class="token number">46230</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Tm<span class="token punctuation">,</span><span class="token string">","</span>    <span class="token comment" spellcheck="true">! Total uncert of M</span>
<span class="token number">46240</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">46250</span>   !
<span class="token number">46251</span>   <span class="token keyword">IF</span> Mparm$<span class="token operator">=</span><span class="token string">"P"</span> <span class="token keyword">THEN</span>   <span class="token comment" spellcheck="true">! Power Device Cal Factor</span>
<span class="token number">46253</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,MZ.4D,A"</span><span class="token punctuation">;</span>P<span class="token punctuation">,</span><span class="token string">","</span>     <span class="token comment" spellcheck="true">! Mean of a var: cal factor</span>
<span class="token number">46260</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Dp<span class="token punctuation">,</span><span class="token string">","</span>      <span class="token comment" spellcheck="true">! Syst uncert of P</span>
<span class="token number">46265</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Rp<span class="token punctuation">,</span><span class="token string">","</span>       <span class="token comment" spellcheck="true">! Random uncert of P</span>
<span class="token number">46270</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D,A"</span><span class="token punctuation">;</span>Sp<span class="token punctuation">,</span><span class="token string">","</span>      <span class="token comment" spellcheck="true">! Connector nonrepeatability</span>
<span class="token number">46275</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.4D"</span><span class="token punctuation">;</span>Tp      <span class="token comment" spellcheck="true">! Total uncert of P</span>
<span class="token number">46279</span>   <span class="token keyword">ELSE</span>     <span class="token comment" spellcheck="true">! S-Parameter Phase</span>
<span class="token number">46281</span>   !
<span class="token number">46283</span>     <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">46284</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,MZ.2D,A"</span><span class="token punctuation">;</span>P<span class="token punctuation">,</span><span class="token string">","</span>   <span class="token comment" spellcheck="true">! Mean of a variable: arg of Gamma or Sii</span>
<span class="token number">46288</span>     <span class="token keyword">ELSE</span>
<span class="token number">46289</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,M3D.2D,A"</span><span class="token punctuation">;</span>P<span class="token punctuation">,</span><span class="token string">","</span>  <span class="token comment" spellcheck="true">! Mean of a variable: arg of Gamma or Sii</span>
<span class="token number">46293</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">46294</span>     <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Dp<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">46295</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.2D,A"</span><span class="token punctuation">;</span>Dp<span class="token punctuation">,</span><span class="token string">","</span>    <span class="token comment" spellcheck="true">! Syst uncert of P</span>
<span class="token number">46296</span>     <span class="token keyword">ELSE</span>
<span class="token number">46297</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.2D,A"</span><span class="token punctuation">;</span>Dp<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46298</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">46299</span>     <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Rp<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">46300</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.2D,A"</span><span class="token punctuation">;</span>Rp<span class="token punctuation">,</span><span class="token string">","</span>     <span class="token comment" spellcheck="true">! Random uncert of P</span>
<span class="token number">46301</span>     <span class="token keyword">ELSE</span>
<span class="token number">46302</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.2D,A"</span><span class="token punctuation">;</span>Rp<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46303</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">46304</span>     <span class="token keyword">IF</span> Sp<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">46305</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.2D,A"</span><span class="token punctuation">;</span>Sp<span class="token punctuation">,</span><span class="token string">","</span>    <span class="token comment" spellcheck="true">! Connector nonrepeatability</span>
<span class="token number">46306</span>     <span class="token keyword">ELSE</span>
<span class="token number">46307</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.2D,A"</span><span class="token punctuation">;</span>Sp<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46308</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">46309</span>     <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>Tp<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">46310</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.2D,A"</span><span class="token punctuation">;</span>Tp<span class="token punctuation">,</span><span class="token string">","</span>    <span class="token comment" spellcheck="true">! Total uncert of P</span>
<span class="token number">46311</span>     <span class="token keyword">ELSE</span>
<span class="token number">46312</span>       <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.2D"</span><span class="token punctuation">;</span>Tp
<span class="token number">46313</span>     <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">46314</span>     !
<span class="token number">46315</span>     !
<span class="token number">46337</span>     !
<span class="token number">46338</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">46530</span>   <span class="token keyword">FOR</span> Zz<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">11</span>
<span class="token number">46531</span>     S$<span class="token punctuation">(</span>Zz<span class="token punctuation">)</span><span class="token operator">=</span>TRIM$<span class="token punctuation">(</span>S$<span class="token punctuation">(</span>Zz<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">46532</span>   <span class="token keyword">NEXT</span> Zz
<span class="token number">46533</span> SUBEND   <span class="token comment" spellcheck="true">!........Outputtablecom..................</span>


<span class="token number">46540</span> Outputtable3com<span class="token punctuation">:</span> <span class="token keyword">SUB</span> Outputtable3com<span class="token punctuation">(</span>S$<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>F<span class="token punctuation">,</span>M<span class="token punctuation">,</span>Dm<span class="token punctuation">,</span>Rm<span class="token punctuation">,</span>Sm<span class="token punctuation">,</span>Tm<span class="token punctuation">,</span>P<span class="token punctuation">,</span>Dp<span class="token punctuation">,</span>Rp<span class="token punctuation">,</span>Sp<span class="token punctuation">,</span>Tp<span class="token punctuation">)</span>
<span class="token number">46550</span> <span class="token comment" spellcheck="true">! Output S12 data for freq F into S$(*)</span>
<span class="token number">46560</span> !
<span class="token number">46570</span> <span class="token comment" spellcheck="true">!  INPUT:  F= frequency</span>
<span class="token number">46580</span> <span class="token comment" spellcheck="true">!          M= mean of |S12|, Dm= systematic uncertainty of M,</span>
<span class="token number">46590</span> <span class="token comment" spellcheck="true">!            Rm= random uncertainty of M, Sm= connector nonrepeatability</span>
<span class="token number">46600</span> <span class="token comment" spellcheck="true">!            of M, Tm= total uncertainty of M.</span>
<span class="token number">46610</span> <span class="token comment" spellcheck="true">!          P= mean of Arg(S12), and Dp, Rp, Sp, Tp have the</span>
<span class="token number">46620</span> <span class="token comment" spellcheck="true">!            same definition for P as Dm, Rm, Sm, Tm do for M.</span>
<span class="token number">46630</span> !
<span class="token number">46640</span> <span class="token comment" spellcheck="true">! OUTPUT: The variables are stored in the appropriate format in S$(*)</span>
<span class="token number">46650</span> <span class="token comment" spellcheck="true">!         (which will be one row of the final output array).</span>
<span class="token number">46660</span> !
<span class="token number">46670</span>   <span class="token keyword">IF</span> F<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">46680</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D,A"</span><span class="token punctuation">;</span>F<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46690</span>   <span class="token keyword">ELSE</span>
<span class="token number">46700</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2D.3D,A"</span><span class="token punctuation">;</span>F<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46710</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">46720</span>   <span class="token keyword">IF</span> M<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">46730</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D,A"</span><span class="token punctuation">;</span>M<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46740</span>   <span class="token keyword">ELSE</span>
<span class="token number">46750</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,2D.3D,A"</span><span class="token punctuation">;</span>M<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46760</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">46770</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D,A"</span><span class="token punctuation">;</span>Dm<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46780</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.3D,A"</span><span class="token punctuation">;</span>Rm<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46790</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3X,Z.3D,A"</span><span class="token punctuation">;</span>Sm<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46800</span>   <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,4X,Z.3D,A"</span><span class="token punctuation">;</span>Tm<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46810</span>   <span class="token keyword">IF</span> <span class="token function">ABS</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">46820</span>    <span class="token comment" spellcheck="true">! OUTPUT S$(7) USING </span><span class="token string">"#,1X,A,3X,MZ.2D"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">,</span>P
<span class="token number">46821</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,MZ.2D,A"</span><span class="token punctuation">;</span>P<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46830</span>   <span class="token keyword">ELSE</span>
<span class="token number">46840</span>    <span class="token comment" spellcheck="true">! OUTPUT S$(7) USING </span><span class="token string">"#,1X,A,1X,M3D.2D"</span><span class="token punctuation">;</span><span class="token function">CHR$</span><span class="token punctuation">(</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">,</span>P
<span class="token number">46841</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,M3D.2D,A"</span><span class="token punctuation">;</span>P<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46850</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">46860</span>   <span class="token keyword">IF</span> Dp<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">46870</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.2D,A"</span><span class="token punctuation">;</span>Dp<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46880</span>   <span class="token keyword">ELSE</span>
<span class="token number">46890</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.2D,A"</span><span class="token punctuation">;</span>Dp<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46900</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">46910</span>   <span class="token keyword">IF</span> Rp<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">46920</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.2D,A"</span><span class="token punctuation">;</span>Rp<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46930</span>   <span class="token keyword">ELSE</span>
<span class="token number">46940</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.2D,A"</span><span class="token punctuation">;</span>Rp<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46950</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">46960</span>   <span class="token keyword">IF</span> Sp<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">46970</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.2D,A"</span><span class="token punctuation">;</span>Sp<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">46980</span>   <span class="token keyword">ELSE</span>
<span class="token number">46990</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.2D,A"</span><span class="token punctuation">;</span>Sp<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">47000</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">47010</span>   <span class="token keyword">IF</span> Tp<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">THEN</span>
<span class="token number">47020</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,Z.2D,A"</span><span class="token punctuation">;</span>Tp<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">47030</span>   <span class="token keyword">ELSE</span>
<span class="token number">47040</span>     <span class="token function">OUTPUT</span> S$<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token string">"#,3D.2D,A"</span><span class="token punctuation">;</span>Tp<span class="token punctuation">,</span><span class="token string">","</span>
<span class="token number">47050</span>   <span class="token keyword">END</span> <span class="token keyword">IF</span>
<span class="token number">47060</span>   <span class="token keyword">FOR</span> Zz<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">TO</span> <span class="token number">11</span>
<span class="token number">47061</span>     S$<span class="token punctuation">(</span>Zz<span class="token punctuation">)</span><span class="token operator">=</span>TRIM$<span class="token punctuation">(</span>S$<span class="token punctuation">(</span>Zz<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">47062</span>   <span class="token keyword">NEXT</span> Zz
<span class="token number">47063</span> SUBEND <span class="token comment" spellcheck="true">!..........Outputtable3com.......................</span>







</code></pre>



</body>
</html>